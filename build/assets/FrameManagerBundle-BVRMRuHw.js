const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MonacoEditor-BbzhZksg.js","assets/index-BhmhgD6-.js","assets/codemirror-TlZy3ty4.js","assets/index-Dl_SjRZT.css","assets/monaco-Dt6lDvaG.js","assets/monaco-Cjcdkwd9.css","assets/Editor-CEPjDq9y.js","assets/tslib.es6-CRos2fHm.js","assets/Editor-wMliMse9.css","assets/Artplayer-BZ-7w0Ox.js","assets/SettingForm-CxIiT_vO.js","assets/DarkThemeSwitcher-CxPmHxlM.js","assets/Storage-HJ4WwPFN.js","assets/Artplayer-CsrbgM3u.css","assets/Epub-DthKVwEI.js","assets/throttle-CETcSfqb.js"])))=>i.map(i=>d[i]);
import{g as Ct,a as wt,s as N,P as mt,c as he,m as nt,b as Vs,r as i,u as kt,j as e,d as He,e as Dt,M as $a,f as qa,h as X,i as Ga,k as Xa,l as at,S as $s,n as ge,o as F,D as Za,p as Ya,q as Ja,t as de,v as Ka,w as P,x as L,y as C,z as R,A as Qa,B as $n,C as $,G as Be,E as oe,F as se,H as J,I as Tt,T as Ke,J as ze,K as er,L as tr,N as qs,O as Q,Q as xt,R as Ee,U as nr,V as qn,W as sr,X as Mt,Y as Ot,Z as Et,_ as At,$ as ke,a0 as Se,a1 as Pt,a2 as bt,a3 as Gn,a4 as Te,a5 as ar,a6 as rr,a7 as Xn,a8 as or,a9 as Gs,aa as Ve,ab as ir,ac as Re,ad as M,ae as lr,af as cr,ag as Zn,ah as dr,ai as ee,aj as gn,ak as qe,al as ur,am as Pe,an as mn,ao as Xs,ap as xn,aq as Zs,ar as pr,as as ce,at as hr,au as q,av as rt,aw as re,ax as Ue,ay as fr,az as gr,aA as Yn,aB as nn,aC as mr,aD as xr,aE as Vt,aF as br,aG as H,aH as vr,aI as bn,aJ as vn,aK as sn,aL as jr,aM as jn,aN as yr,aO as Sr,aP as Ys,aQ as Cr,aR as Js,aS as wr,aT as ye,aU as G,aV as ne,aW as Ks,aX as we,aY as kr,aZ as Dr,a_ as Tr,a$ as Mr,b0 as Or,b1 as Er,b2 as Ar,b3 as $t,b4 as qt,b5 as ve,b6 as Pr,b7 as Ir,b8 as Jn,b9 as Kn,ba as _r,bb as It,bc as Qs,bd as le,be as ea,bf as Lr,bg as ta,bh as zr,bi as an,bj as Qe,bk as yn,bl as na,bm as vt,bn as jt,bo as Ge,bp as st,bq as Fe,br as pe,bs as Fr,bt as Rr,bu as Sn,bv as Cn,bw as $e,bx as wn,by as Nr,bz as sa,bA as Wr,bB as kn,bC as Hr,bD as Br,bE as Ur,bF as Dn,bG as et,bH as De,bI as _t,bJ as aa,bK as Vr,bL as $r,bM as qr,bN as Gr,bO as B,bP as ae,bQ as Xr,bR as Qn,bS as es,bT as Zr,bU as Yr,bV as Jr,bW as Tn,bX as Kr,bY as ts,bZ as ns,b_ as Qr,b$ as Gt,c0 as Ne,c1 as ss,c2 as eo,c3 as Mn,c4 as ra,c5 as to,c6 as On,c7 as no,c8 as as,c9 as so,ca as ao,cb as yt,cc as rs,cd as os,ce as ro,cf as oo,cg as Z,ch as oa,ci as io,cj as lo,ck as co,cl as is,cm as En,cn as ia,co as la,cp as An,cq as uo,cr as po,cs as ho,ct as fo,cu as go,cv as ca,cw as Y,cx as ht,cy as ls,cz as mo,cA as xo,cB as bo,cC as vo,cD as jo,cE as yo,cF as So,cG as Co,cH as St,cI as wo,cJ as ko,cK as Do,cL as To,cM as Mo,cN as Oo,cO as Eo,cP as W,cQ as ot,cR as da,cS as ua,cT as Ao,cU as Po,cV as rn,cW as Io,cX as _o,cY as cs,cZ as pa,c_ as Lo,c$ as ha,d0 as Pn,d1 as zo,d2 as Fo,d3 as on,d4 as ln,d5 as Ro,d6 as No,d7 as fa,d8 as Wo,d9 as Ho,da as Bo,db as ga,dc as cn,dd as Lt,de as In,df as Uo,dg as Vo,dh as ma,di as $o,dj as xa,dk as _n,dl as Ye,dm as dn,dn as qo,dp as Go,dq as Xo,dr as Ln,ds as Zo,dt as Yo,du as Jo,dv as Ko,dw as ds,dx as Qo,dy as ei,dz as ti,dA as ni,dB as Ce,dC as si,dD as ai,dE as us,dF as ps,dG as ri,dH as oi,dI as ii,dJ as hs,dK as li,dL as ci,dM as di,dN as ui,dO as pi,dP as hi,dQ as fi,dR as gi,dS as Xt,dT as mi,dU as un,dV as xi,dW as bi,dX as vi}from"./index-BhmhgD6-.js";import{F as ji,A as tt,a as yi,P as Si,b as Ci,S as wi,L as ki,l as fs}from"./SettingForm-CxIiT_vO.js";import{M as ba,L as Di,D as Ti}from"./DarkThemeSwitcher-CxPmHxlM.js";import{S as Mi,E as Oi,a as Ei,b as Ai,P as Pi,B as Ii,C as va,c as _i}from"./Storage-HJ4WwPFN.js";import{_ as zt}from"./codemirror-TlZy3ty4.js";function Li(t){return Ct("MuiAppBar",t)}wt("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const zi=t=>{const{color:n,position:s,classes:r}=t,a={root:["root",`color${he(n)}`,`position${he(s)}`]};return Dt(a,Li,r)},gs=(t,n)=>t?`${t==null?void 0:t.replace(")","")}, ${n})`:n,Fi=N(mt,{name:"MuiAppBar",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:s}=t;return[n.root,n[`position${he(s.position)}`],n[`color${he(s.color)}`]]}})(nt(({theme:t})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[100],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[100]),...t.applyStyles("dark",{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[900],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[900])})}},...Object.entries(t.palette).filter(Vs(["contrastText"])).map(([n])=>({props:{color:n},style:{"--AppBar-background":(t.vars??t).palette[n].main,"--AppBar-color":(t.vars??t).palette[n].contrastText}})),{props:n=>n.enableColorOnDark===!0&&!["inherit","transparent"].includes(n.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:n=>n.enableColorOnDark===!1&&!["inherit","transparent"].includes(n.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundColor:t.vars?gs(t.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:t.vars?gs(t.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundImage:"none"})}}]}))),ja=i.forwardRef(function(n,s){const r=kt({props:n,name:"MuiAppBar"}),{className:a,color:l="primary",enableColorOnDark:o=!1,position:c="fixed",...u}=r,h={...r,color:l,position:c,enableColorOnDark:o},f=zi(h);return e.jsx(Fi,{square:!0,component:"header",ownerState:h,elevation:4,className:He(f.root,a,c==="fixed"&&"mui-fixed"),ref:s,...u})});function Ri(t){return Ct("MuiDrawer",t)}wt("MuiDrawer",["root","docked","paper","anchorLeft","anchorRight","anchorTop","anchorBottom","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const ya=(t,n)=>{const{ownerState:s}=t;return[n.root,(s.variant==="permanent"||s.variant==="persistent")&&n.docked,n.modal]},Ni=t=>{const{classes:n,anchor:s,variant:r}=t,a={root:["root",`anchor${he(s)}`],docked:[(r==="permanent"||r==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${he(s)}`,r!=="temporary"&&`paperAnchorDocked${he(s)}`]};return Dt(a,Ri,n)},Wi=N($a,{name:"MuiDrawer",slot:"Root",overridesResolver:ya})(nt(({theme:t})=>({zIndex:(t.vars||t).zIndex.drawer}))),Hi=N("div",{shouldForwardProp:qa,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:ya})({flex:"0 0 auto"}),Bi=N(mt,{name:"MuiDrawer",slot:"Paper",overridesResolver:(t,n)=>{const{ownerState:s}=t;return[n.paper,n[`paperAnchor${he(s.anchor)}`],s.variant!=="temporary"&&n[`paperAnchorDocked${he(s.anchor)}`]]}})(nt(({theme:t})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(t.vars||t).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:n})=>n.anchor==="left"&&n.variant!=="temporary",style:{borderRight:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:n})=>n.anchor==="top"&&n.variant!=="temporary",style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:n})=>n.anchor==="right"&&n.variant!=="temporary",style:{borderLeft:`1px solid ${(t.vars||t).palette.divider}`}},{props:({ownerState:n})=>n.anchor==="bottom"&&n.variant!=="temporary",style:{borderTop:`1px solid ${(t.vars||t).palette.divider}`}}]}))),Sa={left:"right",right:"left",top:"down",bottom:"up"};function Ui(t){return["left","right"].includes(t)}function Vi({direction:t},n){return t==="rtl"&&Ui(n)?Sa[n]:n}const $i=i.forwardRef(function(n,s){const r=kt({props:n,name:"MuiDrawer"}),a=X(),l=Ga(),o={enter:a.transitions.duration.enteringScreen,exit:a.transitions.duration.leavingScreen},{anchor:c="left",BackdropProps:u,children:h,className:f,elevation:d=16,hideBackdrop:p=!1,ModalProps:{BackdropProps:g,...m}={},onClose:x,open:j=!1,PaperProps:v={},SlideProps:k,TransitionComponent:w,transitionDuration:D=o,variant:y="temporary",slots:b={},slotProps:E={},...z}=r,K=i.useRef(!1);i.useEffect(()=>{K.current=!0},[]);const U=Vi({direction:l?"rtl":"ltr"},c),_={...r,anchor:c,elevation:d,open:j,variant:y,...z},V=Ni(_),T={slots:{transition:w,...b},slotProps:{paper:v,transition:k,...E,backdrop:Xa(E.backdrop||{...u,...g},{transitionDuration:D})}},[S,O]=at("root",{ref:s,elementType:Wi,className:He(V.root,V.modal,f),shouldForwardComponentProp:!0,ownerState:_,externalForwardedProps:{...T,...z,...m},additionalProps:{open:j,onClose:x,hideBackdrop:p,slots:{backdrop:T.slots.backdrop},slotProps:{backdrop:T.slotProps.backdrop}}}),[I,te]=at("paper",{elementType:Bi,shouldForwardComponentProp:!0,className:He(V.paper,v.className),ownerState:_,externalForwardedProps:T,additionalProps:{elevation:y==="temporary"?d:0,square:!0}}),[ie,ue]=at("docked",{elementType:Hi,ref:s,className:He(V.root,V.docked,f),ownerState:_,externalForwardedProps:T,additionalProps:z}),[Oe,me]=at("transition",{elementType:$s,ownerState:_,externalForwardedProps:T,additionalProps:{in:j,direction:Sa[U],timeout:D,appear:K.current}}),Ie=e.jsx(I,{...te,children:h});if(y==="permanent")return e.jsx(ie,{...ue,children:Ie});const xe=e.jsx(Oe,{...me,children:Ie});return y==="persistent"?e.jsx(ie,{...ue,children:xe}):e.jsx(S,{...O,children:xe})});function qi(t){return Ct("MuiIcon",t)}wt("MuiIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Gi=t=>{const{color:n,fontSize:s,classes:r}=t,a={root:["root",n!=="inherit"&&`color${he(n)}`,`fontSize${he(s)}`]};return Dt(a,qi,r)},Xi=N("span",{name:"MuiIcon",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:s}=t;return[n.root,s.color!=="inherit"&&n[`color${he(s.color)}`],n[`fontSize${he(s.fontSize)}`]]}})(nt(({theme:t})=>({userSelect:"none",width:"1em",height:"1em",overflow:"hidden",display:"inline-block",textAlign:"center",flexShrink:0,variants:[{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:t.typography.pxToRem(20)}},{props:{fontSize:"medium"},style:{fontSize:t.typography.pxToRem(24)}},{props:{fontSize:"large"},style:{fontSize:t.typography.pxToRem(36)}},{props:{color:"action"},style:{color:(t.vars||t).palette.action.active}},{props:{color:"disabled"},style:{color:(t.vars||t).palette.action.disabled}},{props:{color:"inherit"},style:{color:void 0}},...Object.entries(t.palette).filter(Vs()).map(([n])=>({props:{color:n},style:{color:(t.vars||t).palette[n].main}}))]}))),_e=i.forwardRef(function(n,s){const r=kt({props:n,name:"MuiIcon"}),{baseClassName:a="material-icons",className:l,color:o="inherit",component:c="span",fontSize:u="medium",...h}=r,f={...r,baseClassName:a,color:o,component:c,fontSize:u},d=Gi(f);return e.jsx(Xi,{as:c,className:He(a,"notranslate",d.root,l),ownerState:f,"aria-hidden":!0,ref:s,...h})});_e.muiName="Icon";function Zi(t){return Ct("MuiToolbar",t)}wt("MuiToolbar",["root","gutters","regular","dense"]);const Yi=t=>{const{classes:n,disableGutters:s,variant:r}=t;return Dt({root:["root",!s&&"gutters",r]},Zi,n)},Ji=N("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(t,n)=>{const{ownerState:s}=t;return[n.root,!s.disableGutters&&n.gutters,n[s.variant]]}})(nt(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:n})=>!n.disableGutters,style:{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:t.mixins.toolbar}]}))),Ca=i.forwardRef(function(n,s){const r=kt({props:n,name:"MuiToolbar"}),{className:a,component:l="div",disableGutters:o=!1,variant:c="regular",...u}=r,h={...r,component:l,disableGutters:o,variant:c},f=Yi(h);return e.jsx(Ji,{as:l,className:He(f.root,a),ref:s,ownerState:h,...u})}),Ki=ge(e.jsx("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"ChevronLeft"),Qi=ge(e.jsx("path",{d:"m5.58 16.89 5.77-4.07c.56-.4.56-1.24 0-1.63L5.58 7.11C4.91 6.65 4 7.12 4 7.93v8.14c0 .81.91 1.28 1.58.82M13 7.93v8.14c0 .81.91 1.28 1.58.82l5.77-4.07c.56-.4.56-1.24 0-1.63l-5.77-4.07c-.67-.47-1.58 0-1.58.81"}),"FastForwardRounded"),el=ge(e.jsx("path",{d:"M11 16.07V7.93c0-.81-.91-1.28-1.58-.82l-5.77 4.07c-.56.4-.56 1.24 0 1.63l5.77 4.07c.67.47 1.58 0 1.58-.81m1.66-3.25 5.77 4.07c.66.47 1.58-.01 1.58-.82V7.93c0-.81-.91-1.28-1.58-.82l-5.77 4.07c-.57.4-.57 1.24 0 1.64"}),"FastRewindRounded"),tl=ge(e.jsx("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu"),nl=ge(e.jsx("path",{d:"M8 19c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2s-2 .9-2 2v10c0 1.1.9 2 2 2m6-12v10c0 1.1.9 2 2 2s2-.9 2-2V7c0-1.1-.9-2-2-2s-2 .9-2 2"}),"PauseRounded"),sl=ge(e.jsx("path",{d:"M8 6.82v10.36c0 .79.87 1.27 1.54.84l8.14-5.18c.62-.39.62-1.29 0-1.69L9.54 5.98C8.87 5.55 8 6.03 8 6.82"}),"PlayArrowRounded"),al=ge(e.jsx("path",{d:"M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02M5 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L9 9H6c-.55 0-1 .45-1 1"}),"VolumeDownRounded"),rl=ge(e.jsx("path",{d:"M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1m13.5 2c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02M14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85"}),"VolumeUpRounded");function be(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var ms=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),Zt=function(){return Math.random().toString(36).substring(7).split("").join(".")},xs={INIT:"@@redux/INIT"+Zt(),REPLACE:"@@redux/REPLACE"+Zt(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Zt()}};function ol(t){if(typeof t!="object"||t===null)return!1;for(var n=t;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(t)===n}function wa(t,n,s){var r;if(typeof n=="function"&&typeof s=="function"||typeof s=="function"&&typeof arguments[3]=="function")throw new Error(be(0));if(typeof n=="function"&&typeof s>"u"&&(s=n,n=void 0),typeof s<"u"){if(typeof s!="function")throw new Error(be(1));return s(wa)(t,n)}if(typeof t!="function")throw new Error(be(2));var a=t,l=n,o=[],c=o,u=!1;function h(){c===o&&(c=o.slice())}function f(){if(u)throw new Error(be(3));return l}function d(x){if(typeof x!="function")throw new Error(be(4));if(u)throw new Error(be(5));var j=!0;return h(),c.push(x),function(){if(j){if(u)throw new Error(be(6));j=!1,h();var k=c.indexOf(x);c.splice(k,1),o=null}}}function p(x){if(!ol(x))throw new Error(be(7));if(typeof x.type>"u")throw new Error(be(8));if(u)throw new Error(be(9));try{u=!0,l=a(l,x)}finally{u=!1}for(var j=o=c,v=0;v<j.length;v++){var k=j[v];k()}return x}function g(x){if(typeof x!="function")throw new Error(be(10));a=x,p({type:xs.REPLACE})}function m(){var x,j=d;return x={subscribe:function(k){if(typeof k!="object"||k===null)throw new Error(be(11));function w(){k.next&&k.next(f())}w();var D=j(w);return{unsubscribe:D}}},x[ms]=function(){return this},x}return p({type:xs.INIT}),r={dispatch:p,subscribe:d,getState:f,replaceReducer:g},r[ms]=m,r}function il(t,n,s){return n.split(".").reduce((r,a)=>r&&r[a]?r[a]:s||null,t)}function ll(t,n){return t.filter(s=>s!==n)}function ka(t){return typeof t=="object"}function cl(t,n){const s=new Map,r=l=>{s.set(l,s.has(l)?s.get(l)+1:1)};t.forEach(r),n.forEach(r);const a=[];return s.forEach((l,o)=>{l===1&&a.push(o)}),a}function dl(t,n){return t.filter(s=>n.indexOf(s)>-1)}const zn="dnd-core/INIT_COORDS",Ft="dnd-core/BEGIN_DRAG",Fn="dnd-core/PUBLISH_DRAG_SOURCE",Rt="dnd-core/HOVER",Nt="dnd-core/DROP",Wt="dnd-core/END_DRAG";function bs(t,n){return{type:zn,payload:{sourceClientOffset:n||null,clientOffset:t||null}}}const ul={type:zn,payload:{clientOffset:null,sourceClientOffset:null}};function pl(t){return function(s=[],r={publishSource:!0}){const{publishSource:a=!0,clientOffset:l,getSourceClientOffset:o}=r,c=t.getMonitor(),u=t.getRegistry();t.dispatch(bs(l)),hl(s,c,u);const h=ml(s,c);if(h==null){t.dispatch(ul);return}let f=null;if(l){if(!o)throw new Error("getSourceClientOffset must be defined");fl(o),f=o(h)}t.dispatch(bs(l,f));const p=u.getSource(h).beginDrag(c,h);if(p==null)return;gl(p),u.pinSource(h);const g=u.getSourceType(h);return{type:Ft,payload:{itemType:g,item:p,sourceId:h,clientOffset:l||null,sourceClientOffset:f||null,isSourcePublic:!!a}}}}function hl(t,n,s){F(!n.isDragging(),"Cannot call beginDrag while dragging."),t.forEach(function(r){F(s.getSource(r),"Expected sourceIds to be registered.")})}function fl(t){F(typeof t=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function gl(t){F(ka(t),"Item must be an object.")}function ml(t,n){let s=null;for(let r=t.length-1;r>=0;r--)if(n.canDragSource(t[r])){s=t[r];break}return s}function xl(t,n,s){return n in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function bl(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},r=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),r.forEach(function(a){xl(t,a,s[a])})}return t}function vl(t){return function(s={}){const r=t.getMonitor(),a=t.getRegistry();jl(r),Cl(r).forEach((o,c)=>{const u=yl(o,c,a,r),h={type:Nt,payload:{dropResult:bl({},s,u)}};t.dispatch(h)})}}function jl(t){F(t.isDragging(),"Cannot call drop while not dragging."),F(!t.didDrop(),"Cannot call drop twice during one drag operation.")}function yl(t,n,s,r){const a=s.getTarget(t);let l=a?a.drop(r,t):void 0;return Sl(l),typeof l>"u"&&(l=n===0?{}:r.getDropResult()),l}function Sl(t){F(typeof t>"u"||ka(t),"Drop result must either be an object or undefined.")}function Cl(t){const n=t.getTargetIds().filter(t.canDropOnTarget,t);return n.reverse(),n}function wl(t){return function(){const s=t.getMonitor(),r=t.getRegistry();kl(s);const a=s.getSourceId();return a!=null&&(r.getSource(a,!0).endDrag(s,a),r.unpinSource()),{type:Wt}}}function kl(t){F(t.isDragging(),"Cannot call endDrag while not dragging.")}function pn(t,n){return n===null?t===null:Array.isArray(t)?t.some(s=>s===n):t===n}function Dl(t){return function(s,{clientOffset:r}={}){Tl(s);const a=s.slice(0),l=t.getMonitor(),o=t.getRegistry(),c=l.getItemType();return Ol(a,o,c),Ml(a,l,o),El(a,l,o),{type:Rt,payload:{targetIds:a,clientOffset:r||null}}}}function Tl(t){F(Array.isArray(t),"Expected targetIds to be an array.")}function Ml(t,n,s){F(n.isDragging(),"Cannot call hover while not dragging."),F(!n.didDrop(),"Cannot call hover after drop.");for(let r=0;r<t.length;r++){const a=t[r];F(t.lastIndexOf(a)===r,"Expected targetIds to be unique in the passed array.");const l=s.getTarget(a);F(l,"Expected targetIds to be registered.")}}function Ol(t,n,s){for(let r=t.length-1;r>=0;r--){const a=t[r],l=n.getTargetType(a);pn(l,s)||t.splice(r,1)}}function El(t,n,s){t.forEach(function(r){s.getTarget(r).hover(n,r)})}function Al(t){return function(){if(t.getMonitor().isDragging())return{type:Fn}}}function Pl(t){return{beginDrag:pl(t),publishDragSource:Al(t),hover:Dl(t),drop:vl(t),endDrag:wl(t)}}class Il{receiveBackend(n){this.backend=n}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const n=this,{dispatch:s}=this.store;function r(l){return(...o)=>{const c=l.apply(n,o);typeof c<"u"&&s(c)}}const a=Pl(this);return Object.keys(a).reduce((l,o)=>{const c=a[o];return l[o]=r(c),l},{})}dispatch(n){this.store.dispatch(n)}constructor(n,s){this.isSetUp=!1,this.handleRefCountChange=()=>{const r=this.store.getState().refCount>0;this.backend&&(r&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!r&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=n,this.monitor=s,n.subscribe(this.handleRefCountChange)}}function _l(t,n){return{x:t.x+n.x,y:t.y+n.y}}function Da(t,n){return{x:t.x-n.x,y:t.y-n.y}}function Ll(t){const{clientOffset:n,initialClientOffset:s,initialSourceClientOffset:r}=t;return!n||!s||!r?null:Da(_l(n,r),s)}function zl(t){const{clientOffset:n,initialClientOffset:s}=t;return!n||!s?null:Da(n,s)}const Je=[],Rn=[];Je.__IS_NONE__=!0;Rn.__IS_ALL__=!0;function Fl(t,n){return t===Je?!1:t===Rn||typeof n>"u"?!0:dl(n,t).length>0}class Rl{subscribeToStateChange(n,s={}){const{handlerIds:r}=s;F(typeof n=="function","listener must be a function."),F(typeof r>"u"||Array.isArray(r),"handlerIds, when specified, must be an array of strings.");let a=this.store.getState().stateId;const l=()=>{const o=this.store.getState(),c=o.stateId;try{c===a||c===a+1&&!Fl(o.dirtyHandlerIds,r)||n()}finally{a=c}};return this.store.subscribe(l)}subscribeToOffsetChange(n){F(typeof n=="function","listener must be a function.");let s=this.store.getState().dragOffset;const r=()=>{const a=this.store.getState().dragOffset;a!==s&&(s=a,n())};return this.store.subscribe(r)}canDragSource(n){if(!n)return!1;const s=this.registry.getSource(n);return F(s,`Expected to find a valid source. sourceId=${n}`),this.isDragging()?!1:s.canDrag(this,n)}canDropOnTarget(n){if(!n)return!1;const s=this.registry.getTarget(n);if(F(s,`Expected to find a valid target. targetId=${n}`),!this.isDragging()||this.didDrop())return!1;const r=this.registry.getTargetType(n),a=this.getItemType();return pn(r,a)&&s.canDrop(this,n)}isDragging(){return!!this.getItemType()}isDraggingSource(n){if(!n)return!1;const s=this.registry.getSource(n,!0);if(F(s,`Expected to find a valid source. sourceId=${n}`),!this.isDragging()||!this.isSourcePublic())return!1;const r=this.registry.getSourceType(n),a=this.getItemType();return r!==a?!1:s.isDragging(this,n)}isOverTarget(n,s={shallow:!1}){if(!n)return!1;const{shallow:r}=s;if(!this.isDragging())return!1;const a=this.registry.getTargetType(n),l=this.getItemType();if(l&&!pn(a,l))return!1;const o=this.getTargetIds();if(!o.length)return!1;const c=o.indexOf(n);return r?c===o.length-1:c>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return Ll(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return zl(this.store.getState().dragOffset)}constructor(n,s){this.store=n,this.registry=s}}const vs=typeof global<"u"?global:self,Ta=vs.MutationObserver||vs.WebKitMutationObserver;function Ma(t){return function(){const s=setTimeout(a,0),r=setInterval(a,50);function a(){clearTimeout(s),clearInterval(r),t()}}}function Nl(t){let n=1;const s=new Ta(t),r=document.createTextNode("");return s.observe(r,{characterData:!0}),function(){n=-n,r.data=n}}const Wl=typeof Ta=="function"?Nl:Ma;class Hl{enqueueTask(n){const{queue:s,requestFlush:r}=this;s.length||(r(),this.flushing=!0),s[s.length]=n}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:n}=this;for(;this.index<n.length;){const s=this.index;if(this.index++,n[s].call(),this.index>this.capacity){for(let r=0,a=n.length-this.index;r<a;r++)n[r]=n[r+this.index];n.length-=this.index,this.index=0}}n.length=0,this.index=0,this.flushing=!1},this.registerPendingError=n=>{this.pendingErrors.push(n),this.requestErrorThrow()},this.requestFlush=Wl(this.flush),this.requestErrorThrow=Ma(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class Bl{call(){try{this.task&&this.task()}catch(n){this.onError(n)}finally{this.task=null,this.release(this)}}constructor(n,s){this.onError=n,this.release=s,this.task=null}}class Ul{create(n){const s=this.freeTasks,r=s.length?s.pop():new Bl(this.onError,a=>s[s.length]=a);return r.task=n,r}constructor(n){this.onError=n,this.freeTasks=[]}}const Oa=new Hl,Vl=new Ul(Oa.registerPendingError);function $l(t){Oa.enqueueTask(Vl.create(t))}const Nn="dnd-core/ADD_SOURCE",Wn="dnd-core/ADD_TARGET",Hn="dnd-core/REMOVE_SOURCE",Ht="dnd-core/REMOVE_TARGET";function ql(t){return{type:Nn,payload:{sourceId:t}}}function Gl(t){return{type:Wn,payload:{targetId:t}}}function Xl(t){return{type:Hn,payload:{sourceId:t}}}function Zl(t){return{type:Ht,payload:{targetId:t}}}function Yl(t){F(typeof t.canDrag=="function","Expected canDrag to be a function."),F(typeof t.beginDrag=="function","Expected beginDrag to be a function."),F(typeof t.endDrag=="function","Expected endDrag to be a function.")}function Jl(t){F(typeof t.canDrop=="function","Expected canDrop to be a function."),F(typeof t.hover=="function","Expected hover to be a function."),F(typeof t.drop=="function","Expected beginDrag to be a function.")}function hn(t,n){if(n&&Array.isArray(t)){t.forEach(s=>hn(s,!1));return}F(typeof t=="string"||typeof t=="symbol",n?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var je;(function(t){t.SOURCE="SOURCE",t.TARGET="TARGET"})(je||(je={}));let Kl=0;function Ql(){return Kl++}function ec(t){const n=Ql().toString();switch(t){case je.SOURCE:return`S${n}`;case je.TARGET:return`T${n}`;default:throw new Error(`Unknown Handler Role: ${t}`)}}function js(t){switch(t[0]){case"S":return je.SOURCE;case"T":return je.TARGET;default:throw new Error(`Cannot parse handler ID: ${t}`)}}function ys(t,n){const s=t.entries();let r=!1;do{const{done:a,value:[,l]}=s.next();if(l===n)return!0;r=!!a}while(!r);return!1}class tc{addSource(n,s){hn(n),Yl(s);const r=this.addHandler(je.SOURCE,n,s);return this.store.dispatch(ql(r)),r}addTarget(n,s){hn(n,!0),Jl(s);const r=this.addHandler(je.TARGET,n,s);return this.store.dispatch(Gl(r)),r}containsHandler(n){return ys(this.dragSources,n)||ys(this.dropTargets,n)}getSource(n,s=!1){return F(this.isSourceId(n),"Expected a valid source ID."),s&&n===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(n)}getTarget(n){return F(this.isTargetId(n),"Expected a valid target ID."),this.dropTargets.get(n)}getSourceType(n){return F(this.isSourceId(n),"Expected a valid source ID."),this.types.get(n)}getTargetType(n){return F(this.isTargetId(n),"Expected a valid target ID."),this.types.get(n)}isSourceId(n){return js(n)===je.SOURCE}isTargetId(n){return js(n)===je.TARGET}removeSource(n){F(this.getSource(n),"Expected an existing source."),this.store.dispatch(Xl(n)),$l(()=>{this.dragSources.delete(n),this.types.delete(n)})}removeTarget(n){F(this.getTarget(n),"Expected an existing target."),this.store.dispatch(Zl(n)),this.dropTargets.delete(n),this.types.delete(n)}pinSource(n){const s=this.getSource(n);F(s,"Expected an existing source."),this.pinnedSourceId=n,this.pinnedSource=s}unpinSource(){F(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(n,s,r){const a=ec(n);return this.types.set(a,s),n===je.SOURCE?this.dragSources.set(a,r):n===je.TARGET&&this.dropTargets.set(a,r),a}constructor(n){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=n}}const nc=(t,n)=>t===n;function sc(t,n){return!t&&!n?!0:!t||!n?!1:t.x===n.x&&t.y===n.y}function ac(t,n,s=nc){if(t.length!==n.length)return!1;for(let r=0;r<t.length;++r)if(!s(t[r],n[r]))return!1;return!0}function rc(t=Je,n){switch(n.type){case Rt:break;case Nn:case Wn:case Ht:case Hn:return Je;case Ft:case Fn:case Wt:case Nt:default:return Rn}const{targetIds:s=[],prevTargetIds:r=[]}=n.payload,a=cl(s,r);if(!(a.length>0||!ac(s,r)))return Je;const o=r[r.length-1],c=s[s.length-1];return o!==c&&(o&&a.push(o),c&&a.push(c)),a}function oc(t,n,s){return n in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function ic(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},r=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),r.forEach(function(a){oc(t,a,s[a])})}return t}const Ss={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function lc(t=Ss,n){const{payload:s}=n;switch(n.type){case zn:case Ft:return{initialSourceClientOffset:s.sourceClientOffset,initialClientOffset:s.clientOffset,clientOffset:s.clientOffset};case Rt:return sc(t.clientOffset,s.clientOffset)?t:ic({},t,{clientOffset:s.clientOffset});case Wt:case Nt:return Ss;default:return t}}function cc(t,n,s){return n in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function We(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},r=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),r.forEach(function(a){cc(t,a,s[a])})}return t}const dc={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function uc(t=dc,n){const{payload:s}=n;switch(n.type){case Ft:return We({},t,{itemType:s.itemType,item:s.item,sourceId:s.sourceId,isSourcePublic:s.isSourcePublic,dropResult:null,didDrop:!1});case Fn:return We({},t,{isSourcePublic:!0});case Rt:return We({},t,{targetIds:s.targetIds});case Ht:return t.targetIds.indexOf(s.targetId)===-1?t:We({},t,{targetIds:ll(t.targetIds,s.targetId)});case Nt:return We({},t,{dropResult:s.dropResult,didDrop:!0,targetIds:[]});case Wt:return We({},t,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return t}}function pc(t=0,n){switch(n.type){case Nn:case Wn:return t+1;case Hn:case Ht:return t-1;default:return t}}function hc(t=0){return t+1}function fc(t,n,s){return n in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function gc(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},r=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),r.forEach(function(a){fc(t,a,s[a])})}return t}function mc(t={},n){return{dirtyHandlerIds:rc(t.dirtyHandlerIds,{type:n.type,payload:gc({},n.payload,{prevTargetIds:il(t,"dragOperation.targetIds",[])})}),dragOffset:lc(t.dragOffset,n),refCount:pc(t.refCount,n),dragOperation:uc(t.dragOperation,n),stateId:hc(t.stateId)}}function xc(t,n=void 0,s={},r=!1){const a=bc(r),l=new Rl(a,new tc(a)),o=new Il(a,l),c=t(o,n,s);return o.receiveBackend(c),o}function bc(t){const n=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return wa(mc,t&&n&&n({name:"dnd-core",instanceId:"dnd-core"}))}function vc(t,n){if(t==null)return{};var s=jc(t,n),r,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)r=l[a],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function jc(t,n){if(t==null)return{};var s={},r=Object.keys(t),a,l;for(l=0;l<r.length;l++)a=r[l],!(n.indexOf(a)>=0)&&(s[a]=t[a]);return s}let Cs=0;const ft=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var yc=i.memo(function(n){var{children:s}=n,r=vc(n,["children"]);const[a,l]=Sc(r);return i.useEffect(()=>{if(l){const o=Ea();return++Cs,()=>{--Cs===0&&(o[ft]=null)}}},[]),e.jsx(Za.Provider,{value:a,children:s})});function Sc(t){if("manager"in t)return[{dragDropManager:t.manager},!1];const n=Cc(t.backend,t.context,t.options,t.debugMode),s=!t.context;return[n,s]}function Cc(t,n=Ea(),s,r){const a=n;return a[ft]||(a[ft]={dragDropManager:xc(t,n,s,r)}),a[ft]}function Ea(){return typeof global<"u"?global:window}function wc(t){const s=Ya().getMonitor(),[r,a]=Ja(s,t);return i.useEffect(()=>s.subscribeToOffsetChange(a)),i.useEffect(()=>s.subscribeToStateChange(a)),r}function Aa(t){let n=null;return()=>(n==null&&(n=t()),n)}function kc(t,n){return t.filter(s=>s!==n)}function Dc(t,n){const s=new Set,r=l=>s.add(l);t.forEach(r),n.forEach(r);const a=[];return s.forEach(l=>a.push(l)),a}class Tc{enter(n){const s=this.entered.length,r=a=>this.isNodeInDocument(a)&&(!a.contains||a.contains(n));return this.entered=Dc(this.entered.filter(r),[n]),s===0&&this.entered.length>0}leave(n){const s=this.entered.length;return this.entered=kc(this.entered.filter(this.isNodeInDocument),n),s>0&&this.entered.length===0}reset(){this.entered=[]}constructor(n){this.entered=[],this.isNodeInDocument=n}}class Mc{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(n=>{Object.defineProperty(this.item,n,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${n}" until the drop event.`),null}})})}loadDataTransfer(n){if(n){const s={};Object.keys(this.config.exposeProperties).forEach(r=>{const a=this.config.exposeProperties[r];a!=null&&(s[r]={value:a(n,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,s)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(n,s){return s===n.getSourceId()}endDrag(){}constructor(n){this.config=n,this.item={},this.initializeExposedProperties()}}const Pa="__NATIVE_FILE__",Ia="__NATIVE_URL__",_a="__NATIVE_TEXT__",La="__NATIVE_HTML__",ws=Object.freeze(Object.defineProperty({__proto__:null,FILE:Pa,HTML:La,TEXT:_a,URL:Ia},Symbol.toStringTag,{value:"Module"}));function Yt(t,n,s){const r=n.reduce((a,l)=>a||t.getData(l),"");return r??s}const fn={[Pa]:{exposeProperties:{files:t=>Array.prototype.slice.call(t.files),items:t=>t.items,dataTransfer:t=>t},matchesTypes:["Files"]},[La]:{exposeProperties:{html:(t,n)=>Yt(t,n,""),dataTransfer:t=>t},matchesTypes:["Html","text/html"]},[Ia]:{exposeProperties:{urls:(t,n)=>Yt(t,n,"").split(`
`),dataTransfer:t=>t},matchesTypes:["Url","text/uri-list"]},[_a]:{exposeProperties:{text:(t,n)=>Yt(t,n,""),dataTransfer:t=>t},matchesTypes:["Text","text/plain"]}};function Oc(t,n){const s=fn[t];if(!s)throw new Error(`native type ${t} has no configuration`);const r=new Mc(s);return r.loadDataTransfer(n),r}function Jt(t){if(!t)return null;const n=Array.prototype.slice.call(t.types||[]);return Object.keys(fn).filter(s=>{const r=fn[s];return r!=null&&r.matchesTypes?r.matchesTypes.some(a=>n.indexOf(a)>-1):!1})[0]||null}const Ec=Aa(()=>/firefox/i.test(navigator.userAgent)),za=Aa(()=>!!window.safari);class ks{interpolate(n){const{xs:s,ys:r,c1s:a,c2s:l,c3s:o}=this;let c=s.length-1;if(n===s[c])return r[c];let u=0,h=o.length-1,f;for(;u<=h;){f=Math.floor(.5*(u+h));const g=s[f];if(g<n)u=f+1;else if(g>n)h=f-1;else return r[f]}c=Math.max(0,h);const d=n-s[c],p=d*d;return r[c]+a[c]*d+l[c]*p+o[c]*d*p}constructor(n,s){const{length:r}=n,a=[];for(let g=0;g<r;g++)a.push(g);a.sort((g,m)=>n[g]<n[m]?-1:1);const l=[],o=[];let c,u;for(let g=0;g<r-1;g++)c=n[g+1]-n[g],u=s[g+1]-s[g],l.push(c),o.push(u/c);const h=[o[0]];for(let g=0;g<l.length-1;g++){const m=o[g],x=o[g+1];if(m*x<=0)h.push(0);else{c=l[g];const j=l[g+1],v=c+j;h.push(3*v/((v+j)/m+(v+c)/x))}}h.push(o[o.length-1]);const f=[],d=[];let p;for(let g=0;g<h.length-1;g++){p=o[g];const m=h[g],x=1/l[g],j=m+h[g+1]-p-p;f.push((p-m-j)*x),d.push(j*x*x)}this.xs=n,this.ys=s,this.c1s=h,this.c2s=f,this.c3s=d}}const Ac=1;function Fa(t){const n=t.nodeType===Ac?t:t.parentElement;if(!n)return null;const{top:s,left:r}=n.getBoundingClientRect();return{x:r,y:s}}function it(t){return{x:t.clientX,y:t.clientY}}function Pc(t){var n;return t.nodeName==="IMG"&&(Ec()||!(!((n=document.documentElement)===null||n===void 0)&&n.contains(t)))}function Ic(t,n,s,r){let a=t?n.width:s,l=t?n.height:r;return za()&&t&&(l/=window.devicePixelRatio,a/=window.devicePixelRatio),{dragPreviewWidth:a,dragPreviewHeight:l}}function _c(t,n,s,r,a){const l=Pc(n),c=Fa(l?t:n),u={x:s.x-c.x,y:s.y-c.y},{offsetWidth:h,offsetHeight:f}=t,{anchorX:d,anchorY:p}=r,{dragPreviewWidth:g,dragPreviewHeight:m}=Ic(l,n,h,f),x=()=>{let b=new ks([0,.5,1],[u.y,u.y/f*m,u.y+m-f]).interpolate(p);return za()&&l&&(b+=(window.devicePixelRatio-1)*m),b},j=()=>new ks([0,.5,1],[u.x,u.x/h*g,u.x+g-h]).interpolate(d),{offsetX:v,offsetY:k}=a,w=v===0||v,D=k===0||k;return{x:w?v:j(),y:D?k:x()}}class Lc{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var n;return!((n=this.globalContext)===null||n===void 0)&&n.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var n;return((n=this.optionsArgs)===null||n===void 0?void 0:n.rootElement)||this.window}constructor(n,s){this.ownerDocument=null,this.globalContext=n,this.optionsArgs=s}}function zc(t,n,s){return n in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,t}function Ds(t){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},r=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),r.forEach(function(a){zc(t,a,s[a])})}return t}class Fc{profile(){var n,s;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((n=this.dragStartSourceIds)===null||n===void 0?void 0:n.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((s=this.dragOverTargetIds)===null||s===void 0?void 0:s.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const n=this.rootElement;if(n!==void 0){if(n.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");n.__isReactDndBackendSetUp=!0,this.addEventListeners(n)}}teardown(){const n=this.rootElement;if(n!==void 0&&(n.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var s;(s=this.window)===null||s===void 0||s.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(n,s,r){return this.sourcePreviewNodeOptions.set(n,r),this.sourcePreviewNodes.set(n,s),()=>{this.sourcePreviewNodes.delete(n),this.sourcePreviewNodeOptions.delete(n)}}connectDragSource(n,s,r){this.sourceNodes.set(n,s),this.sourceNodeOptions.set(n,r);const a=o=>this.handleDragStart(o,n),l=o=>this.handleSelectStart(o);return s.setAttribute("draggable","true"),s.addEventListener("dragstart",a),s.addEventListener("selectstart",l),()=>{this.sourceNodes.delete(n),this.sourceNodeOptions.delete(n),s.removeEventListener("dragstart",a),s.removeEventListener("selectstart",l),s.setAttribute("draggable","false")}}connectDropTarget(n,s){const r=o=>this.handleDragEnter(o,n),a=o=>this.handleDragOver(o,n),l=o=>this.handleDrop(o,n);return s.addEventListener("dragenter",r),s.addEventListener("dragover",a),s.addEventListener("drop",l),()=>{s.removeEventListener("dragenter",r),s.removeEventListener("dragover",a),s.removeEventListener("drop",l)}}addEventListeners(n){n.addEventListener&&(n.addEventListener("dragstart",this.handleTopDragStart),n.addEventListener("dragstart",this.handleTopDragStartCapture,!0),n.addEventListener("dragend",this.handleTopDragEndCapture,!0),n.addEventListener("dragenter",this.handleTopDragEnter),n.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),n.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),n.addEventListener("dragover",this.handleTopDragOver),n.addEventListener("dragover",this.handleTopDragOverCapture,!0),n.addEventListener("drop",this.handleTopDrop),n.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(n){n.removeEventListener&&(n.removeEventListener("dragstart",this.handleTopDragStart),n.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),n.removeEventListener("dragend",this.handleTopDragEndCapture,!0),n.removeEventListener("dragenter",this.handleTopDragEnter),n.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),n.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),n.removeEventListener("dragover",this.handleTopDragOver),n.removeEventListener("dragover",this.handleTopDragOverCapture,!0),n.removeEventListener("drop",this.handleTopDrop),n.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const n=this.monitor.getSourceId(),s=this.sourceNodeOptions.get(n);return Ds({dropEffect:this.altKeyPressed?"copy":"move"},s||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const n=this.monitor.getSourceId(),s=this.sourcePreviewNodeOptions.get(n);return Ds({anchorX:.5,anchorY:.5,captureDraggingState:!1},s||{})}isDraggingNativeItem(){const n=this.monitor.getItemType();return Object.keys(ws).some(s=>ws[s]===n)}beginDragNativeItem(n,s){this.clearCurrentDragSourceNode(),this.currentNativeSource=Oc(n,s),this.currentNativeHandle=this.registry.addSource(n,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(n){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=n;const s=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var r;return(r=this.rootElement)===null||r===void 0?void 0:r.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},s)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var n;(n=this.window)===null||n===void 0||n.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(n,s){n.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(s))}handleDragEnter(n,s){this.dragEnterTargetIds.unshift(s)}handleDragOver(n,s){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(s)}handleDrop(n,s){this.dropTargetIds.unshift(s)}constructor(n,s,r){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=a=>{const l=this.sourceNodes.get(a);return l&&Fa(l)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=a=>!!(a&&this.document&&this.document.body&&this.document.body.contains(a)),this.endDragIfSourceWasRemovedFromDOM=()=>{const a=this.currentDragSourceNode;a==null||this.isNodeInDocument(a)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=a=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(a||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=a=>{if(a.defaultPrevented)return;const{dragStartSourceIds:l}=this;this.dragStartSourceIds=null;const o=it(a);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(l||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:o});const{dataTransfer:c}=a,u=Jt(c);if(this.monitor.isDragging()){if(c&&typeof c.setDragImage=="function"){const f=this.monitor.getSourceId(),d=this.sourceNodes.get(f),p=this.sourcePreviewNodes.get(f)||d;if(p){const{anchorX:g,anchorY:m,offsetX:x,offsetY:j}=this.getCurrentSourcePreviewNodeOptions(),w=_c(d,p,o,{anchorX:g,anchorY:m},{offsetX:x,offsetY:j});c.setDragImage(p,w.x,w.y)}}try{c==null||c.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(a.target);const{captureDraggingState:h}=this.getCurrentSourcePreviewNodeOptions();h?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(u)this.beginDragNativeItem(u);else{if(c&&!c.types&&(a.target&&!a.target.hasAttribute||!a.target.hasAttribute("draggable")))return;a.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=a=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var l;(l=this.currentNativeSource)===null||l===void 0||l.loadDataTransfer(a.dataTransfer)}if(!this.enterLeaveCounter.enter(a.target)||this.monitor.isDragging())return;const{dataTransfer:c}=a,u=Jt(c);u&&this.beginDragNativeItem(u,c)},this.handleTopDragEnter=a=>{const{dragEnterTargetIds:l}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=a.altKey,l.length>0&&this.actions.hover(l,{clientOffset:it(a)}),l.some(c=>this.monitor.canDropOnTarget(c))&&(a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=a=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var l;(l=this.currentNativeSource)===null||l===void 0||l.loadDataTransfer(a.dataTransfer)}},this.handleTopDragOver=a=>{const{dragOverTargetIds:l}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect="none");return}this.altKeyPressed=a.altKey,this.lastClientOffset=it(a),this.scheduleHover(l),(l||[]).some(c=>this.monitor.canDropOnTarget(c))?(a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?a.preventDefault():(a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=a=>{this.isDraggingNativeItem()&&a.preventDefault(),this.enterLeaveCounter.leave(a.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=a=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var l;a.preventDefault(),(l=this.currentNativeSource)===null||l===void 0||l.loadDataTransfer(a.dataTransfer)}else Jt(a.dataTransfer)&&a.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=a=>{const{dropTargetIds:l}=this;this.dropTargetIds=[],this.actions.hover(l,{clientOffset:it(a)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=a=>{const l=a.target;typeof l.dragDrop=="function"&&(l.tagName==="INPUT"||l.tagName==="SELECT"||l.tagName==="TEXTAREA"||l.isContentEditable||(a.preventDefault(),l.dragDrop()))},this.options=new Lc(s,r),this.actions=n.getActions(),this.monitor=n.getMonitor(),this.registry=n.getRegistry(),this.enterLeaveCounter=new Tc(this.isNodeInDocument)}}const Rc=function(n,s,r){return new Fc(n,s,r)};de.extend(Ka);const Nc=()=>{const{t}=P(),n=L(),[s,r]=i.useState(!1),[a,l]=i.useState(!1),o=C(b=>b.fileManager[0].deleteFileModalOpen),c=C(b=>b.fileManager[0].deleteFileModalSelected),u=C(b=>b.fileManager[0].deleteFileModalPromiseId),h=C(b=>b.fileManager[0].deleteFileModalLoading),f=i.useMemo(()=>c?c.some(b=>b.metadata&&b.metadata[R.restore_uri]):!1,[c]),d=i.useCallback(()=>{var b;n(Qa({index:0,value:[!1,c,void 0,!1]})),u&&((b=$n[u])==null||b.reject("cancel"))},[n,c,u]),p=c&&c.length==1&&!f&&!a,g=c&&c.length>1&&!f&&!a,m=c&&c.length==1&&(f||a),x=c&&c.length>1&&(f||a),j=i.useCallback(()=>{var b;u&&((b=$n[u])==null||b.resolve({unlink:s,skip_soft_delete:m||x?!0:a}))},[u,s,a,m,x]),v=$.currentUserGroupPermission(),k=!f,w=(a||f)&&v.enabled(Be.advance_delete),D=w||k,y=i.useMemo(()=>$.currentUserGroup(),[o]);return e.jsx(oe,{title:t("application:modals.deleteTitle"),showActions:!0,loading:h,showCancel:!0,onAccept:j,dialogProps:{open:o??!1,onClose:d,fullWidth:!0,maxWidth:"xs"},children:e.jsx(se,{children:e.jsxs(J,{spacing:2,children:[e.jsxs(Tt,{children:[(p||m)&&e.jsx(Ke,{i18nKey:p?"modals.deleteOneDescription":"modals.deleteOneDescriptionHard",ns:"application",values:{name:c[0].name},components:[e.jsx("strong",{},0)]}),(g||x)&&t(g?"application:modals.deleteMultipleDescription":"application:modals.deleteMultipleDescriptionHard",{num:c.length}),e.jsx(ze,{in:p||g,children:e.jsx(er,{sx:{mt:1},severity:"info",children:e.jsx(Ke,{i18nKey:"application:modals.trashRetention",ns:"application",values:{num:tr(de.duration(((y==null?void 0:y.trash_retention)??0)*1e3))},components:[e.jsx("strong",{},0)]})})})]}),D&&e.jsx(qs,{defaultExpanded:s||a,title:t("application:modals.advanceOptions"),children:e.jsxs(ji,{children:[e.jsx(ze,{in:k,children:e.jsx(Q,{title:t("application:modals.skipSoftDeleteDes"),children:e.jsx(xt,{control:e.jsx(Ee,{size:"small",onChange:b=>l(b.target.checked),checked:a}),label:t("application:modals.skipSoftDelete")})})}),e.jsx(ze,{in:w,children:e.jsx(Q,{title:t("application:modals.unlinkOnlyDes"),children:e.jsx(xt,{control:e.jsx(Ee,{size:"small",onChange:b=>r(b.target.checked),checked:s}),label:t("application:modals.unlinkOnly")})})})]})})]})})})},Wc=t=>{const{t:n}=P();return e.jsx(Mt,{component:Ot,children:e.jsxs(Et,{sx:{width:"100%"},size:"small",children:[e.jsx(At,{children:e.jsxs(ke,{children:[e.jsx(Se,{children:n("common:object")}),e.jsx(Se,{children:n("common:error")})]})}),e.jsx(Pt,{children:Object.keys(t.errors).map(s=>e.jsxs(ke,{hover:!0,sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsxs(Se,{component:"th",scope:"row",children:[t.files[s]&&e.jsx(bt,{sx:{maxWidth:"250px"},file:t.files[s]}),!t.files[s]&&!s.startsWith(Gn)&&s,!t.files[s]&&s.startsWith(Gn)&&e.jsx(bt,{sx:{maxWidth:"250px"},simplifiedFile:{type:Te.file,path:s}})]}),e.jsx(Se,{children:t.errors[s].message})]},s))})]})})},Hc=()=>{const{t}=P(),n=L(),s=C(u=>u.globalState.aggregatedErrorDialogOpen),r=C(u=>u.globalState.aggregatedErrorFile),a=C(u=>u.globalState.aggregatedError),l=i.useCallback(()=>{n(nr())},[n]),[o,c]=i.useMemo(()=>{if(!a)return[void 0,void 0];let u=new qn(a);const h={};return Object.keys(a.aggregated_error??{}).forEach(f=>{var p;const d=(p=a.aggregated_error)==null?void 0:p[f];d&&(h[f]=new qn(d))}),[u,h]},[a]);return e.jsx(oe,{title:t("application:modals.errorDetailsTitle"),dialogProps:{open:s??!1,onClose:l,fullWidth:!0,maxWidth:"sm"},children:e.jsx(se,{children:e.jsxs(J,{spacing:2,children:[e.jsx(Tt,{children:o&&o.message}),r&&c&&e.jsx(Wc,{errors:c,files:r}),o&&o.cid&&e.jsx(sr,{variant:"caption",children:e.jsx("code",{children:t("common:requestID",{id:o.cid})})})]})})})},Bc=()=>{const{t}=P(),n=L(),[s,r]=i.useState(""),a=i.useRef(null),l=i.useRef(null);i.useContext(ar);const o=C(x=>x.fileManager[0].renameFileModalOpen),c=C(x=>x.fileManager[0].renameFileModalSelected),u=C(x=>x.fileManager[0].renameFileModalPromiseId),h=C(x=>x.fileManager[0].renameFileModalLoading),f=C(x=>x.fileManager[0].renameFileModalError),d=i.useCallback(()=>{var x;n(rr({index:0,value:void 0})),u&&((x=Xn[u])==null||x.reject("cancel"))},[n,c,u]),p=i.useCallback(x=>{var j;x&&x.preventDefault(),u&&n(or(0,(j=Xn[u])==null?void 0:j.resolve,s))},[u,s]),g=i.useCallback(()=>{a.current&&a.current.reportValidity()&&p()},[a,p]);i.useEffect(()=>{c&&o&&r(c.name)},[c,o]),i.useEffect(()=>{if(c&&o&&l.current){const x=c.type==Te.folder?0:c.name.lastIndexOf(".");l.current.setSelectionRange(0,x>0?x:c.name.length)}},[l.current,o]);const m=i.useCallback(x=>{r(x.target.value),f&&n(Gs({index:0,value:void 0}))},[n,r,f]);return e.jsx(oe,{title:t("application:fileManager.rename"),showActions:!0,loading:h,showCancel:!0,onAccept:g,dialogProps:{open:o??!1,onClose:d,fullWidth:!0,maxWidth:"sm",disableRestoreFocus:!0},children:e.jsx(se,{children:e.jsxs(J,{spacing:2,children:[e.jsx(Tt,{children:e.jsx(Ke,{i18nKey:"modals.renameDescription",ns:"application",values:{name:c==null?void 0:c.name},components:[e.jsx("strong",{},0)]})}),e.jsx("form",{ref:a,onSubmit:p,children:e.jsx(Ve,{inputRef:l,variant:"filled",autoFocus:!0,error:!!f,helperText:f,margin:"dense",label:t("application:modals.newName"),type:"text",value:s,onChange:m,fullWidth:!0,required:!0})})]})})})};function Ts(t){const{children:n,value:s,index:r,...a}=t;return e.jsx("div",{role:"tabpanel",hidden:s!==r,id:`simple-tabpanel-${r}`,"aria-labelledby":`simple-tab-${r}`,...a,children:s===r&&n})}const Ms=N(ir)(({theme:t})=>({minWidth:0,minHeight:0,fontSize:t.typography.h6.fontSize,padding:"8px 10px"})),Os=N(Re)(({theme:t})=>({minWidth:0,padding:"0px 4px",fontSize:t.typography.h6.fontSize})),Es=N(M)({display:"flex",flexWrap:"wrap"}),Uc=()=>{const{t}=P(),n=L();X();const[s,r]=i.useState(0),[a,l]=i.useState(!1),o=C(m=>m.globalState.changeIconDialogOpen),c=C(m=>m.globalState.changeIconDialogFile),u=C(m=>m.siteConfig.emojis.config.emoji_preset),h=C(m=>m.siteConfig.emojis.loaded),f=i.useMemo(()=>{if(!u)return{};try{return JSON.parse(u)}catch(m){console.warn("failed to parse emoji setting",m)}return{}},[u]),d=(m,x)=>{r(x)};i.useEffect(()=>{o&&h!=lr.Loaded&&n(cr("emojis"))},[o]);const p=i.useCallback(()=>{a||n(Zn())},[n,a]),g=i.useCallback(m=>async x=>{if(x&&x.preventDefault(),!!c){l(!0);try{await n(dr(ee.main,c,m))}catch{}finally{l(!1),n(Zn())}}},[n,c,l]);return e.jsx(oe,{title:t("application:fileManager.customizeIcon"),showActions:!0,loading:a,showCancel:!0,hideOk:!0,dialogProps:{open:o??!1,onClose:p,fullWidth:!0,maxWidth:"sm"},secondaryAction:e.jsx(gn,{onClick:g(),loading:a,color:"primary",children:e.jsx("span",{children:t("application:modals.resetToDefault")})}),children:e.jsx(se,{children:e.jsx(qe,{children:e.jsxs(M,{sx:{width:"100%"},children:[e.jsx(M,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsx(ur,{sx:{minHeight:0},value:s,variant:"scrollable",scrollButtons:"auto",onChange:d,children:h?Object.keys(f).map(m=>e.jsx(Ms,{label:m},m)):e.jsx(Ms,{label:e.jsx(Pe,{sx:{minWidth:"20px"}})})})}),e.jsx(M,{sx:{maxHeight:"200px",overflowY:"auto"},children:h?Object.keys(f).map((m,x)=>e.jsx(Ts,{value:s,index:x,children:e.jsx(Es,{children:f[m].map(j=>e.jsx(Os,{onClick:g(j),children:j}))})})):e.jsx(Ts,{value:s,index:0,children:e.jsx(Es,{children:[...Array(50).keys()].map(()=>e.jsx(Os,{disabled:!0,children:e.jsx(Pe,{sx:{minWidth:"20px"}})}))})})})]})})})})},Vc=ge(e.jsx("path",{d:"M4.5 11a8.5 8.5 0 1 1 8.188 8.494a6.47 6.47 0 0 1-.68 1.457c.327.033.658.049.992.049c5.523 0 10-4.477 10-10S18.523 1 13 1S3 5.477 3 11c0 .334.016.665.048.991a6.51 6.51 0 0 1 1.458-.68A8.65 8.65 0 0 1 4.5 11m8.493-5.352a.75.75 0 0 0-1.493.102v6l.007.102a.75.75 0 0 0 .743.648h4l.102-.007A.75.75 0 0 0 16.25 11H13V5.75zM1 17.5a5.5 5.5 0 0 1 5-5.477v5.77l-1.646-1.647a.5.5 0 0 0-.708.708l2.5 2.5a.5.5 0 0 0 .708 0l2.5-2.5a.5.5 0 0 0-.708-.708L7 17.793v-5.77A5.5 5.5 0 1 1 1 17.5m8.5 3A.5.5 0 0 0 9 20H4a.5.5 0 0 0 0 1h5a.5.5 0 0 0 .5-.5"}),"ClockArrowDownload"),lt=N(mn)(()=>({border:"0px solid rgba(0, 0, 0, .125)",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},".Mui-expanded":{margin:"0 0",minHeight:0},"&.Mui-expanded":{margin:"0 0",minHeight:0}})),ct=N(Xs)(({theme:t})=>({padding:0,"& .MuiAccordionSummary-content":{margin:0,display:"initial","&.Mui-expanded":{margin:"0 0"}},"&.Mui-expanded":{borderRadius:"12px 12px 0 0",backgroundColor:t.palette.mode=="light"?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",minHeight:"0px!important"}})),dt=N(xn)(({theme:t})=>({padding:24,backgroundColor:t.palette.mode=="light"?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",borderRadius:"0 0 12px 12px",fontSize:t.typography.body2.fontSize,color:t.palette.text.secondary})),ut=N(Zs)(()=>({})),Bn=[{value:300,label:"modals.5minutes"},{value:3600,label:"modals.1hour"},{value:24*3600,label:"modals.1day"},{value:7*24*3600,label:"modals.7days"},{value:30*24*3600,label:"modals.30days"}],Un=[{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4"},{value:5,label:"5"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"}],As=t=>(typeof t=="number"||typeof t=="string"&&t.trim()!=="")&&!isNaN(t),Ps=mr(),$c=({setting:t,file:n,editing:s,onSettingChange:r})=>{const{t:a}=P(),[l,o]=i.useState(void 0),c=h=>(f,d)=>{o(d?h:void 0)},u=h=>()=>{t[h]||c(h)(null,!0),r({...t,[h]:!t[h]})};return e.jsxs(pr,{sx:{padding:0},children:[e.jsxs(lt,{expanded:l==="is_private",onChange:c("is_private"),children:[e.jsx(ct,{"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsxs(ut,{children:[e.jsx(ce,{children:e.jsx(hr,{})}),e.jsx(q,{primary:a("application:modals.privateShare")}),e.jsx(rt,{children:e.jsx(Ee,{disabled:s,checked:!!t.is_private,onChange:u("is_private")})})]})}),e.jsxs(dt,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(re,{variant:"body2",children:a("application:modals.privateShareDes")}),t.is_private&&e.jsxs(J,{sx:{mt:1,width:"100%"},children:[!s&&e.jsx(xt,{control:e.jsx(Ee,{size:"small",checked:t.use_custom_password,onChange:()=>{r({...t,use_custom_password:!t.use_custom_password})}}),label:a("application:modals.useCustomPassword")}),e.jsx(ze,{in:t.use_custom_password,children:e.jsx(Ue,{variant:"standard",fullWidth:!0,sx:{mt:1},children:e.jsx(Ve,{label:a("application:modals.sharePassword"),disabled:s,slotProps:{htmlInput:{maxLength:32}},value:t.password??"",onChange:h=>{const f=h.target.value.trim();!/^[a-zA-Z0-9]*$/.test(f)||f.length>32||r({...t,password:f})},required:!0})})})]})]})]}),(n==null?void 0:n.type)==Te.folder&&e.jsxs(lt,{expanded:l==="share_view",onChange:c("share_view"),children:[e.jsx(ct,{"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsxs(ut,{children:[e.jsx(ce,{children:e.jsx(fr,{})}),e.jsx(q,{primary:a("application:modals.shareView")}),e.jsx(rt,{children:e.jsx(Ee,{checked:t.share_view,onChange:u("share_view")})})]})}),e.jsx(dt,{children:a("application:modals.shareViewDes")})]}),e.jsxs(lt,{expanded:l==="expires",onChange:c("expires"),children:[e.jsx(ct,{"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsxs(ut,{children:[e.jsx(ce,{children:e.jsx(gr,{})}),e.jsx(q,{primary:a("modals.expireAutomatically")}),e.jsx(rt,{children:e.jsx(Ee,{checked:t.expires,onChange:u("expires")})})]})}),e.jsxs(dt,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(re,{children:a("application:modals.expirePrefix")}),e.jsx(Ue,{variant:"standard",style:{marginRight:10,marginLeft:10},children:e.jsx(Yn,{value:t.expires_val,filterOptions:(h,f)=>{const d=Ps(h,f),{inputValue:p}=f,g=parseInt(p)*60;return p!==""&&As(p)&&parseInt(p)>0&&g!=300&&d.push({inputValue:p,value:g,label:p+" "+a("application:modals.minutes")}),d},onChange:(h,f)=>{let d=0,p="";typeof f=="string"?(d=parseInt(f),p=f+" "+a("application:modals.minutes")):(d=(f==null?void 0:f.value)??0,p=(f==null?void 0:f.label)??""),r({...t,expires_val:{value:d,label:p}})},freeSolo:!0,getOptionLabel:h=>typeof h=="string"?h:a(h.label),disableClearable:!0,options:Bn,renderInput:h=>e.jsx(nn,{sx:{width:150},...h,variant:"standard"})})}),e.jsx(re,{children:a("application:modals.expireSuffix")})]})]}),(n==null?void 0:n.type)==Te.file&&e.jsxs(lt,{expanded:l==="downloads",onChange:c("downloads"),children:[e.jsx(ct,{"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsxs(ut,{children:[e.jsx(ce,{children:e.jsx(Vc,{})}),e.jsx(q,{primary:a("application:modals.expireAfterDownload")}),e.jsx(rt,{children:e.jsx(Ee,{checked:t.downloads,onChange:u("downloads")})})]})}),e.jsxs(dt,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(re,{children:a("application:modals.expirePrefix")}),e.jsx(Ue,{variant:"standard",style:{marginRight:10,marginLeft:10},children:e.jsx(Yn,{value:t.downloads_val,filterOptions:(h,f)=>{const d=Ps(h,f),{inputValue:p}=f,g=parseInt(p);return p!==""&&As(p)&&parseInt(p)>0&&!d.find(m=>m.value==g)&&d.push({inputValue:p,value:g,label:p}),d},onChange:(h,f)=>{let d=0,p="";typeof f=="string"?(d=parseInt(f),p=f):(d=(f==null?void 0:f.value)??0,p=(f==null?void 0:f.label)??""),r({...t,downloads_val:{value:d,label:p}})},freeSolo:!0,getOptionLabel:h=>typeof h=="string"?h:a("application:modals.downloadLimitOptions",{num:h.label}),disableClearable:!0,options:Un,renderInput:h=>e.jsx(nn,{sx:{width:200},...h,variant:"standard"})})}),e.jsx(re,{children:a("application:modals.expireSuffix")})]})]})]})},Is={expires_val:Bn[2],downloads_val:Un[0]},qc=(t,n)=>{const s={is_private:t.is_private,password:t.password,use_custom_password:!0,share_view:t.share_view,downloads:t.remain_downloads!=null&&t.remain_downloads>0,expires_val:Bn[2],downloads_val:Un[0]};if(s.downloads&&(s.downloads_val={value:t.remain_downloads??0,label:(t.remain_downloads??0).toString()}),t.expires!=null)if(de(t.expires).isBefore(de()))s.expires=!1;else{s.expires=!0;const l=de(t.expires).diff(de(),"second");s.expires_val={value:l,label:Math.round(l/60)+" "+n("application:modals.minutes")}}return s},Gc=()=>{const{t}=P(),n=L();X();const[s,r]=i.useState(!1),[a,l]=i.useState(Is),[o,c]=i.useState(""),[u,h]=i.useState(!0),f=i.useMemo(()=>{const k=o.lastIndexOf("/s/"),w=o.substring(k+3).split("/"),D=w.length==2?w[1]:void 0;return{shareLink:D?o.substring(0,o.lastIndexOf("/")):o,password:D}},[o]),d=C(k=>k.globalState.shareLinkDialogOpen),p=C(k=>k.globalState.shareLinkDialogFile),g=C(k=>k.globalState.shareLinkDialogShare);i.useEffect(()=>{d&&(l(g?qc(g,t):Is),c(""))},[d]);const m=i.useCallback(()=>{s||n(xr())},[n,s]),x=i.useCallback(async k=>{if(k&&k.preventDefault(),!!p){if(o){Vt(o);return}r(!0);try{const w=await n(br(ee.main,p,a,g==null?void 0:g.id));c(w)}catch{}finally{r(!1)}}},[n,p,o,g,r,a,c]),j=i.useMemo(()=>u?o:o.substring(0,o.lastIndexOf("/")),[u,o]),v=i.useMemo(()=>{if(!u)return o.substring(o.lastIndexOf("/")+1)},[u,o]);return e.jsx(e.Fragment,{children:e.jsx(oe,{title:t(`application:modals.${g?"edit":"create"}ShareLink`),showActions:!0,loading:s,showCancel:!0,hideOk:!!o,onAccept:x,dialogProps:{open:d??!1,onClose:m,fullWidth:!0,maxWidth:"xs"},cancelText:o?"common:close":void 0,secondaryAction:o?navigator.share&&e.jsx(Q,{title:t("application:modals.sendLink"),children:e.jsx(H,{onClick:()=>vr((p==null?void 0:p.name)??"",j),children:e.jsx(Mi,{})})}):void 0,children:e.jsx(se,{sx:{pb:0},children:e.jsx(qe,{children:e.jsx(bn,{children:e.jsx(vn,{addEndListener:(k,w)=>k.addEventListener("transitionend",w,!1),classNames:"fade",children:e.jsxs(M,{children:[!o&&e.jsx($c,{editing:!!g,onSettingChange:l,setting:a,file:p}),o&&e.jsxs(J,{spacing:1,children:[e.jsx(Ve,{variant:"filled",inputProps:{readonly:!0},label:t("modals.shareLink"),fullWidth:!0,value:j??"",onFocus:k=>k.target.select(),slotProps:{input:{endAdornment:e.jsx(H,{onClick:()=>Vt(j),size:"small",sx:{marginRight:-1},children:e.jsx(sn,{})})}}}),f.password&&e.jsxs(e.Fragment,{children:[e.jsx(ze,{in:!u,children:e.jsx(Ve,{variant:"filled",inputProps:{readonly:!0},label:t("modals.sharePassword"),fullWidth:!0,value:v??"",onFocus:k=>k.target.select(),slotProps:{input:{endAdornment:e.jsx(H,{onClick:()=>Vt(v??""),size:"small",sx:{marginRight:-1},children:e.jsx(sn,{})})}}})}),e.jsx(Q,{enterDelay:100,title:t("application:modals.includePasswordInShareLinkDes"),children:e.jsx(xt,{sx:{mt:"0!important"},control:e.jsx(Ee,{disableRipple:!0,sx:{pl:0},size:"small",checked:u,onChange:()=>{h(!u)}}),label:t("application:modals.includePasswordInShareLink")})})]})]})]})},`${o}`)})})})})})},Xc=()=>{var y;const{t}=P(),n=L(),[s,r]=i.useState(null),[a,l]=i.useState(null),[o,c]=i.useState(void 0),[u,h]=i.useState(!1),f=C(b=>b.globalState.versionControlDialogOpen),d=C(b=>b.globalState.versionControlDialogFile),p=C(b=>b.globalState.versionControlHighlight),g=i.useCallback(()=>{u||n(jr())},[n,u]);i.useEffect(()=>{d&&f&&(d.extended_info?c(d):(c(void 0),n(jn({uri:d.path,extended:!0})).then(b=>c(b))))},[d,f]);const m=i.useMemo(()=>{var b,E;return(E=(b=o==null?void 0:o.extended_info)==null?void 0:b.entities)==null?void 0:E.filter(z=>z.type==yr.version)},[(y=o==null?void 0:o.extended_info)==null?void 0:y.entities]),x=()=>{r(null)},j=(b,E)=>{r(b.currentTarget),l(E)},v=i.useCallback(()=>{!d||!a||(n(Sr(d,a.id)),r(null))},[d,a,n]),k=i.useCallback(()=>{!d||!a||(n(Ys(ee.main,d,a.size,a.id)),r(null))},[d,a,n]),w=i.useCallback(()=>{!d||!a||(h(!0),n(Cr(ee.main,d,a.id)).then(()=>{c(b=>b?{...b,primary_entity:a.id}:void 0)}).finally(()=>{h(!1)}),r(null))},[d,a,h,n]),D=i.useCallback(()=>{!d||!a||(n(Js(t("fileManager.deleteVersionWarning"))).then(()=>{h(!0),n(wr({uri:d.path,version:a.id})).then(()=>{c(b=>{var E;return b?{...b,extended_info:b.extended_info?{...b.extended_info,entities:(E=b.extended_info.entities)==null?void 0:E.filter(z=>z.id!==a.id)}:void 0}:void 0})}).finally(()=>{h(!1)})}),r(null))},[t,d,a,h,n]);return e.jsxs(e.Fragment,{children:[e.jsxs(ye,{anchorEl:s,open:!!s,onClose:x,slotProps:{paper:{sx:{minWidth:150}}},children:[e.jsx(G,{onClick:k,dense:!0,children:e.jsx(q,{children:t("application:fileManager.open")})}),e.jsx(G,{onClick:v,dense:!0,children:e.jsx(q,{children:t("application:fileManager.download")})}),(d==null?void 0:d.owned)&&(a==null?void 0:a.id)!==(o==null?void 0:o.primary_entity)&&e.jsx(G,{onClick:w,dense:!0,children:e.jsx(q,{children:t("application:fileManager.setAsCurrent")})}),(d==null?void 0:d.owned)&&(a==null?void 0:a.id)!==(o==null?void 0:o.primary_entity)&&e.jsx(G,{onClick:D,dense:!0,children:e.jsx(q,{children:t("application:fileManager.delete")})})]}),e.jsx(oe,{title:t("application:fileManager.manageVersions"),loading:u,dialogProps:{open:f??!1,onClose:g,fullWidth:!0,maxWidth:"sm"},children:e.jsx(se,{children:e.jsx(qe,{children:e.jsxs(Mt,{component:Ot,children:[e.jsxs(Et,{sx:{width:"100%"},size:"small",children:[e.jsx(At,{children:e.jsxs(ke,{children:[e.jsx(ne,{children:t("fileManager.actions")}),e.jsx(ne,{children:t("fileManager.createdAt")}),e.jsx(ne,{children:t("fileManager.size")}),e.jsx(ne,{children:t("fileManager.createdBy")}),e.jsx(ne,{children:t("application:fileManager.storagePolicy")})]})}),e.jsxs(Pt,{children:[!o&&e.jsxs(ke,{hover:!0,sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(ne,{component:"th",scope:"row",children:e.jsx(Pe,{variant:"text",width:100})}),e.jsx(ne,{children:e.jsx(Pe,{variant:"text",width:30})})]}),m&&m.map(b=>{var E;return e.jsxs(ke,{selected:b.id===(o==null?void 0:o.primary_entity),sx:{boxShadow:z=>p==b.id?`inset 0 0 0 2px ${z.palette.primary.light}`:"none","&:last-child td, &:last-child th":{border:0}},hover:!0,children:[e.jsx(ne,{component:"th",scope:"row",children:e.jsx(H,{disabled:u,onClick:z=>j(z,b),size:"small",children:e.jsx(ba,{fontSize:"small"})})}),e.jsx(ne,{children:e.jsx(Ks,{variant:"body2",datetime:b.created_at})}),e.jsx(ne,{children:we(b.size)}),e.jsx(Se,{children:e.jsx(kr,{sx:{width:20,height:20},textProps:{variant:"body2"},user:b.created_by??Dr})}),e.jsx(ne,{children:(E=b.storage_policy)==null?void 0:E.name})]})})]})]}),!m&&o&&e.jsx(M,{sx:{p:1,width:"100%",textAlign:"center"},children:e.jsx(re,{variant:"caption",color:"text.secondary",children:t("application:setting.listEmpty")})})]})})})})]})},Zc=()=>{var k,w,D;const{t}=P(),n=L(),[s,r]=i.useState(null),[a,l]=i.useState(null),[o,c]=i.useState(void 0),[u,h]=i.useState(!1),f=C(y=>y.globalState.manageShareDialogOpen),d=C(y=>y.globalState.manageShareDialogFile),p=i.useCallback(()=>{u||n(Tr())},[n,u]);i.useEffect(()=>{d&&f&&(d.extended_info?c(d):(c(void 0),n(jn({uri:d.path,extended:!0})).then(y=>c(y))))},[d,f]);const g=()=>{r(null)},m=(y,b)=>{y.stopPropagation(),r(y.currentTarget),l(b)},x=()=>{n(Ar({open:!0,file:d,share:a??void 0})),r(null)},j=i.useCallback(y=>{window.open(y.url,"_blank")},[]),v=i.useCallback(()=>{!d||!a||(n(Js(t("fileManager.deleteShareWarning"))).then(()=>{h(!0),n(Mr(a.id)).then(()=>{c(y=>{var b;return y?{...y,extended_info:y.extended_info?{...y.extended_info,shares:(b=y.extended_info.shares)==null?void 0:b.filter(E=>E.id!==a.id)}:void 0}:void 0})}).finally(()=>{h(!1)})}),r(null))},[t,d,a,h,n]);return e.jsxs(e.Fragment,{children:[e.jsxs(ye,{anchorEl:s,open:!!s,onClose:g,slotProps:{paper:{sx:{minWidth:150}}},children:[e.jsx(G,{dense:!0,children:e.jsx(q,{onClick:x,children:t(`fileManager.${a!=null&&a.expired?"editAndReactivate":"edit"}`)})}),e.jsx(G,{dense:!0,children:e.jsx(q,{onClick:v,children:t("fileManager.delete")})})]}),e.jsx(oe,{title:t("application:fileManager.manageShares"),loading:u,dialogProps:{open:f??!1,onClose:p,fullWidth:!0,maxWidth:"md"},children:e.jsx(se,{children:e.jsx(qe,{children:e.jsxs(Mt,{component:Ot,children:[e.jsxs(Et,{sx:{width:"100%"},size:"small",children:[e.jsx(At,{children:e.jsxs(ke,{children:[e.jsx(ne,{children:t("fileManager.actions")}),e.jsx(ne,{children:t("fileManager.createdAt")}),e.jsx(ne,{children:t("fileManager.expires")}),e.jsx(ne,{children:t("application:share.statistics")}),e.jsx(ne,{children:t("modals.privateShare")})]})}),e.jsxs(Pt,{children:[!o&&e.jsxs(ke,{hover:!0,sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(ne,{component:"th",scope:"row",children:e.jsx(Pe,{variant:"text",width:100})}),e.jsx(ne,{children:e.jsx(Pe,{variant:"text",width:30})})]}),((k=o==null?void 0:o.extended_info)==null?void 0:k.shares)&&((w=o==null?void 0:o.extended_info)==null?void 0:w.shares.map(y=>e.jsxs(ke,{sx:{"&:last-child td, &:last-child th":{border:0},cursor:"pointer",td:{color:b=>y.expired?b.palette.text.disabled:void 0}},onClick:()=>j(y),hover:!0,children:[e.jsx(ne,{component:"th",scope:"row",children:e.jsx(H,{disabled:u,onClick:b=>m(b,y),size:"small",children:e.jsx(ba,{fontSize:"small"})})}),e.jsx(ne,{children:e.jsx(Ks,{variant:"body2",datetime:y.created_at??""})}),e.jsx(Se,{children:y.expired?t("application:share.expired"):e.jsx(e.Fragment,{children:y.remain_downloads!=null||y.expires?e.jsx(Or,{expires:y.expires,remain_downloads:y.remain_downloads}):t("application:fileManager.permanentValid")})}),e.jsx(Se,{children:e.jsx(Er,{shareInfo:y})}),e.jsx(ne,{children:t(`fileManager.${y.is_private?"yes":"no"}`)})]})))]})]}),o&&!((D=o==null?void 0:o.extended_info)!=null&&D.shares)&&e.jsx(M,{sx:{p:1,width:"100%",textAlign:"center"},children:e.jsx(re,{variant:"caption",color:"text.secondary",children:t("application:setting.listEmpty")})})]})})})})]})},Yc=()=>{const{t}=P(),n=L(),s=C(u=>u.globalState.staleVersionDialogOpen),r=C(u=>u.globalState.staleVersionUri),a=C(u=>u.globalState.staleVersionPromiseId),l=i.useCallback(()=>{var u;n($t()),a&&((u=qt[a])==null||u.reject("cancel"))},[n,a]),o=i.useCallback(u=>{var h;u&&u.preventDefault(),a&&((h=qt[a])==null||h.resolve({overwrite:!0}),n($t()))},[a,name]),c=i.useCallback(async()=>{var u;if(r)try{const h=new ve(r).elements().pop();if(h&&a){const f=await n(Pr(h)),d=new ve(f.uri).join(f.name);(u=qt[a])==null||u.resolve({overwrite:!1,saveAs:d.toString()}),n($t())}}catch{return}},[n,a,r]);return e.jsx(oe,{title:t("application:modals.versionConflict"),showActions:!0,okText:t("application:modals.overwrite"),showCancel:!0,onAccept:o,secondaryAction:e.jsx(Re,{variant:"contained",onClick:c,color:"primary",children:t("modals.saveAs")}),dialogProps:{open:s??!1,onClose:l,fullWidth:!0,maxWidth:"sm"},children:e.jsx(se,{sx:{pb:0},children:e.jsx(J,{spacing:2,children:e.jsxs(Tt,{children:[t("modals.conflictDes1"),e.jsx("ul",{children:e.jsx(Ke,{i18nKey:"modals.conflictDes2",ns:"application",components:[e.jsx("li",{},0),e.jsx("li",{},1)]})})]})})})})},Jc=()=>{const{t}=P(),n=L(),[s,r]=Ir(),a=C(d=>d.globalState.saveAsDialogOpen),l=C(d=>d.globalState.saveAsInitialName),o=C(d=>d.globalState.saveAsPromiseId),[c,u]=i.useState("");i.useEffect(()=>{a&&u(l??"")},[a]);const h=i.useCallback(()=>{var d;n(Jn()),o&&((d=Kn[o])==null||d.reject("cancel"))},[n,o]),f=i.useCallback(d=>{var g;d&&d.preventDefault();const p=s&&s.path?s.path:r;n(Jn()),o&&p&&((g=Kn[o])==null||g.resolve({uri:p,name:c}))},[o,s,c,r]);return e.jsxs(oe,{title:t("application:modals.saveAs"),showActions:!0,secondaryFullWidth:!0,onAccept:f,secondaryAction:e.jsx(M,{sx:{display:"flex",alignItems:"flex-end"},children:e.jsx(Ve,{variant:"filled",autoFocus:!0,margin:"dense",onChange:d=>u(d.target.value),label:t("modals.fileName"),type:"text",value:c,fullWidth:!0,required:!0})}),denseAction:!0,dialogProps:{open:a??!1,onClose:h,fullWidth:!0,maxWidth:"lg",disableRestoreFocus:!0,PaperProps:{sx:{height:"100%"}}},children:[e.jsx(se,{sx:{display:"flex"},children:e.jsx(_r,{disableSharedWithMe:!0,disableTrash:!0})}),e.jsx(It,{})]})},Kc=ge(e.jsx("path",{d:"M4.5 5.75c0-.69.56-1.25 1.25-1.25h2a.75.75 0 0 0 0-1.5h-2A2.75 2.75 0 0 0 3 5.75v2a.75.75 0 0 0 1.5 0zm0 12.5c0 .69.56 1.25 1.25 1.25h2a.75.75 0 0 1 0 1.5h-2A2.75 2.75 0 0 1 3 18.25v-2a.75.75 0 0 1 1.5 0zM18.25 4.5c.69 0 1.25.56 1.25 1.25v2a.75.75 0 0 0 1.5 0v-2A2.75 2.75 0 0 0 18.25 3h-2a.75.75 0 0 0 0 1.5zm1.25 13.75c0 .69-.56 1.25-1.25 1.25h-2a.75.75 0 0 0 0 1.5h2A2.75 2.75 0 0 0 21 18.25v-2a.75.75 0 0 0-1.5 0z"}),"FullScreenMaximize"),Qc=ge(e.jsx("path",{d:"M8.5 3.75a.75.75 0 0 0-1.5 0v2.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 0 0 1.5h2.5A2.25 2.25 0 0 0 8.5 6.25zm0 16.5a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 0-.75-.75h-2.5a.75.75 0 0 1 0-1.5h2.5a2.25 2.25 0 0 1 2.25 2.25zM16.25 3a.75.75 0 0 0-.75.75v2.5a2.25 2.25 0 0 0 2.25 2.25h2.5a.75.75 0 0 0 0-1.5h-2.5a.75.75 0 0 1-.75-.75v-2.5a.75.75 0 0 0-.75-.75m-.75 17.25a.75.75 0 0 0 1.5 0v-2.5a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 0 0-1.5h-2.5a2.25 2.25 0 0 0-2.25 2.25z"}),"FullScreenMinimize"),fe=({minHeight:t="calc(100vh - 200px)"})=>e.jsx(M,{sx:{width:"100%",height:"100%",border:"none",minHeight:t,display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(Qs,{})}),Me=t=>{var c;const{t:n}=P(),s=X(),r=le(s.breakpoints.down("sm")),[a,l]=i.useState(t.fullScreen||r),o=i.useCallback(()=>{t.dialogProps.onClose&&t.dialogProps.onClose({},"backdropClick")},[t.dialogProps.onClose]);return e.jsxs(ea,{fullScreen:a,...t.dialogProps,onClose:t.loading?void 0:t.dialogProps.onClose,children:[e.jsxs(M,{children:[e.jsxs(Lr,{sx:{py:"8px",px:"14px"},id:"draggable-dialog-title",children:[t.actions&&t.actions,e.jsxs(M,{sx:{display:"flex",alignItems:"center",minWidth:0},children:[e.jsx(ta,{variant:"default",file:t.file,sx:{px:0,py:0,pt:.5,mr:1},fontSize:"small"}),e.jsx(zr,{variant:"subtitle2",children:(c=t.file)==null?void 0:c.name}),t.readOnly&&e.jsx(an,{size:"small",sx:{ml:1},label:n("fileManager.readOnly")})]}),e.jsxs(M,{sx:{display:"flex"},children:[t.fullScreenToggle&&e.jsx(H,{onClick:()=>{t.toggleFullScreen?t.toggleFullScreen():l(u=>!u)},children:a?e.jsx(Qc,{fontSize:"small"}):e.jsx(Kc,{fontSize:"small"})}),e.jsx(H,{disabled:t.loading,onClick:o,children:e.jsx(Qe,{fontSize:"small"})})]})]}),e.jsx(It,{})]}),t.children]})},pt=[{ext:"png",display:"PNG"},{ext:"jpg",display:"JPEG",quality:!0},{ext:"webp",display:"WebP",quality:!0},{ext:"pdf",display:"PDF"},{ext:"svg",display:"SVG"},{ext:"gif",display:"GIF"},{ext:"mp4",display:"MP4"},{ext:"dds",display:"DDS"},{ext:"tiff",display:"TIFF"},{ext:"tga",display:"TGA"},{ext:"bmp",display:"BMP"},{ext:"ico",display:"ICO"},{ext:"dxf",display:"DXF"},{ext:"raw",display:"RAW"},{ext:"emf",display:"EMF"},{ext:"ppm",display:"PPM"}],ed=({onSaveSubmit:t,onClose:n,...s})=>{const{t:r}=P(),[a,l]=i.useState(pt[0]),[o,c]=i.useState(.9),u=d=>{l(pt.find(p=>p.ext===d.target.value)??pt[0])},h=(d,p)=>{c(p)},f=()=>{t(a.ext,a.quality?o:void 0),n&&n({},"backdropClick")};return e.jsx(oe,{title:r("application:modals.saveAsOtherFormat"),showActions:!0,showCancel:!0,onAccept:f,dialogProps:{fullWidth:!0,onClose:n,maxWidth:"xs",...s},children:e.jsx(se,{children:e.jsx(qe,{children:e.jsxs(J,{spacing:2,children:[e.jsxs(Ue,{variant:"filled",sx:{width:"100%"},children:[e.jsx(yn,{children:r("fileManager.format")}),e.jsx(na,{value:a.ext,onChange:u,children:pt.map(d=>e.jsx(vt,{value:d.ext,children:d.display},d.ext))})]}),a.quality&&e.jsx(qs,{title:r("modals.quality"),children:e.jsx(jt,{size:"small",valueLabelDisplay:"auto",min:.01,step:.01,max:1,value:o,onChange:h})})]})})})})},td="https://www.photopea.com",nd="https://www.photopea.com#%7B%22environment%22%3A%7B%22customIO%22%3A%7B%22save%22%3A%22app.echoToOE(%5C%22SAVE%5C%22)%3B%22%2C%22saveAsPSD%22%3A%22app.echoToOE(%5C%22SAVEPSD%5C%22)%3B%22%7D%7D%7D",sd="SAVE",ad="SAVEPSD",rd=function(t,n){var s=new Uint8Array(t.byteLength+n.byteLength);return s.set(new Uint8Array(t),0),s.set(new Uint8Array(n),t.byteLength),s.buffer},Kt={started:1,saveAs:2},od=()=>{const{t}=P(),n=L(),s=C(A=>A.globalState.photopeaViewer),r=Ge(s!=null&&s.file?[s==null?void 0:s.file]:[]),[a,l]=i.useState(!1),[o,c]=i.useState(!1),[u,h]=i.useState(null),[f,d]=i.useState(!1),p=i.useRef(""),g=i.useRef(),[m,x]=i.useState(void 0),j=i.useRef(0),v=i.useRef(0),k=i.useRef(void 0),w=i.useRef(new ArrayBuffer(0)),D=i.useRef(!1);i.useEffect(()=>(window.addEventListener("message",b),()=>{window.removeEventListener("message",b)}),[]),i.useEffect(()=>{!s||!s.open||(D.current=st(r),c(!1),k.current=s,w.current=new ArrayBuffer(0),j.current=0,v.current=0,x(void 0),n(Fe({uris:[pe(s.file)],entity:s.version})).then(A=>{p.current=A.urls[0].url,x(nd)}).catch(()=>{E()}))},[s]);const y=(A,_)=>{var V,T;h(null),!(!g.current||!D.current)&&(l(!0),A||(A=$e(((V=k.current)==null?void 0:V.file.name)??"")??"jpg",A=="psd"&&(A+=":true")),(T=g.current.contentWindow)==null||T.postMessage(`app.activeDocument.saveToOE("${A}")`,"*"),v.current=_?Kt.saveAs:Kt.started)},b=A=>{var _,V,T,S,O;A.origin==td&&(console.log(A),A.data=="done"?(j.current==0?(V=(_=g.current)==null?void 0:_.contentWindow)==null||V.postMessage(`app.open("${p.current}","",false)`,"*"):j.current==2?((O=(T=g.current)==null?void 0:T.contentWindow)==null||O.postMessage(`app.activeDocument.name="${((S=k.current)==null?void 0:S.file.name.replace(/"/g,'\\"'))??""}"`,"*"),c(!0)):v.current>0&&k.current&&(n(Fr(w.current,k.current.file,k.current.version,v.current==Kt.saveAs)),l(!1)),j.current++):A.data==sd?y():A.data==ad?y("psd:true",!0):A.data instanceof ArrayBuffer&&v.current&&(w.current=rd(w.current,A.data)))},E=i.useCallback(()=>{n(Rr())},[n]);i.useCallback(A=>g.current=A.currentTarget,[]);const z=i.useCallback(A=>{h(A.currentTarget)},[n]),K=()=>{d(!0),h(null)},U=(A,_)=>{_&&(A+=`:${_}`),y(A,!0)};return e.jsxs(e.Fragment,{children:[e.jsx(ed,{onSaveSubmit:U,open:f,onClose:()=>d(!1)}),e.jsxs(Me,{file:s==null?void 0:s.file,loading:a,readOnly:!D.current,actions:D.current?e.jsxs(Sn,{disabled:a||!o,disableElevation:!0,variant:"contained",children:[e.jsx(Re,{onClick:()=>y(),variant:"contained",children:t("fileManager.save")}),e.jsx(Re,{size:"small",onClick:z,children:e.jsx(Cn,{sx:{fontSize:"12px!important"}})})]}):void 0,fullScreenToggle:!0,dialogProps:{open:!!(s&&s.open),onClose:E,fullWidth:!0,maxWidth:"lg"},children:[e.jsxs(ye,{anchorEl:u,open:!!u,onClose:()=>h(null),slotProps:{paper:{sx:{minWidth:150}}},children:[e.jsx(G,{dense:!0,onClick:()=>y(void 0,!0),children:e.jsx(q,{children:t("modals.saveAs")})}),e.jsx(G,{onClick:K,dense:!0,children:e.jsx(q,{children:t("modals.saveAsOtherFormat")})})]}),!m&&e.jsx(fe,{}),m&&e.jsx(M,{ref:g,sx:{width:"100%",height:"100%",border:"none",minHeight:"calc(100vh - 200px)"},component:"iframe",title:"ms",src:m,allowFullScreen:!0})]})]})},id=({replacedSrc:t,viewerState:n,onSubmit:s})=>{const r=i.useRef(null);return i.useEffect(()=>{var a;(a=r.current)==null||a.submit(),s()},[n]),e.jsxs("form",{ref:r,id:"office_form",name:"office_form",target:"office_frame",action:t,method:"post",children:[e.jsx("input",{name:"access_token",value:n.session.access_token,type:"hidden"}),e.jsx("input",{name:"access_token_ttl",value:n.session.expires,type:"hidden"})]})},ld=()=>{const{t}=P(),n=L(),s=X(),r=C(v=>v.globalState.wopiViewer),a=Ge(r!=null&&r.file?[r==null?void 0:r.file]:[]),l=st(a),[o,c]=i.useState(!1),[u,h]=i.useState(!1),[f,d]=i.useState(null);i.useRef(null);const p=i.useRef(!1),g=i.useMemo(()=>{var v;return r!=null&&r.src?r.src.replace("lng",((v=wn.resolvedLanguage)==null?void 0:v.toLowerCase())??"").replace("darkmode",s.palette.mode==="dark"?"2":"1"):""},[r==null?void 0:r.src,s]),m=v=>{console.log("Received PostMessage from "+v.origin,v.data);let k;try{k=JSON.parse(v.data)}catch{return}r!=null&&r.file&&(k.MessageId==="UI_Sharing"||k.MessageId==="UI_Share"?n(sa(ee.main,r==null?void 0:r.file)):k.MessageId=="UI_FileVersions"&&n(Wr({open:!0,file:r.file})))};i.useEffect(()=>{if(!r||!r.open){p.current=!1;return}return window.addEventListener("message",m,!1),()=>{window.removeEventListener("message",m,!1)}},[r==null?void 0:r.open]);const x=i.useCallback(()=>{n(Nr())},[n]);i.useCallback(v=>{d(v.currentTarget)},[n]);const j=i.useCallback(()=>{p.current&&h(!0)},[]);return e.jsx(e.Fragment,{children:e.jsxs(Me,{file:r==null?void 0:r.file,loading:o,readOnly:!l,fullScreenToggle:!0,dialogProps:{open:!!(r&&r.open),onClose:x,fullWidth:!0,maxWidth:"lg"},children:[e.jsx(ye,{anchorEl:f,open:!!f,onClose:()=>d(null),slotProps:{paper:{sx:{minWidth:150}}},children:e.jsx(G,{dense:!0,children:e.jsx(q,{children:t("modals.saveAs")})})}),r&&e.jsx(id,{onSubmit:()=>{p.current=!0},viewerState:r,replacedSrc:g}),!u&&e.jsx(fe,{}),e.jsx(M,{onLoad:j,component:"iframe",id:"office_frame",name:"office_frame",sandbox:"allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation allow-popups-to-escape-sandbox allow-downloads allow-modals",allowFullScreen:!0,sx:{width:"100%",height:u?"100%":0,border:"none",minHeight:u?"calc(100vh - 200px)":0}})]})})},cd=i.lazy(()=>zt(()=>import("./MonacoEditor-BbzhZksg.js"),__vite__mapDeps([0,1,2,3,4,5]))),Ra={md:"markdown",json:"json",php:"php",py:"python",bat:"bat",cpp:"cpp",c:"cpp",h:"cpp",cs:"csharp",css:"css",dockerfile:"dockerfile",go:"go",html:"html",ini:"ini",java:"java",js:"javascript",jsx:"javascript",less:"less",lua:"lua",sh:"shell",sql:"sql",xml:"xml",yaml:"yaml"},dd=["utf-8","ibm866","iso-8859-2","iso-8859-3","iso-8859-4","iso-8859-5","iso-8859-6","iso-8859-7","iso-8859-8","iso-8859-8i","iso-8859-10","iso-8859-13","iso-8859-14","iso-8859-15","iso-8859-16","koi8-r","koi8-u","macintosh","windows-874","windows-1250","windows-1251","windows-1252","windows-1253","windows-1254","windows-1255","windows-1256","windows-1257","windows-1258","x-mac-cyrillic","gbk","gb18030","hz-gb-2312","big5","euc-jp","iso-2022-jp","shift-jis","euc-kr","iso-2022-kr","utf-16be","utf-16le"],ud=Array.from(new Set(Object.values(Ra))).sort(),pd=()=>{const{t}=P(),n=L(),s=X(),r=C(T=>T.globalState.codeViewer),a=Ge(r!=null&&r.file?[r==null?void 0:r.file]:[]),l=st(a),[o,c]=i.useState(!1),[u,h]=i.useState(""),[f,d]=i.useState(!1),[p,g]=i.useState(!0),[m,x]=i.useState(null),[j,v]=i.useState(null),[k,w]=i.useState(null),[D,y]=i.useState("off"),b=i.useRef(()=>{}),E=i.useCallback(T=>{!r||!r.open||(d(!1),v(null),n(kn(r.file,r.version)).then(S=>{h(new TextDecoder(T).decode(S)),d(!0)}).catch(()=>{z()}))},[r]);i.useEffect(()=>{!r||!r.open||(w(null),g(!0),w(Ra[$e(r.file.name)??""]??""),E())},[r==null?void 0:r.open]);const z=i.useCallback(()=>{n(Hr())},[n]),K=i.useCallback(T=>{x(T.currentTarget)},[n]),U=i.useCallback(T=>{v(T.currentTarget)},[n]),A=i.useCallback(()=>{v(null),y(T=>T=="off"?"on":"off")},[]),_=i.useCallback(T=>{r!=null&&r.file&&(c(!0),n(Br(u,r.file,r.version,T)).then(()=>{g(!0)}).finally(()=>{c(!1)}))},[u,r]),V=i.useCallback(T=>{h(T),g(!1)},[]);return i.useEffect(()=>{b.current=()=>{!p&&l&&_(!1)}},[p,l,_]),Ur(["Control+s","Meta+s"],()=>{b.current()},{preventDefault:!0}),e.jsxs(Me,{file:r==null?void 0:r.file,loading:o,readOnly:!l,actions:e.jsxs(M,{sx:{display:"flex",gap:1},children:[l&&e.jsxs(Sn,{disabled:o||!f||p,disableElevation:!0,variant:"contained",children:[e.jsx(gn,{loading:o,variant:"contained",onClick:()=>_(!1),children:e.jsx("span",{children:t("fileManager.save")})}),e.jsx(Re,{size:"small",onClick:K,children:e.jsx(Cn,{sx:{fontSize:"12px!important"}})})]}),e.jsx(H,{onClick:U,children:e.jsx(Dn,{fontSize:"small"})})]}),fullScreenToggle:!0,dialogProps:{open:!!(r&&r.open),onClose:z,fullWidth:!0,maxWidth:"lg"},children:[e.jsx(ye,{anchorEl:m,open:!!m,onClose:()=>x(null),slotProps:{paper:{sx:{minWidth:150}}},children:e.jsx(G,{onClick:()=>_(!0),dense:!0,children:e.jsx(q,{children:t("modals.saveAs")})})}),e.jsxs(ye,{anchorEl:j,open:!!j,onClose:()=>v(null),slotProps:{paper:{sx:{minWidth:200}}},children:[e.jsx(et,{popupId:"lng",title:t("application:fileManager.charset"),children:dd.map(T=>e.jsx(G,{onClick:()=>E(T),children:e.jsx(q,{children:T})},T))}),e.jsx(et,{popupId:"lng",title:t("application:fileManager.textType"),children:ud.map(T=>e.jsxs(G,{onClick:()=>w(T),children:[e.jsx(q,{children:T}),T==k&&e.jsx(ce,{children:e.jsx(De,{})})]},T))}),e.jsx(_t,{}),e.jsxs(G,{onClick:A,dense:!0,children:[e.jsx(q,{children:t("fileManager.wordWrap")}),D==="on"&&e.jsx(ce,{sx:{minWidth:"0!important"},children:e.jsx(De,{})})]})]}),!f&&e.jsx(fe,{}),f&&e.jsx(i.Suspense,{fallback:e.jsx(fe,{}),children:e.jsx(M,{sx:{width:"100%",height:"100%",minHeight:"calc(100vh - 200px)"},children:e.jsx(cd,{onSave:b,theme:s.palette.mode==="dark"?"vs-dark":"vs",options:{readOnly:!l,wordWrap:D,automaticLayout:!0},value:u,language:k??"",onChange:T=>V(T)})})})]})},hd="https://embed.diagrams.net",fd=(t,n,s,r)=>{const a=$e(n.name),l=new URLSearchParams({embed:"1",embedRT:"1",configure:"1",libraries:"1",spin:"1",proto:"json",keepmodified:"1",p:"nxtcld",lang:wn.t("fileManager.drawioLng"),dark:r?"1":"0"});return a=="dwb"&&l.set("ui","sketch"),s&&l.set("chrome","0"),(t??hd)+"?"+l.toString()},gd=async(t,n,s,r,a,l)=>{switch(n.funtionName){case"getCurrentUser":const o=$.currentUser();Xe(t,n,[o?{displayName:o==null?void 0:o.user.nickname,uid:o==null?void 0:o.user.id}:null]);break;case"saveFile":try{const c=await s(aa(n.functionArgs[2],r.file,!1));c&&Xe(t,n,[{etag:c.primary_entity,size:c.size}])}catch(c){Xe(t,n,null,`${c}`)}break;case"getFileInfo":try{const c=await s(jn({uri:r.file.path}));c&&Xe(t,n,[{id:c.id,size:c.size,writeable:a,name:c.name,etag:c.primary_entity,versionEnabled:!0,ver:2,instanceId:l}])}catch(c){Xe(t,n,null,`${c}`)}break}},Xe=(t,n,s,r)=>{var a={action:"remoteInvokeResponse",msgMarkers:n.msgMarkers};r?a.error={errResp:r}:s!=null&&(a.resp=s),console.log("Send remote invoke response PostMessage",a),t.postMessage(JSON.stringify(a),"*")},md=()=>{const{t}=P(),n=L(),s=X(),r=C(w=>w.globalState.drawIOViewer),a=C(w=>w.siteConfig.basic.config.instance_id),l=Ge(r!=null&&r.file?[r==null?void 0:r.file]:[]),o=i.useRef(!1),[c,u]=i.useState(!1),[h,f]=i.useState(""),[d,p]=i.useState(!1),g=i.useRef(),[m,x]=i.useState(null);i.useEffect(()=>{if(!r)return;if(!r.open){f("");return}p(!1),o.current=st(l)&&!(r!=null&&r.version),g.current=void 0;const w=fd(r.host,r.file,!o.current,s.palette.mode=="dark");return f(w),window.addEventListener("message",j,!1),()=>{window.removeEventListener("message",j,!1)}},[r==null?void 0:r.open]);const j=async w=>{var y,b,E,z,K,U,A,_,V,T;console.log("Received PostMessage from "+w.origin,w.data);let D;try{D=JSON.parse(w.data)}catch{return}if(r!=null&&r.file)switch(D.event){case"exit":v();break;case"configure":(b=(y=g.current)==null?void 0:y.contentWindow)==null||b.postMessage(JSON.stringify({action:"configure",config:{}}),"*");break;case"remoteInvoke":(E=g.current)!=null&&E.contentWindow&&gd((z=g.current)==null?void 0:z.contentWindow,D,n,r,o.current,a);break;case"save":try{n(aa(D.xml,r.file,!1)),(U=(K=g.current)==null?void 0:K.contentWindow)==null||U.postMessage(JSON.stringify({action:"status",message:t("fileManager.saveSuccess",{time:Vr(de())}),modified:!1}),"*")}catch{}break;case"init":try{const S=await n(kn(r.file,r.version)),O=new TextDecoder().decode(S);(_=(A=g.current)==null?void 0:A.contentWindow)==null||_.postMessage(JSON.stringify({action:"load",autosave:o.current,title:r.file.name,xml:O,desc:{xml:O,id:r.file.id,size:S.byteLength,etag:r.file.primary_entity,writeable:o.current,name:r.file.name,versionEnabled:!0,ver:2,instanceId:a??""},disableAutoSave:!o.current}),"*"),o.current&&((T=(V=g.current)==null?void 0:V.contentWindow)==null||T.postMessage(JSON.stringify({action:"remoteInvokeReady"}),"*"))}catch{v()}break}},v=i.useCallback(()=>{n($r())},[n]);i.useCallback(w=>{x(w.currentTarget)},[n]);const k=i.useCallback(w=>{p(!0),g.current=w.currentTarget},[]);return e.jsxs(Me,{file:r==null?void 0:r.file,loading:c,readOnly:!o.current,fullScreenToggle:!0,dialogProps:{open:!!(r&&r.open),onClose:v,fullWidth:!0,maxWidth:"lg"},children:[e.jsx(ye,{anchorEl:m,open:!!m,onClose:()=>x(null),slotProps:{paper:{sx:{minWidth:150}}},children:e.jsx(G,{dense:!0,children:e.jsx(q,{children:t("modals.saveAs")})})}),(!d||!h)&&e.jsx(fe,{}),h&&e.jsx(M,{onLoad:k,src:h,component:"iframe",sx:{width:"100%",height:d?"100%":0,border:"none",minHeight:d?"calc(100vh - 200px)":0,visibility:d?"visible":"hidden"}})]})},xd=i.lazy(()=>zt(()=>import("./Editor-CEPjDq9y.js"),__vite__mapDeps([6,1,2,3,7,8]))),bd=()=>{const{t}=P(),n=L(),s=X(),r=C(A=>A.globalState.markdownViewer),a=Ge(r!=null&&r.file?[r==null?void 0:r.file]:[]),l=st(a),[o,c]=i.useState(!1),[u,h]=i.useState(""),[f,d]=i.useState(""),[p,g]=i.useState(!1),[m,x]=i.useState(!0),[j,v]=i.useState(null),[k,w]=i.useState(null),D=i.useRef(()=>{}),y=i.useCallback(()=>{!r||!r.open||(g(!1),w(null),n(kn(r.file,r.version)).then(A=>{const _=new TextDecoder().decode(A);h(_),d(_),g(!0)}).catch(()=>{b()}))},[r]);i.useEffect(()=>{!r||!r.open||(x(!0),y())},[r==null?void 0:r.open]);const b=i.useCallback(()=>{n(qr())},[n]),E=i.useCallback(A=>{v(A.currentTarget)},[n]),z=i.useCallback(A=>{r!=null&&r.file&&(c(!0),n(Gr(f,r.file,r.version,A)).then(()=>{x(!0)}).finally(()=>{c(!1)}))},[f,r]),K=i.useCallback(A=>{d(A),x(!1)},[]),U=i.useCallback(()=>{!m&&l&&z(!1)},[m,l,z]);return i.useEffect(()=>{D.current=()=>{!m&&l&&z(!1)}},[m,l,z]),e.jsxs(Me,{file:r==null?void 0:r.file,loading:o,readOnly:!l,actions:e.jsx(M,{sx:{display:"flex",gap:1},children:l&&e.jsxs(Sn,{disabled:o||!p||m,disableElevation:!0,variant:"contained",children:[e.jsx(gn,{loading:o,variant:"contained",onClick:()=>z(!1),children:e.jsx("span",{children:t("fileManager.save")})}),e.jsx(Re,{size:"small",onClick:E,children:e.jsx(Cn,{sx:{fontSize:"12px!important"}})})]})}),fullScreenToggle:!0,dialogProps:{open:!!(r&&r.open),onClose:b,fullWidth:!0,maxWidth:"lg"},children:[e.jsx(ye,{anchorEl:j,open:!!j,onClose:()=>v(null),slotProps:{paper:{sx:{minWidth:150}}},children:e.jsx(G,{onClick:()=>z(!0),dense:!0,children:e.jsx(q,{children:t("modals.saveAs")})})}),!p&&e.jsx(fe,{}),p&&e.jsx(i.Suspense,{fallback:e.jsx(fe,{}),children:e.jsx(xd,{value:f,readOnly:!l,darkMode:s.palette.mode==="dark",initialValue:u,onChange:A=>K(A),onSaveShortcut:U})})]})};function vd(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M2 7.25A3.25 3.25 0 0 1 5.25 4h13.5A3.25 3.25 0 0 1 22 7.25v9.5A3.25 3.25 0 0 1 18.75 20H5.25A3.25 3.25 0 0 1 2 16.75zM5.25 5.5A1.75 1.75 0 0 0 3.5 7.25v9.5c0 .966.784 1.75 1.75 1.75h13.5a1.75 1.75 0 0 0 1.75-1.75v-9.5a1.75 1.75 0 0 0-1.75-1.75zM5 13.25a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5a.75.75 0 0 1-.75-.75m10.75-.75a.75.75 0 0 0 0 1.5h2.5a.75.75 0 0 0 0-1.5zM5 16.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 0 1.5h-3.5a.75.75 0 0 1-.75-.75m6.75-.75a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5z"})})}const jd=ge(e.jsx("path",{d:"M20.063 8.445a3.218 3.218 0 0 1-.002 4.551l-7.123 7.112a2.251 2.251 0 0 1-.943.562l-4.293 1.29a1 1 0 0 1-1.24-1.264l1.362-4.228c.11-.34.3-.65.552-.903l7.133-7.121a3.22 3.22 0 0 1 4.554.002m-3.494 1.06l-7.133 7.12a.75.75 0 0 0-.184.301l-1.07 3.323l3.382-1.015a.749.749 0 0 0 .314-.188L19 11.936a1.718 1.718 0 1 0-2.431-2.432M8.15 2.37l.05.105l3.253 8.249l-1.157 1.155L9.556 10H5.443l-.995 2.52a.75.75 0 0 1-.876.454l-.098-.031a.75.75 0 0 1-.452-.876l.03-.098l3.754-9.495a.75.75 0 0 1 1.345-.104m-.648 2.422L6.036 8.5h2.928z"}),"TextEditStyle"),yd=({onSaveSubmit:t,onClose:n,open:s,...r})=>{const{t:a}=P(),l=X(),[o,c]=i.useState({}),u=(f,d)=>{c(p=>({...p,fontSize:d}))};i.useEffect(()=>{s&&c($.getWithFallback(ae.SubtitleStyle))},[s]);const h=()=>{t(o),n&&n({},"backdropClick")};return e.jsx(oe,{title:a("application:fileManager.subtitleStyles"),showActions:!0,showCancel:!0,onAccept:h,dialogProps:{fullWidth:!0,onClose:n,open:s,maxWidth:"sm",...r},children:e.jsx(se,{children:e.jsxs(J,{spacing:2,direction:"row",children:[e.jsxs(M,{children:[e.jsx(re,{variant:"body2",gutterBottom:!0,children:a("fileManager.color")}),e.jsx(Xr,{presetColors:!1,style:{border:"none",boxShadow:"none",padding:0,margin:0,background:l.palette.background.default+"!important"},disableAlpha:!0,color:o.fontColor??"#fff",onChange:f=>{c(d=>({...d,fontColor:f.hex}))}})]}),e.jsxs(M,{sx:{flexGrow:1},children:[e.jsx(re,{variant:"body2",gutterBottom:!0,children:a("fileManager.fontSize")}),e.jsx(jt,{size:"small",valueLabelDisplay:"auto",min:5,step:1,max:50,value:o.fontSize??20,onChange:u}),e.jsx(M,{children:e.jsx(re,{sx:{textAlign:"center",textShadow:"#000 1px 0 1px,#000 0 1px 1px,#000 -1px 0 1px,#000 0 -1px 1px,#000 1px 1px 1px,#000 -1px -1px 1px,#000 1px -1px 1px,#000 -1px 1px 1px",fontSize:`${o.fontSize??20}px`,color:o.fontColor??"#fff"},children:a("fileManager.testSubtitleStyle")})})]})]})})})},Sd=i.lazy(()=>zt(()=>import("./Artplayer-BZ-7w0Ox.js"),__vite__mapDeps([9,1,2,3,10,11,12,13]))),Ze="https://cloudreve_masked/",Cd=5*1e3,wd=()=>{var _,V,T;const{t}=P(),n=L(),s=X(),r=le(s.breakpoints.down("sm")),a=C(S=>S.globalState.videoViewer);i.useState(!1);const[l,o]=i.useState(null),[c,u]=i.useState(null),h=i.useRef(void 0),[f,d]=i.useState([]),[p,g]=i.useState(null),[m,x]=i.useState(!1),j=i.useRef(null),v=i.useMemo(()=>$.getWithFallback(ae.SubtitleStyle),[]),k=i.useCallback(async S=>{if(l){if(u(null),!S){g(null),l.subtitle.show=!1;return}g(S);try{const O=await n(Fe({uris:[pe(S)]}));l.subtitle.switch(O.urls[0].url,{type:$e(S.name)??""}),l.subtitle.show=!0}catch(O){console.error(O);return}}},[l]),w=i.useCallback(()=>{if(!(a!=null&&a.file))return;const S=n(Qn());d(S),S.length>0&&S[0].name.startsWith(es(a.file.name)+".")&&k(S[0])},[a==null?void 0:a.file,k]),D=i.useCallback(()=>{if(!a||!a.file||!l)return;const S=!h.current;if($e(a.file.name)==="m3u8"){const I=new ve(pe(a.file)),te=`${Ze}${I.path()}`;l.switchUrl(te),w();return}n(Fe({uris:[pe(a.file)],entity:a.version})).then(I=>{const te=l.currentTime;j.current=I.urls[0].url;let ie=de(I.expires).diff(de(),"millisecond")-Cd;if(ie<0&&(ie=2e3),h.current=setTimeout(D,ie),l.switchUrl(I.urls[0].url).then(()=>{l.currentTime=te}),S){const ue=n(Qn());d(ue),ue.length>0&&ue[0].name.startsWith(es(a.file.name)+".")&&k(ue[0])}}).catch(I=>{console.error(I),b()})},[a==null?void 0:a.file,l,w]),y=i.useMemo(()=>{var O;if(!a||!((O=a.file)!=null&&O.metadata))return;const S={};return Object.keys(a.file.metadata).map(I=>{var te,ie,ue,Oe,me,Ie;if(I.startsWith("stream:chapter_")){const xe=I.split("_")[1],Vn=I.replace(`stream:chapter_${xe}_`,"");switch(S[xe]||(S[xe]={start:0,end:0,title:""}),Vn){case"start_time":S[xe].start=parseFloat(((ie=(te=a.file)==null?void 0:te.metadata)==null?void 0:ie[I])??"0");break;case"end_time":S[xe].end=parseFloat(((Oe=(ue=a.file)==null?void 0:ue.metadata)==null?void 0:Oe[I])??"0");break;case"name":S[xe].title=((Ie=(me=a.file)==null?void 0:me.metadata)==null?void 0:Ie[I])??"";break}}}),Object.values(S).map(I=>({start:I.start,end:I.end,title:I.title}))},[a]);i.useEffect(()=>{l&&(l.on("ready",()=>{l.autoHeight(),l.autoSize()}),l.query(".art-video").addEventListener("leavepictureinpicture",()=>{l.pause()},!1),D())},[l]),i.useEffect(()=>{if(!a||!a.open){h.current&&(clearTimeout(h.current),h.current=void 0);return}o(null),d([]),g(null)},[a==null?void 0:a.open]);const b=i.useCallback(()=>{n(Zr())},[n]),E=i.useCallback(S=>{u(S.currentTarget)},[n]),z=i.useCallback(()=>{x(!0),u(null)},[]),K=i.useCallback(S=>{$.set(ae.SubtitleStyle,S),x(!1),l&&l.subtitle.style({color:S.fontColor??"#fff",fontSize:`${S.fontSize??20}px`})},[l]),U=i.useCallback(async(S,O)=>{let I="";if(O){if(!j.current)return S;const te=new URL(j.current),ie=new URL(S);if(te.origin!=ie.origin)return S;const ue=te.pathname.split("/"),Oe=ie.pathname.split("/");let me=0;for(;me<ue.length&&me<Oe.length&&ue[me]===Oe[me];)me++;const Ie=Oe.slice(me).join("/");if(!(a!=null&&a.file))return S;const xe=new ve(pe(a==null?void 0:a.file));return I=(me==0?new ve(xe.base()):xe.parent()).join(Ie).path(),`${Ze}${I}`}else{if(S.startsWith("http://")||S.startsWith("https://")||!(a!=null&&a.file))return S;const te=new ve(pe(a==null?void 0:a.file));return I=(S.startsWith("/")?new ve(te.base()):te.parent()).join(S).path(),`${Ze}${I}`}},[a==null?void 0:a.file]),A=i.useCallback(async S=>{if(!(a!=null&&a.file)||!S.startsWith(Ze))return S;S=S.replace(Ze,"");const O=new ve(pe(a.file)),te=new ve(O.base()).join(...S.split("/"));try{return(await n(Fe({uris:[te.toString()]}))).urls[0].url}catch(ie){return console.error(ie),S}},[n,a==null?void 0:a.file]);return e.jsxs(Me,{file:a==null?void 0:a.file,actions:e.jsx(M,{sx:{display:"flex",gap:1},children:e.jsx(Q,{title:t("fileManager.subtitles"),children:e.jsx(H,{onClick:E,children:e.jsx(vd,{fontSize:"small"})})})}),fullScreenToggle:!0,toggleFullScreen:()=>l&&(l.fullscreenWeb=!0),dialogProps:{open:!!(a&&a.open),onClose:b,fullWidth:!0,maxWidth:"md"},children:[e.jsx(yd,{onSaveSubmit:K,open:m,onClose:()=>x(!1)}),e.jsxs(ye,{anchorEl:c,open:!!c,onClose:()=>u(null),slotProps:{paper:{sx:{minWidth:150,maxWidth:250}}},children:[e.jsxs(G,{dense:!0,onClick:()=>z(),children:[e.jsxs(ce,{children:[e.jsx(jd,{fontSize:"small"})," "]}),e.jsx(q,{children:t("application:fileManager.subtitleStyles")})]}),e.jsx(_t,{}),f.length==0&&e.jsx(M,{sx:{p:1},children:e.jsx(re,{variant:"caption",color:"text.secondary",children:t("application:fileManager.noSubtitle")})}),f.length>0&&e.jsx(G,{onClick:()=>k(),dense:!0,children:e.jsx("em",{children:e.jsx(q,{primary:t("application:fileManager.disableSubtitle")})})}),f.map(S=>e.jsx(Q,{title:S.name,children:e.jsxs(G,{onClick:()=>k(S),dense:!0,children:[e.jsx(q,{primary:S.name,slotProps:{primary:{sx:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}}}),(p==null?void 0:p.id)==S.id&&e.jsx(ce,{sx:{minWidth:"0!important"},children:e.jsx(De,{})})]})},S.id))]}),e.jsx(i.Suspense,{fallback:e.jsx(fe,{minHeight:"calc(100vh - 350px)"}),children:e.jsx(Sd,{m3u8UrlTransform:U,getEntityUrl:A,sx:{width:"100%",height:"100%",minHeight:"calc(100vh - 350px)"},chapters:y,getInstance:S=>o(S),option:{title:(_=a==null?void 0:a.file)==null?void 0:_.name,theme:s.palette.primary.main,id:(V=a==null?void 0:a.file)==null?void 0:V.path,autoPlayback:!0,subtitleOffset:!0,fastForward:!0,flip:!0,setting:!0,playbackRate:!0,aspectRatio:!0,hotkey:!0,pip:!r,fullscreen:!0,fullscreenWeb:!0,autoHeight:!0,whitelist:["*"],moreVideoAttr:{"webkit-playsinline":!0,playsInline:!0},subtitle:{style:{color:v.fontColor??"#fff",fontSize:`${v.fontSize??20}px`}},plugins:[],lang:t("artPlayerLocaleCode",{ns:"common"})}},(T=a==null?void 0:a.file)==null?void 0:T.path)})]})},kd="/pdfviewer.html",Dd=()=>{const t=L(),n=X(),s=C(u=>u.globalState.pdfViewer),[r,a]=i.useState(!1),[l,o]=i.useState("");i.useEffect(()=>{!s||!s.open||(o(""),t(Fe({uris:[pe(s.file)],entity:s.version})).then(u=>{const h=new URLSearchParams;h.set("file",u.urls[0].url),h.set("lng",wn.language),h.set("darkMode",n.palette.mode=="dark"?"2":"1"),o(`${kd}?${h.toString()}`)}).catch(()=>{c()}))},[s]);const c=i.useCallback(()=>{t(Yr())},[t]);return e.jsx(e.Fragment,{children:e.jsxs(Me,{file:s==null?void 0:s.file,loading:r,fullScreenToggle:!0,dialogProps:{open:!!(s&&s.open),onClose:c,fullWidth:!0,maxWidth:"lg"},children:[!l&&e.jsx(fe,{}),l&&e.jsx(M,{onLoad:()=>a(!1),src:l,sx:{width:"100%",height:r?0:"100%",border:"none",minHeight:r?0:"calc(100vh - 200px)"},component:"iframe"})]})})},Td=()=>{P();const t=L();X();const n=C(l=>l.globalState.customViewer),[s,r]=i.useState(!1);i.useEffect(()=>{!n||!n.open||r(!0)},[n]);const a=i.useCallback(()=>{t(Jr())},[t]);return e.jsx(e.Fragment,{children:e.jsxs(Me,{file:n==null?void 0:n.file,fullScreenToggle:!0,dialogProps:{open:!!(n&&n.open),onClose:a,fullWidth:!0,maxWidth:"lg"},children:[s&&e.jsx(fe,{}),n&&e.jsx(M,{onLoad:()=>r(!1),src:n.url,sx:{width:"100%",height:s?0:"100%",border:"none",minHeight:s?0:"calc(100vh - 200px)"},component:"iframe"})]})})},Md=Tn.lazy(()=>zt(()=>import("./Epub-DthKVwEI.js"),__vite__mapDeps([14,1,2,3,15]))),Od=()=>{P();const t=L();X();const n=C(f=>f.globalState.epubViewer),[s,r]=i.useState(!1),[a,l]=i.useState(""),[o,c]=i.useState(null),u=i.useCallback(f=>{c(f),n!=null&&n.file&&$.set(`${ae.BookLocationPrefix}_${n.file.id}`,f)},[n==null?void 0:n.file]);i.useEffect(()=>{if(!n||!n.open){c(null);return}l(""),t(Fe({uris:[pe(n.file)],entity:n.version})).then(f=>{l(f.urls[0].url);const d=$.get(`${ae.BookLocationPrefix}_${n.file.id}`);d&&c(d)}).catch(()=>{h()})},[n]);const h=i.useCallback(()=>{t(Kr())},[t]);return e.jsx(e.Fragment,{children:e.jsxs(Me,{file:n==null?void 0:n.file,loading:s,dialogProps:{open:!!(n&&n.open),onClose:h,fullWidth:!0,fullScreen:!0,maxWidth:"lg"},children:[!a&&e.jsx(fe,{}),a&&e.jsx(i.Suspense,{fallback:e.jsx(fe,{}),children:e.jsx(M,{sx:{width:"100%",height:"100%",minHeight:"calc(100vh - 200px)"},children:e.jsx(Md,{loadingView:e.jsx(fe,{}),location:o,locationChanged:u,epubInitOptions:{openAs:"epub"},showToc:!0,url:a})})})]})})},Ed=()=>{const{t}=P(),n=L(),[s,r]=i.useState(""),[a,l]=i.useState(""),[o,c]=i.useState(!1),u=i.useRef(null),h=i.useRef(null),f=C(w=>w.globalState.createNewDialogOpen),d=C(w=>w.globalState.createNewPromiseId),p=C(w=>w.globalState.createNewDialogType),g=C(w=>w.globalState.createNewDialogDefault),m=C(w=>w.globalState.createNewDialogFmIndex)??0;i.useEffect(()=>{f&&r(g??"")},[f]);const x=i.useCallback(()=>{var w;n(ts()),d&&((w=ns[d])==null||w.reject("cancel"))},[n,d]),j=i.useCallback(w=>{w&&w.preventDefault(),c(!0),n(Qr(m,s,p==Gt.folder?Te.folder:Te.file)).then(D=>{var y;d&&((y=ns[d])==null||y.resolve(D)),n(ts())}).finally(()=>{c(!1)})},[d,s]),v=i.useCallback(()=>{u.current&&u.current.reportValidity()&&j()},[u,j]);i.useEffect(()=>{if(f){const w=s.lastIndexOf(".");setTimeout(()=>h.current&&h.current.setSelectionRange(0,w>0?w:s.length),200)}},[f,h.current]);const k=i.useCallback(w=>{r(w.target.value),a&&n(Gs({index:0,value:void 0}))},[n,r,a]);return e.jsx(oe,{title:t(p==Gt.folder?"application:fileManager.newFolder":"application:fileManager.newFile"),showActions:!0,loading:o,showCancel:!0,onAccept:v,dialogProps:{open:f??!1,onClose:x,fullWidth:!0,maxWidth:"sm",disableRestoreFocus:!0},children:e.jsx(se,{children:e.jsx(J,{spacing:2,children:e.jsx("form",{ref:u,onSubmit:j,children:e.jsx(Ve,{inputRef:h,variant:"filled",autoFocus:!0,error:!!a,helperText:a,margin:"dense",label:t(p==Gt.folder?"application:modals.folderName":"application:modals.fileName"),type:"text",value:s,onChange:k,fullWidth:!0,required:!0})})})})})},Ad=()=>{const{t}=P(),n=L(),{enqueueSnackbar:s}=Ne(),r=X(),a=le(r.breakpoints.down("sm")),[l,o]=i.useState(!1),[c,u]=i.useState("archive.zip"),[h,f]=i.useState(""),d=C(j=>j.globalState.createArchiveDialogOpen),p=C(j=>j.globalState.createArchiveDialogFiles),g=C(j=>j.fileManager[ee.main].pure_path);i.useEffect(()=>{d&&f(g??"")},[d]);const m=i.useCallback(()=>{n(ss())},[n]),x=i.useCallback(()=>{if(!p)return;o(!0);const j=new ve(h);n(eo({src:p==null?void 0:p.map(v=>pe(v)),dst:j.join(c).toString()})).then(()=>{n(ss()),s({message:t("modals.taskCreated"),variant:"success",action:Mn()})}).finally(()=>{o(!1)})},[p,c,h]);return e.jsx(oe,{title:t("application:fileManager.createArchive"),showActions:!0,loading:l,showCancel:!0,disabled:!c,onAccept:x,dialogProps:{open:d??!1,onClose:m,fullWidth:!0,maxWidth:"sm",disableRestoreFocus:!0},children:e.jsx(se,{sx:{pt:1},children:e.jsxs(J,{spacing:3,children:[e.jsx(ra,{icon:e.jsx(to,{}),variant:"outlined",value:c,onChange:j=>u(j.target.value),label:t("application:modals.zipFileName"),fullWidth:!0}),e.jsx(J,{spacing:3,direction:a?"column":"row",children:e.jsx(On,{onChange:f,path:h,label:t("modals.saveToTitle")})})]})})})},Na=({file:t,label:n})=>e.jsx(no,{variant:"outlined",InputProps:{readOnly:!0,startAdornment:e.jsx(bt,{file:t,clickable:!1})},label:n,fullWidth:!0});function Pd(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M3.385 5.997a6.067 6.067 0 0 1 4.576-.467h.001c1.232.362 1.906 1.11 2.237 1.94c.3.754.3 1.536.3 1.99v5.79a.75.75 0 0 1-1.5 0v-.3a9.34 9.34 0 0 1-.396.222c-.952.505-2.327 1.018-3.757.761c-1.584-.285-2.576-1.595-2.8-2.952c-.229-1.38.316-2.937 1.902-3.697c1.44-.69 2.99-.628 4.122-.427c.342.061.653.136.923.211c-.013-.351-.055-.71-.188-1.042c-.166-.417-.491-.83-1.264-1.056a4.57 4.57 0 0 0-3.431.34a.75.75 0 0 1-.725-1.313m4.423 4.337c-.986-.175-2.175-.194-3.212.303c-.891.427-1.208 1.27-1.07 2.1c.141.854.741 1.568 1.586 1.72c.938.169 1.947-.164 2.788-.61a8.296 8.296 0 0 0 1.098-.702v-2.507a8.41 8.41 0 0 0-1.19-.304m8.677-3.296a.75.75 0 0 1 .476.948c-.09.27-.185.61-.271.94c.948-.088 1.87-.226 2.638-.406a.75.75 0 1 1 .343 1.46c-.973.229-2.152.392-3.336.481c-.11.546-.194 1.045-.257 1.5a5.939 5.939 0 0 1 1.672-.238a.75.75 0 0 1 1.5.027l-.003.222a4.035 4.035 0 0 1 2.504 2.423a3.98 3.98 0 0 1-.154 3.128c-.496 1.025-1.44 1.894-2.827 2.427a.75.75 0 0 1-.538-1.4c1.083-.416 1.708-1.046 2.015-1.68a2.48 2.48 0 0 0 .097-1.954a2.548 2.548 0 0 0-1.278-1.399a7.63 7.63 0 0 1-2.285 4.047c.057.132.114.272.17.424a.75.75 0 1 1-1.423.478a4.67 4.67 0 0 1-1.24.474c-.72.155-1.557.099-2.13-.486c-.865-.886-.818-2.277-.204-3.442c.477-.908 1.323-1.77 2.538-2.413c.06-.614.157-1.298.3-2.064c-.654.014-1.28.002-1.844-.037a.75.75 0 0 1 .102-1.496c.622.042 1.331.05 2.067.024c.116-.472.272-1.067.42-1.512a.75.75 0 0 1 .948-.476m-2.058 7.372c-.546.413-.92.87-1.146 1.3c-.444.843-.289 1.45-.05 1.695c.055.057.258.172.742.068c.345-.074.672-.202.977-.373a7.84 7.84 0 0 1-.386-1.373a9.112 9.112 0 0 1-.137-1.317m1.755 1.66a6.647 6.647 0 0 0 1.413-2.848a4.725 4.725 0 0 0-1.328.25a7.56 7.56 0 0 0-.34.12a8.618 8.618 0 0 0 .113 1.867c.041.227.089.428.142.611"})})}const Id=["gb18030","ibm866","iso8859_2","iso8859_3","iso8859_4","iso8859_5","iso8859_6","iso8859_7","iso8859_8","iso8859_8I","iso8859_10","iso8859_13","iso8859_14","iso8859_15","iso8859_16","koi8r","koi8u","macintosh","windows874","windows1250","windows1251","windows1252","windows1253","windows1254","windows1255","windows1256","windows1257","windows1258","macintoshcyrillic","gbk","big5","eucjp","iso2022jp","shiftjis","euckr","utf16be","utf16le"],Qt=" ",_d=()=>{const{t}=P(),n=L(),{enqueueSnackbar:s}=Ne(),r=X(),a=le(r.breakpoints.down("sm")),[l,o]=i.useState(!1),[c,u]=i.useState(""),[h,f]=i.useState(Qt),d=C(v=>v.globalState.extractArchiveDialogOpen),p=C(v=>v.globalState.extractArchiveDialogFile),g=C(v=>v.fileManager[ee.main].pure_path),m=i.useMemo(()=>$e((p==null?void 0:p.name)??"")==="zip",[p==null?void 0:p.name]);i.useEffect(()=>{d&&u(g??"")},[d]);const x=i.useCallback(()=>{n(as())},[n]),j=i.useCallback(()=>{p&&(o(!0),n(so({src:[pe(p)],dst:c,encoding:m&&h!=Qt?h:void 0})).then(()=>{n(as()),s({message:t("modals.taskCreated"),variant:"success",action:Mn()})}).finally(()=>{o(!1)}))},[p,h,c,m]);return e.jsx(oe,{title:t("application:fileManager.extractArchive"),showActions:!0,loading:l,showCancel:!0,onAccept:j,dialogProps:{open:d??!1,onClose:x,fullWidth:!0,maxWidth:"sm",disableRestoreFocus:!0},children:e.jsx(se,{sx:{pt:1},children:e.jsxs(J,{spacing:3,children:[e.jsxs(J,{spacing:3,direction:a?"column":"row",children:[p&&e.jsx(Na,{file:p,label:t("modals.archiveFile")}),m&&e.jsxs(Ue,{variant:"outlined",fullWidth:!0,children:[e.jsx(yn,{children:t("modals.selectEncoding")}),e.jsxs(na,{variant:"outlined",startAdornment:!a&&e.jsx(ao,{position:"start",children:e.jsx(Pd,{})}),label:t("modals.selectEncoding"),value:h,onChange:v=>f(v.target.value),children:[e.jsx(vt,{value:Qt,children:e.jsx("em",{children:t("modals.defaultEncoding")})}),Id.map(v=>e.jsx(vt,{value:v,children:v},v))]})]})]}),e.jsx(J,{spacing:3,direction:a?"column":"row",children:e.jsx(On,{onChange:u,path:c,variant:"extractTo",label:t("modals.decompressTo")})})]})})})};function Ld(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M9 7a1 1 0 0 1 .117 1.993L9 9H7a3 3 0 0 0-.176 5.995L7 15h2a1 1 0 0 1 .117 1.993L9 17H7a5 5 0 0 1-.217-9.995L7 7h2Zm8 0a5 5 0 0 1 .217 9.995L17 17h-2a1 1 0 0 1-.117-1.993L15 15h2a3 3 0 0 0 .176-5.995L17 9h-2a1 1 0 0 1-.117-1.993L15 7h2ZM7 11h10a1 1 0 0 1 .117 1.993L17 13H7a1 1 0 0 1-.117-1.993L7 11h10H7Z"})})}const zd=()=>{const{t}=P(),n=L(),{enqueueSnackbar:s}=Ne(),r=X(),a=le(r.breakpoints.down("sm")),[l,o]=i.useState(!1),[c,u]=i.useState(""),[h,f]=i.useState(""),d=C(j=>j.globalState.remoteDownloadDialogOpen),p=C(j=>j.globalState.remoteDownloadDialogFile),g=C(j=>j.fileManager[ee.main].pure_path);i.useEffect(()=>{if(d){const j=new ve(g??yt),v=j.fs();u(v==rs.shared_with_me||v==rs.trash?yt:j.toString()),f("")}},[d]);const m=i.useCallback(()=>{n(os())},[n]),x=i.useCallback(()=>{!p&&!h||(o(!0),n(ro({src_file:p?pe(p):void 0,dst:c,src:h?h.split(`
`):void 0})).then(()=>{n(os()),s({message:t("modals.taskCreated"),variant:"success",action:Mn("/downloads")})}).finally(()=>{o(!1)}))},[p,h,c]);return e.jsx(oe,{title:t("application:modals.newRemoteDownloadTitle"),showActions:!0,loading:l,disabled:!p&&!h,showCancel:!0,onAccept:x,dialogProps:{open:d??!1,onClose:m,fullWidth:!0,maxWidth:"sm",disableRestoreFocus:!0},children:e.jsx(se,{sx:{pt:1},children:e.jsxs(J,{spacing:3,children:[e.jsxs(J,{spacing:3,direction:a?"column":"row",children:[p&&e.jsx(Na,{file:p,label:t("modals.remoteDownloadURL")}),!p&&e.jsx(ra,{icon:e.jsx(Ld,{}),variant:"outlined",value:h,multiline:!0,onChange:j=>f(j.target.value),placeholder:t("modals.remoteDownloadURLDescription"),label:t("application:modals.remoteDownloadURL"),fullWidth:!0})]}),e.jsx(J,{spacing:3,direction:a?"column":"row",children:e.jsx(On,{onChange:u,path:c,variant:"downloadTo",label:t("modals.remoteDownloadDst")})})]})})})},Fd=[{name:"application:modals.fileName",icon:e.jsx(oo,{fontSize:"small"}),condition:{type:Z.name,case_folding:!0}},{name:"application:navbar.fileType",icon:e.jsx(oa,{fontSize:"small"}),condition:{type:Z.type,file_type:Te.file}},{name:"application:fileManager.tags",icon:e.jsx(io,{fontSize:"small"}),condition:{type:Z.tag}},{name:"application:fileManager.metadata",icon:e.jsx(lo,{fontSize:"small"}),condition:{type:Z.metadata}},{name:"application:navbar.fileSize",icon:e.jsx(co,{fontSize:"small"}),condition:{type:Z.size,size_lte:0,size_gte:0}},{name:"application:fileManager.createDate",icon:e.jsx(is,{fontSize:"small"}),condition:{type:Z.created,created_gte:de().subtract(7,"d").unix(),created_lte:de().unix()}},{name:"application:fileManager.updatedDate",icon:e.jsx(is,{fontSize:"small"}),condition:{type:Z.modified,updated_gte:de().subtract(7,"d").unix(),updated_lte:de().unix()}}],Rd=[{name:"application:fileManager.title",condition:{type:Z.metadata,metadata_key_readonly:!0,metadata_key:R.music_title,id:R.music_title}},{name:"application:fileManager.artist",condition:{type:Z.metadata,metadata_key_readonly:!0,metadata_key:R.music_artist,id:R.music_artist}},{name:"application:fileManager.album",condition:{type:Z.metadata,metadata_key_readonly:!0,metadata_key:R.music_album,id:R.music_album}},{name:"application:fileManager.cameraMake",condition:{type:Z.metadata,metadata_key_readonly:!0,metadata_key:R.camera_make,id:R.camera_make}},{name:"application:fileManager.cameraModel",condition:{type:Z.metadata,metadata_key_readonly:!0,metadata_key:R.camera_model,id:R.camera_model}},{name:"application:fileManager.lensMake",condition:{type:Z.metadata,metadata_key_readonly:!0,metadata_key:R.lens_make,id:R.lens_make}},{name:"application:fileManager.lensModel",condition:{type:Z.metadata,metadata_key_readonly:!0,metadata_key:R.lens_model,id:R.lens_model}}],Nd=t=>{const{t:n}=P(),s=En({variant:"popover",popupId:"conditions"}),{onClose:r,...a}=ia(s),l=o=>{t.onConditionAdd({...o,id:o.type==Z.metadata&&!o.id?Math.random().toString():o.id}),r()};return e.jsxs(e.Fragment,{children:[e.jsx(la,{...An(s),startIcon:e.jsx(tt,{}),sx:{px:"15px"},children:n("navbar.addCondition")}),e.jsxs(ye,{onClose:r,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"},...a,children:[Fd.map((o,c)=>e.jsxs(G,{dense:!0,onClick:()=>l(o.condition),children:[e.jsx(ce,{children:o.icon}),n(o.name)]},c)),e.jsx(et,{icon:e.jsx(uo,{fontSize:"small"}),popupId:"mediaInfo",title:n("application:fileManager.mediaInfo"),children:Rd.map((o,c)=>e.jsx(G,{dense:!0,onClick:()=>l(o.condition),children:e.jsx(q,{slotProps:{primary:{variant:"body2"}},children:n(o.name)})},c))})]})]})},Wd=(t,n)=>{const s=[{type:Z.base,base_uri:n}];t.name&&s.push({type:Z.name,names:t.name,name_op_or:t.name_op_or,case_folding:t.case_folding}),t.type!=null&&s.push({type:Z.type,file_type:t.type}),(t.size_gte!=null||t.size_lte!=null)&&s.push({type:Z.size,size_gte:t.size_gte,size_lte:t.size_lte}),(t.created_at_gte!=null||t.created_at_lte!=null)&&s.push({type:Z.created,created_gte:t.created_at_gte,created_lte:t.created_at_lte}),(t.updated_at_gte!=null||t.updated_at_lte!=null)&&s.push({type:Z.modified,updated_gte:t.updated_at_gte,updated_lte:t.updated_at_lte});const r=[];return t.metadata&&Object.entries(t.metadata).forEach(([a,l])=>{a.startsWith(R.tag_prefix)?r.push(a.slice(R.tag_prefix.length)):s.push({type:Z.metadata,metadata_key:a,metadata_value:l})}),r.length>0&&s.push({type:Z.tag,tags:r}),s},Hd=()=>{const{t}=P(),n=L(),{enqueueSnackbar:s}=Ne(),[r,a]=i.useState([]),l=C(m=>m.globalState.advanceSearchOpen),o=C(m=>m.globalState.advanceSearchBasePath),c=C(m=>m.globalState.advanceSearchInitialNameCondition),u=C(m=>m.fileManager[ee.main].search_params),h=C(m=>m.fileManager[ee.main].pure_path),f=i.useCallback(()=>{n(po())},[n]);i.useEffect(()=>{if(l){if(c&&o){a([{type:Z.base,base_uri:o},{type:Z.name,names:c,case_folding:!0}]);return}if(u){const m=Wd(u,h??yt);m.length>0&&a(m)}}},[l]);const d=m=>{a(r.filter(x=>x!==m))},p=m=>{if(r.find(x=>x.type===m.type&&x.id===m.id)){s(t("application:navbar.conditionDuplicate"),{variant:"warning",action:ca});return}a([...r,m])},g=i.useCallback(()=>{n(ho(ee.main,r))},[n,r]);return e.jsx(oe,{title:t("application:navbar.advancedSearch"),showActions:!0,onAccept:g,showCancel:!0,secondaryAction:e.jsx(Nd,{onConditionAdd:p}),dialogProps:{open:l??!1,onClose:f,fullWidth:!0,maxWidth:"xs"},children:e.jsx(se,{children:e.jsx(fo,{children:r.map((m,x)=>e.jsx(ze,{children:e.jsx(go,{index:x,onRemove:r.length>2&&m.type!=Z.base?d:void 0,condition:m,onChange:j=>{const v=[...r];v[x]=j,a(v)}})},`${m.type} ${m.id}`))})})})};function _s(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M19.79 13.267a.75.75 0 0 0-1.086-1.034l-5.954 6.251V3.75a.75.75 0 1 0-1.5 0v14.734l-5.955-6.251a.75.75 0 1 0-1.086 1.034l7.067 7.42c.16.168.366.268.58.3a.753.753 0 0 0 .29-.001a.995.995 0 0 0 .578-.3z"})})}const Bd=[Y.name,Y.size,Y.date_modified,Y.date_created,Y.parent],Ud=[Y.recycle_restore_parent,Y.recycle_expire],Vd=[Y.aperture,Y.exposure,Y.iso,Y.focal_length,Y.exposure_bias,Y.flash,null,Y.camera_make,Y.camera_model,Y.lens_make,Y.lens_model,null,Y.software,Y.taken_at,Y.image_size,null,Y.title,Y.artist,Y.album,Y.duration],$d=t=>{const{t:n}=P(),s=En({variant:"popover",popupId:"columns"}),{onClose:r,...a}=ia(s),l=(o,c)=>{t.onColumnAdded({type:o,props:c}),r()};return e.jsxs(e.Fragment,{children:[e.jsx(la,{...An(s),startIcon:e.jsx(tt,{}),sx:{px:"15px"},children:n("fileManager.addColumn")}),e.jsxs(ye,{onClose:r,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"left"},...a,children:[Bd.map((o,c)=>e.jsx(G,{dense:!0,onClick:()=>l(o),children:n(ht({type:o}).title)},c)),e.jsx(et,{popupId:"mediaInfo",title:n("application:navbar.trash"),children:Ud.map((o,c)=>e.jsx(G,{dense:!0,onClick:()=>l(o),children:n(ht({type:o}).title)},c))}),e.jsx(et,{popupId:"mediaInfo",title:n("application:fileManager.mediaInfo"),children:Vd.map((o,c)=>o?e.jsx(G,{dense:!0,onClick:()=>l(o),children:n(ht({type:o}).title)},c):e.jsx(_t,{}))})]})]})},qd=()=>{const{t}=P(),n=L(),{enqueueSnackbar:s}=Ne(),[r,a]=i.useState([]),l=C(f=>f.globalState.listViewColumnSettingDialogOpen),o=C(f=>f.fileManager[ee.main].listViewColumns);i.useEffect(()=>{l&&a(o??[])},[l]);const c=i.useCallback(()=>{n(ls(!1))},[n]),u=i.useCallback(()=>{r.length>0&&n(mo(ee.main,r)),n(ls(!1))},[n,r]),h=i.useCallback(f=>{var p,g;const d=r.find(m=>m.type===f.type);!d||((p=d.props)==null?void 0:p.metadata_key)!=((g=f.props)==null?void 0:g.metadata_key)?a(m=>[...m,f]):s(t("application:fileManager.columnExisted"),{variant:"warning",action:ca})},[r]);return e.jsx(oe,{title:t("application:fileManager.listColumnSetting"),onAccept:u,showActions:!0,secondaryAction:e.jsx($d,{onColumnAdded:h}),dialogProps:{open:l??!1,onClose:c,fullWidth:!0,maxWidth:"sm",disableRestoreFocus:!0},children:e.jsx(se,{sx:{pb:0},children:e.jsx(qe,{children:e.jsx(Mt,{component:Ot,children:e.jsxs(Et,{sx:{width:"100%"},size:"small",children:[e.jsx(At,{children:e.jsxs(ke,{children:[e.jsx(Se,{width:"50%",children:t("fileManager.column")}),e.jsx(Se,{children:t("fileManager.actions")})]})}),e.jsx(Pt,{children:r.map((f,d)=>e.jsxs(ke,{hover:!0,sx:{"&:last-child td, &:last-child th":{border:0}},children:[e.jsx(Se,{component:"th",scope:"row",children:t(ht(f).title)}),e.jsx(Se,{children:e.jsxs(M,{sx:{display:"flex"},children:[d>0&&r.length>1?e.jsx(H,{size:"small",onClick:()=>{a(p=>{const g=[...p],m=g[d];return g[d]=g[d-1],g[d-1]=m,g})},children:e.jsx(_s,{sx:{width:"18px",height:"18px",transform:"rotate(180deg)"}})}):e.jsx(M,{sx:{width:28,height:28}}),d<r.length-1&&r.length>1?e.jsx(H,{size:"small",onClick:()=>{a(p=>{const g=[...p],m=g[d];return g[d]=g[d+1],g[d+1]=m,g})},children:e.jsx(_s,{sx:{width:"18px",height:"18px"}})}):e.jsx(M,{sx:{width:28,height:28}}),r.length>1?e.jsx(H,{size:"small",onClick:()=>{a(p=>p.filter((g,m)=>m!==d))},children:e.jsx(Qe,{sx:{width:"18px",height:"18px"}})}):e.jsx(M,{sx:{width:28,height:28}})]})})]},d))})]})})})})})},Gd=()=>{const{t}=P(),n=L(),[s,r]=i.useState(!1),a=C(u=>u.globalState.directLinkDialogOpen),l=C(u=>u.globalState.directLinkRes),o=i.useMemo(()=>l?l.map(u=>s?`[${new ve(u.file_url).elements().pop()}] ${u.link}`:u.link).join(`
`):"",[l,s]),c=i.useCallback(()=>{n(xo())},[n]);return e.jsx(oe,{title:t("application:modals.getSourceLinkTitle"),showActions:!0,hideOk:!0,secondaryAction:e.jsx(bo,{sx:{ml:0},slotProps:{typography:{variant:"body2",pl:1,color:"text.secondary"}},control:e.jsx(vo,{onChange:()=>{r(!s)},disableRipple:!0,checked:s,size:"small"}),label:t("application:modals.showFileName")}),dialogProps:{open:a??!1,onClose:c,fullWidth:!0,maxWidth:"sm"},children:e.jsx(se,{sx:{pt:2,pb:0},children:e.jsx(nn,{autoFocus:!0,label:t("modals.sourceLink"),multiline:!0,value:o,variant:"outlined",fullWidth:!0,slotProps:{htmlInput:{readonly:!0}}})})})},Xd=()=>{const t=C(o=>o.globalState.createArchiveDialogOpen),n=C(o=>o.globalState.extractArchiveDialogOpen),s=C(o=>o.globalState.remoteDownloadDialogOpen),r=C(o=>o.globalState.advanceSearchOpen),a=C(o=>o.globalState.listViewColumnSettingDialogOpen),l=C(o=>o.globalState.directLinkDialogOpen);return e.jsxs(e.Fragment,{children:[e.jsx(Ed,{}),e.jsx(Nc,{}),e.jsx(Hc,{}),e.jsx(Di,{}),e.jsx(Bc,{}),e.jsx(jo,{}),e.jsx(yo,{}),e.jsx(Uc,{}),e.jsx(Gc,{}),e.jsx(Xc,{}),e.jsx(Zc,{}),e.jsx(Yc,{}),e.jsx(Jc,{}),e.jsx(od,{}),e.jsx(So,{}),e.jsx(ld,{}),e.jsx(pd,{}),e.jsx(md,{}),e.jsx(bd,{}),e.jsx(wd,{}),e.jsx(Dd,{}),e.jsx(Td,{}),e.jsx(Od,{}),t!=null&&e.jsx(Ad,{}),n!=null&&e.jsx(_d,{}),s!=null&&e.jsx(zd,{}),r!=null&&e.jsx(Hd,{}),a!=null&&e.jsx(qd,{}),l!=null&&e.jsx(Gd,{})]})},Zd=()=>{const[t,n]=Co(()=>({accept:"file",drop:()=>{}}));i.useEffect(()=>(n(document.body),()=>{n(null)}),[])},Yd=({pointerOffset:t,files:n,...s})=>{var l;const[r,a]=i.useState([0,0]);if(i.useEffect(()=>{a([220,48])},[]),!(!n||n.length==0))return e.jsxs(St,{badgeContent:n.length<=1?void 0:n.length,color:"primary",sx:{"& .MuiBadge-badge":{zIndex:1612},transform:`translate(${t==null?void 0:t.x}px, ${t==null?void 0:t.y}px)`},children:[e.jsx(mt,{elevation:3,sx:{width:r[0],height:r[1],zIndex:1610,transition:o=>o.transitions.create(["width","height"])},...s,children:e.jsxs(wo,{children:[e.jsx(ko,{ignoreHovered:!0,selected:!1,file:n[0]}),e.jsx(Do,{variant:"body2",children:(l=n[0])==null?void 0:l.name})]})}),[...Array(Math.min(2,n.length-1)).keys()].map(o=>e.jsx(mt,{sx:{position:"absolute",width:r[0],height:r[1],zIndex:1610-o-1,top:(o+1)*4,left:(o+1)*4,transition:c=>c.transitions.create(["width","height"])},elevation:3}))]})},Jd=()=>{Zd();const{itemType:t,isDragging:n,item:s,pointerOffset:r}=wc(o=>({item:o.getItem(),itemType:o.getItemType(),pointerOffset:o.getClientOffset(),isDragging:o.isDragging()})),a=C(o=>o.fileManager[0].selected),l=i.useMemo(()=>{if(s&&s&&s.target){const o=s.includeSelected?Object.keys(a).map(c=>a[c]).filter(c=>c.path!=s.target.path):[];return[s.target,...o]}return[]},[a,s]);return n?e.jsx(M,{sx:{position:"fixed",pointerEvents:"none",zIndex:1600,left:0,top:0,width:"100%",height:"100%"},children:e.jsx(Yd,{files:l,pointerOffset:r})}):null};function Kd(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M12 4.5a4.5 4.5 0 0 0-4.495 4.285a.75.75 0 0 1-.75.715H6.5a3 3 0 1 0 0 6h3.576a6.554 6.554 0 0 0-.057 1.5H6.5a4.5 4.5 0 0 1-.42-8.98a6.001 6.001 0 0 1 11.84 0a4.5 4.5 0 0 1 4.053 4.973a6.534 6.534 0 0 0-1.8-1.857A3 3 0 0 0 17.5 9.5h-.256a.75.75 0 0 1-.749-.715A4.5 4.5 0 0 0 12 4.5m10 12a5.5 5.5 0 1 1-11 0a5.5 5.5 0 0 1 11 0m-6 3a.5.5 0 0 0 1 0v-4.793l1.646 1.647a.5.5 0 0 0 .708-.708l-2.5-2.5a.5.5 0 0 0-.708 0l-2.5 2.5a.5.5 0 0 0 .708.708L16 14.707z"})})}function Qd({open:t}){const{t:n}=P();return e.jsxs(To,{sx:{zIndex:s=>s.zIndex.drawer+1,color:"#fff",flexDirection:"column"},open:t,children:[e.jsx("div",{children:e.jsx(Kd,{style:{fontSize:80}})}),e.jsx("div",{children:e.jsx(re,{variant:"h4",children:n("uploader.dropFileHere")})})]})}const eu=N(M)(({theme:t})=>({borderRadius:t.shape.borderRadius,backgroundColor:t.palette.mode=="light"?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",padding:t.spacing(2),color:t.palette.text.secondary})),tu=({onFilePasted:t,onClose:n})=>{const{t:s}=P(),r=a=>{var l;a.preventDefault(),(l=a.clipboardData)!=null&&l.files.length&&(t(Array.from(a.clipboardData.files)),n())};return i.useEffect(()=>(window.addEventListener("paste",r),()=>{window.removeEventListener("paste",r)}),[]),i.useCallback(a=>(a.preventDefault(),!1),[]),e.jsxs(eu,{sx:{py:5,mt:.5},children:[e.jsx(Oo,{sx:{fontSize:60}}),e.jsx(re,{sx:{pt:1},children:s("uploader.pasteFilesHere")})]})};function nu({onFilePasted:t}){const{t:n}=P(),s=L(),r=C(l=>l.globalState.uploadFromClipboardDialogOpen),a=i.useCallback(()=>{s(Mo(!1))},[]);return e.jsx(oe,{title:n("uploader.uploadFromClipboard"),dialogProps:{fullWidth:!0,maxWidth:"xs",open:!!r,onClose:a},children:e.jsx(se,{children:e.jsx(tu,{onClose:a,onFilePasted:t})})})}function su(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M12 2v6a2 2 0 0 0 2 2h6v10a2 2 0 0 1-2 2h-6.81A6.5 6.5 0 0 0 4 11.498V4a2 2 0 0 1 2-2zm1.5.5V8a.5.5 0 0 0 .5.5h5.5zm-1.5 15a5.5 5.5 0 1 1-11 0a5.5 5.5 0 0 1 11 0m-5-3a.5.5 0 0 0-1 0v4.793l-1.646-1.647a.5.5 0 0 0-.708.708l2.5 2.5a.5.5 0 0 0 .708 0l2.5-2.5a.5.5 0 0 0-.708-.708L7 19.293z"})})}function au(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M5 5.274c0-1.707 1.826-2.792 3.325-1.977l12.362 6.727c1.566.852 1.566 3.1 0 3.952L8.325 20.702C6.826 21.518 5 20.432 5 18.726z"})})}function ru(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M9.75 2h3.998a.75.75 0 0 1 .102 1.493l-.102.007H12.5v17h1.246a.75.75 0 0 1 .743.648l.007.102a.75.75 0 0 1-.648.743l-.102.007H9.75a.75.75 0 0 1-.102-1.493l.102-.007h1.249v-17H9.75a.75.75 0 0 1-.743-.648L9 2.75a.75.75 0 0 1 .648-.743zm8.496 2.997a3.253 3.253 0 0 1 3.25 3.25l.004 7.504a3.249 3.249 0 0 1-3.064 3.246l-.186.005h-4.745V4.996zm-8.249 0L9.992 19H5.25A3.25 3.25 0 0 1 2 15.751V8.247a3.25 3.25 0 0 1 3.25-3.25z"})})}function ou(t){const n=i.useRef(0),[s,r]=i.useState(t.status),[a,l]=i.useState(t.error),[o,c]=i.useState(t.progress),{enqueueSnackbar:u}=Ne();i.useEffect(()=>{t.subscribe({onTransition:p=>{r(p)},onError:p=>{l(p),r(t.status)},onProgress:p=>{c(p)},onMsg:(p,g)=>{u(p,{variant:g})}})},[]);const[h,f]=Tn.useMemo(()=>{if(o==null||o.total==null||o.total.loaded==null)return[0,0];const p=(Date.now()-(t.lastTime||0))/1e3,g=(Date.now()-(t.startTime||0))/1e3,m=o.total.loaded>n.current?Math.floor((o.total.loaded-n.current)/p):0,x=o.total.loaded>0?Math.floor(o.total.loaded/g):0;return n.current=o.total.loaded,t.lastTime=Date.now(),[m,x]},[o==null?void 0:o.total.loaded]);return{status:s,error:a,progress:o,speed:h,speedAvg:f,retry:p=>{t.retry(p)}}}function iu({uploader:t,error:n}){const{t:s}=P(),r=[{name:s("uploader.fileName"),value:t.task.name},{name:s("uploader.fileSize"),value:`${we(t.task.size)} ${t.task.session&&t.task.session.chunk_size>0?s("uploader.chunkDescription",{total:t.task.chunkProgress.length,size:we(t.task.session.chunk_size)}):s("uploader.noChunks")}`},{name:s("uploader.storagePolicy"),value:t.task.policy.name},{name:s("uploader.destination"),value:e.jsx(bt,{sx:{my:.5},variant:"outlined",clickable:!0,simplifiedFile:{path:t.task.dst,type:Te.folder}})},t.task.session?{name:s("uploader.uploadSession"),value:e.jsx(e.Fragment,{children:e.jsx(Ke,{i18nKey:"uploader.sessionExpiredIn",components:[e.jsx(Eo,{datetime:t.task.session?t.task.session.expires*1e3:0,locale:s("timeAgoLocaleCode",{ns:"common"})},0)]})})}:null,t.status===W.error?{name:s("uploader.errorDetails"),value:n}:null];return e.jsx(ot,{container:!0,sx:{fontSize:a=>a.typography.body2.fontSize},children:r.map(a=>e.jsx(e.Fragment,{children:a&&e.jsxs(ot,{container:!0,xs:12,children:[e.jsx(ot,{item:!0,xs:3,sx:{fontWeight:700},children:a.name}),e.jsx(ot,{item:!0,xs:9,sx:{color:l=>l.palette.text.secondary,wordBreak:"break-all"},children:a.value})]},a.name)}))})}const lu=N(mn)(()=>({maxWidth:"100%",boxShadow:"none","&:not(:last-child)":{borderBottom:0},"&:before":{display:"none"},"& .Mui-expanded":{margin:"0!important"}})),cu=N(Xs)(()=>({minHeight:"56px",padding:0,display:"block","& .MuiAccordionSummary-content":{margin:0,display:"block","& .Mui-expanded":{margin:"0!important"}}})),du=N(xn)(({theme:t})=>({"& .MuiAccordionActions-root":{paddingLeft:16,paddingRight:16,paddingTop:8,paddingBottom:8,display:"block",backgroundColor:t.palette.background.default}})),uu=(t,n,s)=>{let r=n;return s||(r=t),`${we(r||0)} /s`},Ls=t=>{if(t){let n=t.message;return t instanceof pa&&(n=t.Message()),n}};function pu({uploader:t,useAvgSpeed:n,onCancel:s,onClose:r,selectFile:a,onRefresh:l}){const{t:o}=P("application",{keyPrefix:"uploader"}),c=X(),[u,h]=i.useState(!1),[f,d]=i.useState(!1),{status:p,error:g,progress:m,speed:x,speedAvg:j,retry:v}=ou(t),k=le(c.breakpoints.down("md")),[w,D]=i.useState(!1),y=(S,O)=>{d(!!O)};i.useEffect(()=>{p>=W.finished&&l()},[p]);const b=i.useMemo(()=>{switch(p){case W.added:case W.initialized:case W.queued:return e.jsx("div",{children:o("pendingInQueue")});case W.preparing:return e.jsx("div",{children:o("preparing")});case W.error:return e.jsxs(M,{sx:{color:c.palette.warning.main,wordBreak:"break-all",...c.breakpoints.up("sm")?{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}:{}},children:[Ls(g),e.jsx("br",{})]});case W.finishing:return e.jsx("div",{children:o("processing")});case W.resumable:return m&&e.jsx("div",{children:o("progressDescription",{uploaded:we(m.total.loaded),total:we(m.total.size),percentage:m.total.percent.toFixed(2)})});case W.processing:return m?e.jsx("div",{children:o("progressDescriptionFull",{speed:uu(x,j,n),uploaded:we(m.total.loaded),total:we(m.total.size),percentage:m.total.percent.toFixed(2)})}):e.jsx("div",{children:o("progressDescriptionPlaceHolder")});case W.finished:return e.jsxs(M,{sx:{color:c.palette.success.main},children:[o("uploaded"),e.jsx("br",{})]});default:return e.jsx("div",{children:o("unknownStatus")})}},[p,g,m,x,j,n]),E=i.useMemo(()=>t.task.resumed&&!k?e.jsx(an,{sx:{ml:1,height:18},size:"small",label:o("resumed")}):null,[p,k]),z=i.useMemo(()=>p===W.resumable&&!k?e.jsx(an,{sx:{ml:1,height:18,fontSize:S=>S.typography.caption.fontSize},size:"small",color:"secondary",label:o("resumable")}):null,[p,k]),K=i.useMemo(()=>(p===W.processing||p===W.finishing||p===W.resumable)&&m?e.jsx(M,{sx:{backgroundColor:c.palette.mode==="light"?da(c.palette.primary.main,.8):ua(c.palette.primary.main,.18),width:m.total.percent+"%",transition:"width .4s linear",zIndex:1,height:"100%",position:"absolute",left:0,top:0}}):null,[p,m,c]),U=i.useMemo(()=>e.jsx(iu,{error:(g&&Ls(g))??"",uploader:t}),[t,f]),A=()=>{D(!0),t.cancel().then(()=>{D(!1),s(S=>S.id!=t.id)})},_=S=>{S.stopPropagation()},V=i.useMemo(()=>{if(!u&&!k)return e.jsx(e.Fragment,{});const S=g instanceof Ao&&g.IsConflictError(),O=[{show:p===W.error&&!S,title:o("retry"),click:()=>v(),icon:e.jsx(yi,{sx:{fontSize:"20px"}}),loading:!1},{show:p===W.error&&S,title:o("rename"),click:()=>v({new_prefix:o("fileCopyName")}),icon:e.jsx(ru,{sx:{fontSize:"20px"}}),loading:!1},{show:p===W.error&&S,title:o("overwrite"),click:()=>v({overwrite:!0}),icon:e.jsx(su,{sx:{fontSize:"20px"}}),loading:!1},{show:!0,title:p===W.finished?o("deleteTask"):o("cancelAndDelete"),click:A,icon:e.jsx(Po,{sx:{fontSize:"20px"}}),loading:w},{show:p===W.resumable,title:o("selectAndResume"),click:()=>a(t.task.dst,rn.File,t),icon:e.jsx(au,{sx:{fontSize:"20px"}}),loading:!1}];return e.jsx(e.Fragment,{children:O.map(I=>e.jsx(e.Fragment,{children:I.show&&e.jsx(Io,{in:I.show,children:e.jsx(Q,{title:I.title,children:e.jsx(H,{onMouseDown:_,onTouchStart:_,disabled:I.loading,onClick:te=>{te.stopPropagation(),I.click()},size:"small",children:I.icon})})})}))})},[p,w,u,k,t,o]),T=i.useMemo(()=>{if(!k)return e.jsx(_o,{name:t.task.name,fileType:Te.file})},[t,k]);return e.jsxs(e.Fragment,{children:[e.jsxs(lu,{disableGutters:!0,square:!0,expanded:f,onChange:y,children:[e.jsx(cu,{"aria-controls":"panel1d-content",id:"panel1d-header",children:e.jsxs(M,{sx:{position:"relative"},onMouseLeave:()=>h(!1),onMouseOver:()=>h(!0),children:[K,e.jsxs(Zs,{sx:{borderRadius:0,position:"relative",zIndex:9},children:[T,e.jsx(q,{sx:{marginLeft:"16px",marginRight:"20px",my:0},primary:e.jsxs(M,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(cs,{sx:{overflow:"hidden"},children:t.task.name}),e.jsx("div",{children:E}),e.jsx("div",{children:z})]}),secondary:e.jsx(cs,{sx:{overflow:"hidden"},children:b}),slotProps:{primary:{variant:"body2"},secondary:{variant:"caption"}}}),e.jsx(M,{sx:{display:"flex",gap:1},children:V})]})]})}),e.jsx(du,{children:U})]}),e.jsx(It,{})]})}function hu(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M12.546 17H2.75l-.102.007A.75.75 0 0 0 2.75 18.5h9.246c0-.211.046-.428.144-.638zm1.175-2.5H2.75a.75.75 0 0 1-.102-1.493L2.75 13h11.676zM21.25 9H2.75l-.102.007A.75.75 0 0 0 2.75 10.5h18.5l.102-.007A.75.75 0 0 0 21.25 9m0-4H2.75l-.102.007A.75.75 0 0 0 2.75 6.5h18.5l.102-.007A.75.75 0 0 0 21.25 5m-4.933 7h4.827a.5.5 0 0 1 .436.745L19.75 16h1.495a.75.75 0 0 1 .565 1.244l-4.824 5.508c-.505.576-1.443.085-1.258-.657L16.5 19h-3.002a.5.5 0 0 1-.453-.713l2.82-6a.5.5 0 0 1 .453-.287"})})}function fu(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M12 4.5a7.5 7.5 0 1 0 7.419 6.392c-.067-.454.265-.892.724-.892c.37 0 .696.256.752.623A9 9 0 1 1 18 5.292V4.25a.75.75 0 0 1 1.5 0v3a.75.75 0 0 1-.75.75h-3a.75.75 0 0 1 0-1.5h1.35a7.474 7.474 0 0 0-5.1-2"})})}function gu({open:t,onClose:n,onSave:s}){const{t:r}=P(),[a,l]=i.useState($.getWithFallback(ae.ConcurrentLimit)),o=i.useCallback(()=>{s(a)},[a]);return e.jsx(oe,{title:r("uploader.setConcurrent"),showActions:!0,showCancel:!0,onAccept:o,dialogProps:{fullWidth:!0,maxWidth:"xs",open:t,onClose:n},children:e.jsx(se,{children:e.jsxs(Ue,{variant:"filled",fullWidth:!0,children:[e.jsx(yn,{htmlFor:"component-helper",children:r("uploader.concurrentTaskNumber")}),e.jsx(Lo,{type:"number",inputProps:{min:1,step:1,max:20},value:a,onChange:c=>l(c.target.value)})]})})})}function mu({anchorEl:t,onClose:n,uploadManager:s,useAvgSpeed:r,setUseAvgSpeed:a,filter:l,setFilter:o,sorter:c,setSorter:u,cleanFinished:h,retryFailed:f}){const{t:d}=P("application",{keyPrefix:"uploader"}),[p,g]=i.useState(!1),[m,x]=i.useState($.getWithFallback(ae.UploadOverwrite)),j=b=>()=>{n(),b()},v=b=>{$.set(ae.UploadOverwrite,b),s.overwrite=b,x(b)},k=!!t,w=k?"uploader-action-popover":void 0,D=i.useMemo(()=>[{tooltip:d("overwriteTooltip"),onClick:()=>v(!m),icon:m?e.jsx(De,{}):e.jsx(_e,{}),text:d("overwrite"),divider:!0},{tooltip:d("hideCompletedTooltip"),onClick:()=>o(l==="default"?"ongoing":"default"),icon:l!=="default"?e.jsx(De,{}):e.jsx(_e,{}),text:d("hideCompleted"),divider:!0},{tooltip:d("addTimeAscTooltip"),onClick:()=>u("default"),icon:c==="default"?e.jsx(De,{}):e.jsx(_e,{}),text:d("addTimeAsc"),divider:!1},{tooltip:d("addTimeDescTooltip"),onClick:()=>u("reverse"),icon:c==="reverse"?e.jsx(De,{}):e.jsx(_e,{}),text:d("addTimeDesc"),divider:!0},{tooltip:d("showInstantSpeedTooltip"),onClick:()=>a(!1),icon:r?e.jsx(_e,{}):e.jsx(De,{}),text:d("showInstantSpeed"),divider:!1},{tooltip:d("showAvgSpeedTooltip"),onClick:()=>a(!0),icon:r?e.jsx(De,{}):e.jsx(_e,{}),text:d("showAvgSpeed"),divider:!0},{tooltip:d("cleanCompletedTooltip"),onClick:()=>h(),icon:e.jsx(ha,{}),text:d("cleanCompleted"),divider:!1},{tooltip:d("retryFailedTasksTooltip"),onClick:()=>f(),icon:e.jsx(fu,{}),text:d("retryFailedTasks"),divider:!0},{tooltip:d("setConcurrentTooltip"),onClick:()=>g(!0),icon:e.jsx(hu,{}),text:d("setConcurrent"),divider:!1}],[r,a,c,u,l,o,h,m]),y=b=>{const E=parseInt(b);E>0&&($.set(ae.ConcurrentLimit,E),s.changeConcurrentLimit(E)),g(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(ye,{id:w,open:k,anchorEl:t,onClose:n,children:D.map(b=>[e.jsx(Q,{enterNextDelay:500,title:b.tooltip,children:e.jsxs(vt,{dense:!0,onClick:j(b.onClick),children:[e.jsx(ce,{sx:{minWidth:38},children:b.icon}),b.text]})},b.text),b.divider&&e.jsx(_t,{})])}),e.jsx(gu,{open:p,onClose:()=>g(!1),onSave:y})]})}const xu=Tn.forwardRef(function(n,s){return e.jsx($s,{direction:"up",ref:s,...n})}),bu=N(ea)(({fullScreen:t,theme:n})=>({"& .MuiDialog-container":{alignItems:"flex-end",justifyContent:"flex-end"},"& .MuiDialog-paper":{border:`1px solid ${n.palette.divider}`},...t?{margin:0,position:"fixed",inset:"-1!important"}:{top:"auto!important",left:"auto!important"}})),vu=N(se)(({theme:t})=>({[t.breakpoints.up("md")]:{width:500,minHeight:300,maxHeight:"calc(100vh - 140px)"},padding:0,paddingTop:"0!important"})),ju=N(Oi)(({theme:t,expanded:n})=>({transform:`rotate(${n?0:180}deg)`,transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest,easing:t.transitions.easing.easeInOut})})),yu={default:(t,n)=>t.id-n.id,reverse:(t,n)=>n.id-t.id},zs={default:t=>!0,ongoing:t=>t.status<W.finished};function Su({open:t,onClose:n,selectFile:s,taskList:r,onCancel:a,uploadManager:l,progress:o,setUploaders:c}){const{t:u}=P("application",{keyPrefix:"uploader"}),h=X(),f=le(h.breakpoints.down("md")),d=C(O=>O.fileManager[0].pure_path),[p,g]=i.useState(!0),[m,x]=i.useState($.getWithFallback(ae.UseAvgSpeed)),[j,v]=i.useState(null),[k,w]=i.useState($.getWithFallback(ae.TaskFilter)),[D,y]=i.useState($.getWithFallback(ae.TaskSorter)),[b,E]=i.useState(!1),z=O=>{v(O.currentTarget)},K=()=>{v(null)},U=(O,I)=>{I!=="backdropClick"?n():g(!1)},A=(O,I)=>{g(I)};i.useMemo(()=>{t&&g(!0)},[r]);const _=O=>I=>{I.stopPropagation(),O(I)},V=i.useMemo(()=>o&&o.totalSize>0?e.jsx(Pn,{in:o.totalSize>0&&!p,children:e.jsx("div",{children:e.jsx(M,{sx:{backgroundColor:h.palette.mode==="light"?da(h.palette.primary.main,.8):ua(h.palette.primary.main,.18),width:o.processedSize/o.totalSize*100+"%",transition:"width .4s linear",zIndex:-1,height:"100%",position:"absolute",left:0,top:0}})})}):null,[o,p,h]),T=i.useMemo(()=>{const O=r.filter(zs[k]).sort(yu[D]);return O.length===0?e.jsx(zo,{size:.5,top:63,primary:u("taskListEmpty")}):e.jsx(Fo,{style:{height:(f?500:66)*O.length,maxHeight:"calc(100vh - 56px)",...h.breakpoints.up("md")?{minHeight:300,maxHeight:"calc(100vh - 140px)"}:{}},increaseViewportBy:180,data:O,itemContent:(I,te)=>e.jsx(pu,{selectFile:s,onClose:U,onCancel:a,useAvgSpeed:m,uploader:te,onRefresh:()=>E(ie=>!ie)},te.id)})},[r,m,f,k,D,b]),S=()=>{r.forEach(O=>{O.status===W.error&&O.retry()})};return e.jsxs(e.Fragment,{children:[e.jsx(mu,{onClose:K,uploadManager:l,anchorEl:j,useAvgSpeed:m,setUseAvgSpeed:O=>{$.set(ae.UseAvgSpeed,O),x(O)},filter:k,sorter:D,setFilter:O=>{$.set(ae.TaskFilter,O),w(O)},setSorter:O=>{$.set(ae.TaskSorter,O),y(O)},retryFailed:S,cleanFinished:()=>c(O=>O.filter(zs.ongoing))}),e.jsx(bu,{fullScreen:f,open:t,onClose:U,TransitionComponent:xu,disableEnforceFocus:!p,hideBackdrop:!p,disableScrollLock:!p,children:e.jsxs(mn,{sx:f?{boxShadow:"none"}:void 0,expanded:p||f,onChange:A,children:[e.jsxs(ja,{color:"default",onClick:()=>g(!p),sx:{boxShadow:"none",position:"relative",cursor:"pointer"},children:[V,e.jsxs(Ca,{disableGutters:!0,sx:{px:1,minHeight:"52px!important"},children:[e.jsx(Q,{title:u("hideTaskList"),children:e.jsx(H,{color:"inherit",onClick:_(()=>U(null,"")),"aria-label":"Close",children:e.jsx(Qe,{fontSize:"small"})})}),e.jsx(re,{variant:"subtitle1",color:"inherit",sx:{flex:"1",ml:1,fontWeight:h.typography.h6.fontWeight},children:u("uploadTasks")}),e.jsxs(M,{sx:{display:"flex",gap:1},children:[e.jsx(Q,{title:u("moreActions"),children:e.jsx(H,{color:"inherit",onClick:_(z),children:e.jsx(on,{fontSize:"small"})})}),d&&e.jsx(Q,{title:u("addNewFiles"),children:e.jsx(H,{color:"inherit",onClick:_(()=>s(d??yt)),children:e.jsx(tt,{fontSize:"small"})})}),!f&&e.jsx(Q,{title:u("toggleTaskList"),children:e.jsx(H,{sx:{p:"6px"},color:"inherit",onClick:_(()=>g(!p)),children:e.jsx(ju,{expanded:p})})})]})]})]}),e.jsx(xn,{sx:{p:0},children:e.jsx(vu,{children:T})})]})})]})}let Fs=null,Rs=-1;const Cu="image.png",wu=()=>{const{t}=P(),n=L(),{enqueueSnackbar:s}=Ne(),[r,a]=i.useState([]),[l,o]=i.useState(!1),c=C(D=>D.globalState.uploadProgress),u=C(D=>D.globalState.uploadTaskListOpen);C(D=>{var y;return(y=D.fileManager[0].list)==null?void 0:y.parent});const h=C(D=>D.fileManager[0].pure_path),f=C(D=>{var y;return(y=D.fileManager[0].list)==null?void 0:y.storage_policy}),d=C(D=>D.globalState.uploadFileSignal),p=C(D=>D.globalState.uploadFolderSignal),g=i.useCallback(D=>y=>{if(D!==void 0&&(y.length!==1||y[0].key()!==D.key())){s(t("uploader.fileNotMatchError"),{variant:"warning"});return}y.forEach(b=>b.start()),n(ln()),a(b=>(D!==void 0&&(b=b.filter(E=>E.key()!==D.key())),[...b,...y]))},[s,n,a]),m=i.useMemo(()=>new Ro({logLevel:"INFO",concurrentLimit:parseInt($.getWithFallback(ae.ConcurrentLimit)),overwrite:$.getWithFallback(ae.UploadOverwrite),dropZone:document.querySelector("body"),onToast:(D,y)=>{s(y,{variant:D})},onDropOver:D=>{o(y=>!y)},onDropLeave:D=>{o(y=>!y)},onProactiveFileAdded:g(),onPoolEmpty:()=>{setTimeout(()=>{n(No(0)),n(fa(0))},1e3)}}),[]);i.useEffect(()=>{m.setPolicy(f,h)},[f]);const x=i.useCallback(D=>{D instanceof pa?s(D.Message(),{variant:"warning"}):s(t("uploader:unknownError",{msg:D.message}),{variant:"error"})},[s,t]),j=i.useCallback((D,y=rn.File,b)=>{n(ln()),m.select(D,y).then(g(b)).catch(E=>{x(E)})},[m,g,x,n]),v=i.useCallback(D=>D.type.startsWith("image")&&D.name==Cu?t("uploader.clipboardDefaultFileName",{date:de().valueOf()}):D.name,[t]),k=i.useCallback(D=>{m.addRawFiles(D,v).catch(y=>{x(y)})},[m,g,x,n,v]);i.useEffect(()=>{const D=m.resumeTasks();a(y=>[...y,...D.filter(b=>y.find(E=>E.key()===b.key())===void 0)]),Fs||(Fs=setInterval(()=>{let y={totalSize:0,processedSize:0,total:0,processed:0};a(b=>(b.forEach(E=>{E.id<=Rs||(y.totalSize+=E.task.size,y.total+=1,(E.status===W.finished||E.status===W.canceled||E.status===W.error)&&(y.processedSize+=E.task.size,y.processed+=1),(E.status===W.added||E.status===W.initialized||E.status===W.queued||E.status===W.preparing||E.status===W.processing||E.status===W.finishing)&&(y.processedSize+=E.progress?E.progress.total.loaded:0))}),y.total>0&&y.processed===y.total&&(Rs=b[b.length-1].id),b)),n(Wo({progress:y,count:y.total}))},2e3))},[]),i.useEffect(()=>{d&&d>0&&h&&j(h)},[d]),i.useEffect(()=>{p&&p>0&&h&&j(h,rn.Directory)},[p]);const w=i.useCallback(D=>{a(y=>y.filter(D))},[]);return e.jsxs(e.Fragment,{children:[e.jsx(nu,{onFilePasted:k}),e.jsx(Qd,{open:l}),e.jsx(Su,{progress:c,uploadManager:m,taskList:r,open:!!u,onCancel:w,selectFile:j,onClose:()=>n(Ho()),setUploaders:a})]})},Wa=N("div")(({theme:t})=>({display:"flex",alignItems:"center",padding:t.spacing(0,1),...t.mixins.toolbar,justifyContent:"flex-end"})),ku=()=>{const t=X(),n=le(t.breakpoints.down("sm")),s=L(),[r,a]=i.useState(!1);return e.jsxs(Wa,{onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:[e.jsx(M,{sx:{width:"100%",pl:2},children:e.jsx(Bo,{sx:{height:"auto",maxWidth:160,maxHeight:35,width:"100%",objectPosition:"left",objectFit:"contain"}})}),!n&&e.jsx(M,{children:e.jsx(Pn,{in:r,children:e.jsx(H,{onClick:()=>s(ga(!1)),children:e.jsx(Ki,{})})})})]})};function Du(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M15.78 3.737a2.25 2.25 0 0 0-1.56 0L9.913 5.33a.25.25 0 0 0-.163.234v2.793a4.75 4.75 0 0 0-1.5 0V5.563a1.75 1.75 0 0 1 1.143-1.641L13.7 2.33a3.75 3.75 0 0 1 2.6 0l4.307 1.592a1.75 1.75 0 0 1 1.143 1.641v10.67a1.75 1.75 0 0 1-1.143 1.642l-4.018 1.484c.105-.292.161-.604.161-.927v-.731l3.337-1.233a.25.25 0 0 0 .163-.235V5.563a.25.25 0 0 0-.163-.234zm-4.01 3.93a.75.75 0 1 1 .49-1.418l2.658.92a.25.25 0 0 0 .163 0l2.65-.92a.75.75 0 1 1 .492 1.418l-2.65.919a1.75 1.75 0 0 1-1.145 0zm-6 7a.75.75 0 0 1 .49-1.418l2.74.948l2.732-.947a.75.75 0 1 1 .49 1.417l-2.472.857v2.7a.75.75 0 0 1-1.5 0v-2.7zM10.3 9.53a3.75 3.75 0 0 0-2.6 0l-4.307 1.592a1.75 1.75 0 0 0-1.143 1.641v5.67a1.75 1.75 0 0 0 1.143 1.642L7.7 21.666a3.75 3.75 0 0 0 2.6 0l4.307-1.592a1.75 1.75 0 0 0 1.143-1.642v-5.67a1.75 1.75 0 0 0-1.143-1.641zm-2.08 1.407a2.25 2.25 0 0 1 1.56 0l4.307 1.592a.25.25 0 0 1 .163.234v5.67a.25.25 0 0 1-.163.235L9.78 20.259a2.25 2.25 0 0 1-1.56 0l-4.307-1.592a.25.25 0 0 1-.163-.235v-5.67a.25.25 0 0 1 .163-.234z"})})}function Tu(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M6.087 7.75a5.752 5.752 0 0 1 11.326 0h.087a4 4 0 0 1 3.962 4.552 6.501 6.501 0 0 0-11.42 3.448H6a4 4 0 0 1 0-8h.087ZM22 16.5a5.5 5.5 0 1 0-11 0 5.5 5.5 0 0 0 11 0Zm-6-3a.5.5 0 0 1 1 0v4.793l1.646-1.647a.5.5 0 0 1 .708.708l-2.5 2.5a.5.5 0 0 1-.708 0l-2.5-2.5a.5.5 0 0 1 .708-.708L16 18.293V13.5Z"})})}function Ha(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M13.409 2.513a3.75 3.75 0 0 0-2.818 0l-7.498 3.04A1.75 1.75 0 0 0 2 7.175v9.653a1.75 1.75 0 0 0 1.093 1.621l7.498 3.04a3.75 3.75 0 0 0 1.966.233A6.475 6.475 0 0 1 11 17.501c0-.621.087-1.222.25-1.792v-4.948L6.484 8.952a.75.75 0 0 1 .532-1.402L12 9.44l4.984-1.89a.75.75 0 1 1 .532 1.402l-4.766 1.809v2.303A6.482 6.482 0 0 1 17.5 11c1.747 0 3.332.689 4.5 1.81V7.174a1.75 1.75 0 0 0-1.093-1.622zM12 17.501a5.5 5.5 0 1 0 11 0a5.5 5.5 0 0 0-11 0m8.5-3.5a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h1a2.496 2.496 0 0 0-2-1c-.833 0-1.572.407-2.027 1.036a.5.5 0 0 1-.81-.586A3.496 3.496 0 0 1 17.5 14c.98 0 1.865.403 2.5 1.05v-.55a.5.5 0 0 1 .5-.5M15 19.95v.55a.5.5 0 0 1-1 0v-2a.5.5 0 0 1 .5-.5h2a.5.5 0 1 1 0 1h-1c.456.608 1.183 1 2 1c.766 0 1.452-.344 1.911-.888a.5.5 0 0 1 .764.645A3.494 3.494 0 0 1 17.5 21a3.49 3.49 0 0 1-2.5-1.05"})})}function Mu(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M8.5 5.23a2.25 2.25 0 0 1 2.25-2.25h2.5a2.25 2.25 0 0 1 2.25 2.25V7h3.25A2.25 2.25 0 0 1 21 9.25v11a.75.75 0 0 1-.75.75H3.75a.75.75 0 0 1-.75-.75v-8A2.25 2.25 0 0 1 5.25 10H8.5zM10 19.5h4V5.23a.75.75 0 0 0-.75-.75h-2.5a.75.75 0 0 0-.75.75zm-1.5-8H5.25a.75.75 0 0 0-.75.75v7.25h4zm7 8h4V9.25a.75.75 0 0 0-.75-.75H15.5z"})})}function Ou(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M9 5.23a2.25 2.25 0 0 1 2.25-2.25h1.5A2.25 2.25 0 0 1 15 5.23V21H9zM7.5 10H5.25A2.25 2.25 0 0 0 3 12.25v8c0 .415.336.75.75.75H7.5zm9 11h3.75a.75.75 0 0 0 .75-.75v-11A2.25 2.25 0 0 0 18.75 7H16.5z"})})}function Eu(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M15.75 14.5a.75.75 0 0 0 0 1.5h2.5a.75.75 0 0 0 0-1.5zM2 8.25A3.25 3.25 0 0 1 5.25 5h13.5A3.25 3.25 0 0 1 22 8.25v7.5A3.25 3.25 0 0 1 18.75 19H5.25A3.25 3.25 0 0 1 2 15.75zM20.5 9.5V8.25a1.75 1.75 0 0 0-1.75-1.75H5.25A1.75 1.75 0 0 0 3.5 8.25V9.5zM3.5 11v4.75c0 .966.784 1.75 1.75 1.75h13.5a1.75 1.75 0 0 0 1.75-1.75V11z"})})}function Au(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M5.25 5A3.25 3.25 0 0 0 2 8.25V9.5h20V8.25A3.25 3.25 0 0 0 18.75 5zM22 11H2v4.75A3.25 3.25 0 0 0 5.25 19h13.5A3.25 3.25 0 0 0 22 15.75zm-6.25 3.5h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1 0-1.5"})})}const Pu=ge(e.jsx("path",{d:"M5.5 8a2.5 2.5 0 1 1 5 0a2.5 2.5 0 0 1-5 0M8 4a4 4 0 1 0 0 8a4 4 0 0 0 0-8m7.5 5a1.5 1.5 0 1 1 3 0a1.5 1.5 0 0 1-3 0M17 6a3 3 0 1 0 0 6a3 3 0 0 0 0-6m-2.752 13.038c.703.285 1.604.462 2.753.462c2.282 0 3.586-.697 4.297-1.558c.345-.418.52-.84.61-1.163a2.728 2.728 0 0 0 .093-.573v-.027A2.179 2.179 0 0 0 19.822 14H14.18c-.028 0-.055 0-.082.002c.394.41.68.925.816 1.498h4.908c.372 0 .674.299.679.669a1.236 1.236 0 0 1-.04.212a1.6 1.6 0 0 1-.32.605c-.35.426-1.172 1.014-3.14 1.014c-.98 0-1.676-.146-2.17-.345c-.108.4-.286.883-.583 1.383M4.25 14A2.25 2.25 0 0 0 2 16.25v.278a2.073 2.073 0 0 0 .014.208a4.487 4.487 0 0 0 .778 2.07C3.61 19.974 5.172 21 8 21c2.828 0 4.39-1.025 5.208-2.195a4.484 4.484 0 0 0 .778-2.07a2.992 2.992 0 0 0 .014-.207v-.278A2.25 2.25 0 0 0 11.75 14zm-.75 2.507v-.257a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 .75.75v.257l-.007.08a2.986 2.986 0 0 1-.514 1.358C11.486 18.65 10.422 19.5 8 19.5s-3.486-.85-3.98-1.555a2.986 2.986 0 0 1-.513-1.358a1.527 1.527 0 0 1-.007-.08"}),"People");function Iu(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M17.755 14a2.249 2.249 0 0 1 2.248 2.25v.575c0 .894-.32 1.759-.9 2.438c-1.57 1.833-3.957 2.738-7.103 2.738c-3.145 0-5.532-.905-7.098-2.74a3.75 3.75 0 0 1-.898-2.434v-.578A2.249 2.249 0 0 1 6.253 14zm0 1.5H6.252a.749.749 0 0 0-.75.75v.577c0 .535.192 1.053.54 1.46c1.253 1.469 3.22 2.214 5.957 2.214c2.739 0 4.706-.745 5.963-2.213a2.25 2.25 0 0 0 .54-1.463v-.576a.749.749 0 0 0-.748-.749M12 2.005a5 5 0 1 1 0 10a5 5 0 0 1 0-10m0 1.5a3.5 3.5 0 1 0 0 7a3.5 3.5 0 0 0 0-7"})})}function _u(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M8.254 8.003c.967 0 1.75.784 1.75 1.75v9.5a1.75 1.75 0 0 1-1.75 1.75H3.75A1.75 1.75 0 0 1 2 19.253v-9.5c0-.966.784-1.75 1.75-1.75h4.504Zm-2.002 9.495h-.5a.75.75 0 1 0 0 1.5h.5a.75.75 0 0 0 0-1.5ZM21.25 16.5a.75.75 0 0 1 .102 1.493L21.25 18H11v-1.5h10.25ZM18.25 5c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 18.25 16H11V9a2 2 0 0 0-1.85-1.994L9 7H4v-.25C4 5.784 4.784 5 5.75 5h12.5Z"})})}function Lu(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M8.254 8.003c.967 0 1.75.784 1.75 1.75v9.5a1.75 1.75 0 0 1-1.75 1.75H3.75A1.75 1.75 0 0 1 2 19.253v-9.5c0-.966.784-1.75 1.75-1.75h4.504Zm0 1.5H3.75a.25.25 0 0 0-.25.25v9.5c0 .138.112.25.25.25h4.504a.25.25 0 0 0 .25-.25v-9.5a.25.25 0 0 0-.25-.25ZM6.252 17a.75.75 0 0 1 .102 1.493l-.102.007h-.5a.75.75 0 0 1-.102-1.493L5.752 17h.5Zm14.997-.5a.75.75 0 0 1 .102 1.493L21.25 18H11v-1.5h10.25ZM18.25 5c.966 0 1.75.784 1.75 1.75v7.5A1.75 1.75 0 0 1 18.25 16H11v-1.5h7.25a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25H5.75a.25.25 0 0 0-.25.25L5.499 7H4v-.25C4 5.784 4.784 5 5.75 5h12.5Z"})})}function zu(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M18.749 3a2.25 2.25 0 0 1 2.25 2.25v13.502a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18.752V5.25A2.25 2.25 0 0 1 5.25 3h13.499zM9.812 7.949L8.255 11.5H6.75a.75.75 0 0 0 0 1.5h1.995a.75.75 0 0 0 .687-.449l1.035-2.362l2.337 5.835a.75.75 0 0 0 1.367.057L15.713 13h1.537a.75.75 0 1 0 0-1.5h-2a.75.75 0 0 0-.67.414l-1.004 2.004l-2.381-5.947a.75.75 0 0 0-1.383-.022z","fill-rule":"nonzero"})})}function Fu(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M9 2a3 3 0 0 0-3 3v14a3 3 0 0 0 3 3h6a3 3 0 0 0 3-3V5a3 3 0 0 0-3-3zm-.5 4.75A.75.75 0 0 1 9.25 6h5.5a.75.75 0 0 1 0 1.5h-5.5a.75.75 0 0 1-.75-.75m0 11a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 0 1.5h-5.5a.75.75 0 0 1-.75-.75m0-3a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 0 1.5h-5.5a.75.75 0 0 1-.75-.75"})})}function Ba(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.4-.615a.75.75 0 0 1 .85.174a9.793 9.793 0 0 1 2.205 3.792a.75.75 0 0 1-.272.825l-1.241.916a1.38 1.38 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826a9.798 9.798 0 0 1-2.204 3.792a.75.75 0 0 1-.849.175l-1.406-.617a1.38 1.38 0 0 0-1.926 1.114l-.17 1.526a.75.75 0 0 1-.571.647a9.518 9.518 0 0 1-4.406 0a.75.75 0 0 1-.572-.647l-.169-1.524a1.382 1.382 0 0 0-1.925-1.11l-1.406.616a.75.75 0 0 1-.85-.175a9.798 9.798 0 0 1-2.203-3.796a.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.272-.826a9.793 9.793 0 0 1 2.205-3.792a.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65a10.72 10.72 0 0 1 2.201-.252m0 1.5a9.136 9.136 0 0 0-1.354.117l-.11.977A2.886 2.886 0 0 1 6.526 7.17l-.899-.394A8.293 8.293 0 0 0 4.28 9.092l.797.587a2.881 2.881 0 0 1 .001 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.109.984c.89.15 1.799.15 2.688 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.904.396a8.299 8.299 0 0 0 1.348-2.318l-.798-.588a2.88 2.88 0 0 1-.001-4.643l.797-.587a8.293 8.293 0 0 0-1.348-2.317l-.897.393a2.884 2.884 0 0 1-4.023-2.324l-.109-.976a8.99 8.99 0 0 0-1.334-.117M12 8.25a3.75 3.75 0 1 1 0 7.5a3.75 3.75 0 0 1 0-7.5m0 1.5a2.25 2.25 0 1 0 0 4.5a2.25 2.25 0 0 0 0-4.5"})})}let Ua;Ua=[{label:"navbar.myShare",icon:[xa,_n],path:"/shares"}];const Ru={label:"navbar.connect",icon:[_u,Lu],path:"/connect"},Nu={label:"navbar.taskQueue",icon:[Ha,va],path:"/tasks"},Wu={label:"navbar.remoteDownload",icon:[Tu,qo],path:"/downloads"},Ae=({item:t})=>{const{t:n}=P("application"),s=Lt(),r=In(),[a,l]=i.useState(!1),o=i.useMemo(()=>r.pathname==t.path||r.pathname.startsWith(t.path+"/"),[r.pathname,t.path]);return e.jsxs(e.Fragment,{children:[t.pro&&e.jsx(Si,{open:a,onClose:()=>l(!1)}),e.jsx(Uo,{onClick:()=>t.pro?l(!0):s(t.path),label:t.pro?e.jsxs(M,{sx:{display:"flex",alignItems:"center"},children:[n(t.label),e.jsx(Ci,{sx:{height:"16px",fontSize:c=>c.typography.caption.fontSize},label:"Pro",color:"primary",size:"small"})]}):n(t.label),active:o,icon:e.jsx(Vo,{sx:{px:0,py:0,pr:"14px",height:"20px"},iconProps:{fontSize:"small",color:"action"},fileIcon:t.icon,active:o})},t.label)]})};let gt;gt=[{label:"dashboard:nav.summary",icon:[Ou,Mu],path:"/admin/home"},{label:"dashboard:nav.settings",icon:[Dn,Ba],path:"/admin/settings"},{label:"dashboard:nav.storagePolicy",icon:[Ei,wi],path:"/admin/policy"},{label:"dashboard:nav.nodes",icon:[Fu,Ai],path:"/admin/node"},{label:"dashboard:nav.groups",icon:[Pi,Pu],path:"/admin/group"},{label:"dashboard:nav.users",icon:[ma,Iu],path:"/admin/user"},{label:"dashboard:nav.files",icon:[$o,oa],path:"/admin/file"},{label:"dashboard:nav.entities",icon:[Ii,Du],path:"/admin/blob"},{label:"dashboard:nav.shares",icon:[xa,_n],path:"/admin/share"},{label:"dashboard:nav.tasks",icon:[Ha,va],path:"/admin/task"},{label:"dashboard:vas.orders",icon:[Au,Eu],path:"/admin/payment",pro:!0},{label:"dashboard:nav.events",icon:[zu,_i],path:"/admin/event",pro:!0}];const Hu=i.memo(()=>e.jsxs(e.Fragment,{children:[e.jsx(Ae,{item:gt[0]},gt[0].label),e.jsx(M,{children:gt.slice(1).map(t=>e.jsx(Ae,{item:t},t.label))}),e.jsx(Ae,{item:{label:"navbar.backToHomepage",icon:[cn,cn],path:"/home"}})]})),Bu=()=>{var o,c,u,h,f,d;C(p=>p.siteConfig.basic.config.shop_nav_enabled);const t=C(p=>p.siteConfig.basic.config.app_promotion),n=$.currentLoginOrNull(),s=i.useMemo(()=>Ye(n==null?void 0:n.user).enabled(Be.is_admin),[(c=(o=n==null?void 0:n.user)==null?void 0:o.group)==null?void 0:c.permission]),r=i.useMemo(()=>Ye(n==null?void 0:n.user).enabled(Be.remote_download),[(h=(u=n==null?void 0:n.user)==null?void 0:u.group)==null?void 0:h.permission]),a=i.useMemo(()=>Ye(n==null?void 0:n.user).enabled(Be.webdav)||t,[(d=(f=n==null?void 0:n.user)==null?void 0:f.group)==null?void 0:d.permission,t]),l=!!n;return e.jsxs(e.Fragment,{children:[l&&e.jsx(M,{children:e.jsxs(e.Fragment,{children:[Ua.map(p=>e.jsx(Ae,{item:p},p.label)),a&&e.jsx(Ae,{item:Ru}),e.jsx(Ae,{item:Nu}),r&&e.jsx(Ae,{item:Wu})]})}),l&&s&&e.jsx(Ae,{item:{label:"navbar.dashboard",icon:[dn,dn],path:"/admin/home"}})]})},Uu=N(Go)(({theme:t})=>({padding:t.spacing(1,2,1,2),margin:t.spacing(0,2,0,2)})),Vu=N("div")(()=>({display:"flex",justifyContent:"space-between",alignItems:"center"})),$u=N(ki)(({theme:t,warning:n})=>({height:8,borderRadius:5,[`&.${fs.colorPrimary}`]:{backgroundColor:t.palette.grey[t.palette.mode==="light"?200:800]},[`& .${fs.bar}`]:{borderRadius:5,backgroundColor:n?t.palette.warning.main:t.palette.primary.main},marginTop:t.spacing(1)})),qu=i.memo(()=>{const{t}=P("application"),n=L(),s=C(r=>r.fileManager[0].capacity);return i.useEffect(()=>{if(!s){n(fa(0));return}},[s]),e.jsxs(Uu,{withBorder:!0,children:[e.jsx(Vu,{children:e.jsx(re,{variant:"subtitle2",children:t("application:navbar.storage")})}),s&&e.jsx($u,{warning:s.used>s.total,variant:"determinate",value:Math.min(100,s.used/s.total*100)}),!s&&e.jsx(Pe,{sx:{mt:1,height:8},variant:"rounded"}),e.jsx(re,{variant:"caption",color:"text.secondary",children:s?`${we(s.used)} / ${we(s.total)}`:e.jsx(Pe,{sx:{width:"50%"},variant:"text"})})]})}),Va=()=>{const t=i.useRef(),n=$.currentLoginOrNull(),s=X(),r=le(s.breakpoints.down("sm")),l=i.useContext(Ut)===Bt.dashboard;return e.jsxs(e.Fragment,{children:[e.jsx(ku,{}),e.jsxs(J,{direction:"column",spacing:2,ref:t,sx:{px:1,pb:1,flexGrow:1,mx:1,overflow:"auto"},children:[!l&&e.jsxs(e.Fragment,{children:[e.jsx(Xo,{scrollRef:t,hideWithDrawer:!r}),e.jsx(Bu,{}),n&&e.jsx(qu,{})]}),l&&e.jsx(Hu,{})]})]})},Gu=t=>(L(),C(n=>n.globalState.drawerOpen),C(n=>n.globalState.drawerWidth),e.jsx(Ln,{...t,children:e.jsx(M,{sx:{width:"70vw"},children:e.jsx(Va,{})})})),Xu=()=>{const t=X(),n=C(a=>a.globalState.drawerOpen),s=C(a=>a.globalState.drawerWidth),r=t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[900];return e.jsx($i,{sx:{width:s,flexShrink:0,display:"flex","& .MuiDrawer-paper":{width:s,boxSizing:"border-box",backgroundColor:r,borderRight:"initial"}},variant:"persistent",anchor:"left",open:n,children:e.jsx(Va,{})})},Zu=N(M)(()=>({display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"})),Yu=()=>e.jsx(Zu,{children:e.jsx(Qs,{})}),Ju=()=>{var d,p;const t=C(g=>g.globalState.drawerOpen),n=C(g=>g.globalState.drawerWidth),[s,r]=i.useState(window.innerHeight);let a=Zo();const l=X(),o=le(l.breakpoints.down("sm")),u=i.useContext(Ut)==Bt.dashboard,h=$.currentLoginOrNull(),f=i.useMemo(()=>Ye(h==null?void 0:h.user).enabled(Be.is_admin),[(p=(d=h==null?void 0:h.user)==null?void 0:d.group)==null?void 0:p.permission]);return i.useEffect(()=>{const g=()=>{r(window.innerHeight)};return window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]),e.jsxs(M,{sx:g=>({flexGrow:1,transition:g.transitions.create("margin",{easing:g.transitions.easing.sharp,duration:g.transitions.duration.leavingScreen}),marginRight:o?0:2,marginLeft:o?0:`-${n-16}px`,...t&&{transition:g.transitions.create("margin",{easing:g.transitions.easing.easeOut,duration:g.transitions.duration.enteringScreen}),marginLeft:0},height:o?"100%":window.innerHeight,minHeight:window.innerHeight,display:"flex",flexDirection:"column",width:"100%",overflow:"hidden"}),component:"main",children:[e.jsx(Wa,{}),e.jsx(bn,{children:e.jsx(vn,{addEndListener:(g,m)=>g.addEventListener("transitionend",m,!1),classNames:"fade",children:a.state!=="idle"?e.jsx(Yu,{}):u&&!f?e.jsx(Yo,{to:"/home"}):e.jsx(Jo,{})},a.state!=="idle"?"loading":"idle")})]})},Ku=236,Qu=t=>{const n=L(),[s,r]=i.useState(!1),[a,l]=i.useState(0),o=i.useRef(0),c=C(f=>f.globalState.drawerWidth),u=C(f=>f.globalState.drawerOpen);i.useEffect(()=>{l(c-4),o.current=c-4},[]);const h=()=>{r(!0),document.body.style.userSelect="none";function f(p){p.preventDefault();const g=p.clientX-document.body.offsetLeft,m=Math.max(Math.min(g,window.innerWidth/2),Ku);l(m),o.current=m}function d(){document.body.removeEventListener("mousemove",f),r(!1),n(Ko(o.current+4)),$.set(ae.DrawerWidth,o.current+4),document.body.style.userSelect="initial"}document.body.addEventListener("mousemove",f),document.body.addEventListener("mouseup",d,{once:!0})};return e.jsxs(e.Fragment,{children:[u&&e.jsx(M,{onMouseDown:h,sx:{cursor:"ew-resize",height:"100%",position:"fixed",width:8,left:a,zIndex:f=>f.zIndex.drawer+2}}),e.jsx(Pn,{in:s,unmountOnExit:!0,children:e.jsx(M,{sx:{height:"100%",position:"fixed",width:8,left:a,bgcolor:"divider",zIndex:f=>f.zIndex.drawer+1}})})]})},Ns=()=>{const{t}=P(),n=L(),s=X();return le(s.breakpoints.down("sm"))?e.jsx(H,{onClick:a=>n(ds(ee.main,a)),children:e.jsx(tt,{})}):e.jsx(Re,{variant:"contained",onClick:a=>n(ds(ee.main,a)),startIcon:e.jsx(tt,{}),color:"primary",children:t("fileManager.new")})};function ep(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M8.502 11.5a1.002 1.002 0 1 1 0 2.004a1.002 1.002 0 0 1 0-2.005M12 4.353v6.651h7.442L17.72 9.28a.75.75 0 0 1-.073-.977l.073-.084a.75.75 0 0 1 .976-.072l.084.072l2.997 2.998a.75.75 0 0 1 .073.976l-.073.084l-2.996 3.003a.75.75 0 0 1-1.134-.975l.072-.084l1.713-1.717h-7.431L12 19.25a.75.75 0 0 1-.88.738l-8.5-1.501a.75.75 0 0 1-.62-.739V5.75a.75.75 0 0 1 .628-.74l8.5-1.396a.75.75 0 0 1 .872.74m-1.5.883l-7 1.15v10.732l7 1.236zM13 18.5h.765l.102-.007a.75.75 0 0 0 .648-.744l-.007-4.25H13zm.002-8.5L13 8.725V5h.745a.75.75 0 0 1 .743.647l.007.101l.007 4.252z"})})}const en=N(re)(()=>({lineHeight:1})),tp=({open:t,onClose:n,...s})=>{var m,x;const r=$.currentUser(),{t:a}=P(),l=Lt(),o=L(),c=X(),u=le(c.breakpoints.down("sm"));if(!r)return null;const h=i.useMemo(()=>Ye(r).enabled(Be.is_admin),[(m=r.group)==null?void 0:m.permission]),f=i.useCallback(()=>{o(ti()),n&&n({},"backdropClick")},[]),d=i.useCallback(()=>{l(`/profile/${r==null?void 0:r.id}`),n&&n({},"backdropClick")},[r==null?void 0:r.id]),p=i.useCallback(()=>{l("/settings"),n&&n({},"backdropClick")},[r==null?void 0:r.id]),g=i.useCallback(()=>{l("/admin/home"),n&&n({},"backdropClick")},[r==null?void 0:r.id]);return e.jsxs(Ln,{open:t,onClose:n,...s,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(M,{sx:{px:"12px",py:"10px",minWidth:"230px",display:"flex",maxWidth:"300px",width:"100%",flexDirection:"column",gap:"4px"},children:[e.jsxs(M,{sx:{display:"flex"},children:[e.jsx(en,{paragraph:!1,variant:"body2",fontWeight:600,children:r.nickname}),e.jsx(en,{variant:"body2",paragraph:!1,color:"textSecondary",sx:{ml:1},children:(x=r.group)==null?void 0:x.name})]}),e.jsx(en,{variant:"caption",color:"textSecondary",children:r.email})]}),e.jsx(It,{}),e.jsxs(ni,{dense:!0,sx:{mx:.5},children:[h&&e.jsxs(G,{onClick:g,children:[e.jsx(ce,{children:e.jsx(dn,{fontSize:"small"})}),e.jsx(q,{children:a("navbar.dashboard")})]}),u&&e.jsxs(G,{onClick:p,children:[e.jsx(ce,{children:e.jsx(Ba,{fontSize:"small"})}),e.jsx(q,{children:a("navbar.setting")})]}),e.jsxs(G,{onClick:d,children:[e.jsx(ce,{children:e.jsx(cn,{fontSize:"small"})}),e.jsx(q,{children:a("navbar.myProfile")})]}),e.jsxs(G,{onClick:f,children:[e.jsx(ce,{children:e.jsx(ep,{})}),e.jsx(q,{children:a("login.logout")})]})]})]})},Ws=()=>{const t=Lt(),[n,s]=i.useState(),r=En({variant:"popover",popupId:"user"});return i.useEffect(()=>{try{const a=$.currentLogin();a&&s(a)}catch{}},[]),e.jsxs(e.Fragment,{children:[e.jsxs(H,{size:n?"large":void 0,...n?An(r):{},children:[!n&&e.jsx(ma,{onClick:()=>t("/session")}),n&&e.jsx(Qo,{sx:{width:30,height:30},user:n.user})]}),e.jsx(tp,{...ei(r)})]})},np=N(Ce)(({theme:t})=>({"&.MuiButtonBase-root.Mui-disabled":{color:t.palette.text.primary,fontWeight:t.typography.fontWeightRegular,fontSize:t.typography.body2.fontSize}})),tn=N(si)(({theme:t})=>({backgroundColor:t.palette.background.default})),sp=i.forwardRef(({targets:t},n)=>{const s=L(),r=X(),a=le(r.breakpoints.down("sm")),l=le(r.breakpoints.down("md")),{t:o}=P(),c=Ge(t,ai.file);return a?e.jsxs(J,{direction:"row",spacing:1,sx:{height:"100%"},children:[e.jsx(H,{onClick:()=>s(us({index:ee.main,value:void 0})),children:e.jsx(St,{badgeContent:t.length,color:"primary",children:e.jsx(Qe,{})})}),e.jsx(H,{onClick:u=>s(ps(ee.main,t[0],!1,u)),children:e.jsx(St,{badgeContent:t.length,color:"primary",children:e.jsx(on,{})})})]}):e.jsx(M,{ref:n,sx:{height:"100%"},children:e.jsxs(J,{direction:"row",spacing:1,sx:{height:"100%"},children:[e.jsxs(tn,{variant:"outlined",children:[e.jsx(Ce,{onClick:()=>s(us({index:ee.main,value:void 0})),children:e.jsx(Qe,{fontSize:"small"})}),e.jsx(np,{disabled:!0,sx:{color:u=>u.palette.text.primary},children:o("application:navbar.objectsSelected",{num:t.length})})]}),!l&&e.jsxs(tn,{variant:"outlined",children:[c.showOpen&&e.jsx(Q,{title:o("application:fileManager.open"),children:e.jsx(Ce,{onClick:()=>s(Ys(0,t[0])),children:e.jsx(ri,{fontSize:"small"})})}),c.showDownload&&e.jsx(Q,{title:o("application:fileManager.download"),children:e.jsx(Ce,{onClick:()=>s(oi(0,t)),children:e.jsx(ii,{fontSize:"small"})})}),c.showCopy&&e.jsx(Q,{title:o("application:fileManager.copy"),children:e.jsx(Ce,{onClick:()=>s(hs(0,t,!0)),children:e.jsx(sn,{fontSize:"small"})})}),c.showMove&&e.jsx(Q,{title:o("application:fileManager.move"),children:e.jsx(Ce,{onClick:()=>s(hs(0,t,!1)),children:e.jsx(li,{fontSize:"small"})})}),c.showRename&&e.jsx(Q,{title:o("application:fileManager.rename"),children:e.jsx(Ce,{onClick:()=>s(ci(0,t[0])),children:e.jsx(di,{fontSize:"small"})})}),c.showShare&&e.jsx(Q,{title:o("application:fileManager.share"),children:e.jsx(Ce,{onClick:()=>s(sa(0,t[0])),children:e.jsx(_n,{fontSize:"small"})})}),c.showDelete&&e.jsx(Q,{title:o("application:fileManager.delete"),children:e.jsx(Ce,{onClick:()=>s(ui(0,t)),children:e.jsx(ha,{fontSize:"small"})})})]}),e.jsx(tn,{variant:"outlined",children:e.jsx(Ce,{onClick:u=>s(ps(ee.main,t[0],!1,u)),children:e.jsx(on,{fontSize:"small"})})})]})})}),Hs=()=>{const t=C(s=>s.fileManager[ee.main].selected),n=i.useMemo(()=>Object.keys(t).map(s=>t[s]),[t]);return e.jsx(e.Fragment,{children:e.jsx(bn,{children:e.jsx(vn,{addEndListener:(s,r)=>s.addEventListener("transitionend",r,!1),classNames:"fade",children:e.jsxs(M,{sx:{height:"100%"},children:[n.length==0&&e.jsx(pi,{}),n.length>0&&e.jsx(sp,{targets:n})]})},`${n.length>0}`)})})};function ap(t){return e.jsxs(B,{...t,viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M15.987 3.016a1 1 0 0 0-1.285-.79l-7 2.187A1 1 0 0 0 7 5.368V13.5a2.5 2.5 0 1 0 1 2V8.368l7-2.188v2.843c.343.03.678.093 1 .184V3.18c0-.056-.005-.11-.013-.164M19 14.5a4.5 4.5 0 1 1-9 0a4.5 4.5 0 0 1 9 0m-2.263-.435l-2.994-1.65a.5.5 0 0 0-.742.437v3.3a.5.5 0 0 0 .742.438l2.994-1.65a.5.5 0 0 0 0-.875"}),","]})}function rp(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"m14.712 2.289l-.087-.078a1 1 0 0 0-1.327.078l-.078.087a.999.999 0 0 0 .078 1.326l1.299 1.297H8.999l-.24.004A6.997 6.997 0 0 0 2 11.993a6.94 6.94 0 0 0 1.189 3.899a.999.999 0 0 0 1.626-1.163l-.135-.218A4.997 4.997 0 0 1 9 6.998h5.595l-1.297 1.297l-.078.087a.999.999 0 0 0 1.492 1.326l3.006-3.003l.077-.087a.999.999 0 0 0-.078-1.326zm6.075 5.771A.999.999 0 0 0 19 8.677c0 .209.064.402.172.561a4.997 4.997 0 0 1-4.17 7.75H9.414l1.294-1.29l.083-.096a1 1 0 0 0-.006-1.23l-.077-.088l-.095-.084a1.001 1.001 0 0 0-1.232.006l-.088.078l-3.005 3.003l-.083.095a1 1 0 0 0 .006 1.231l.077.087l3.005 3.003l.095.084a1 1 0 0 0 1.397-1.41l-.077-.087l-1.304-1.303H15l.24-.003a6.997 6.997 0 0 0 5.546-10.927z"})})}function op(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"m14.712 2.289l-.087-.078a1 1 0 0 0-1.327.078l-.078.087a.999.999 0 0 0 .078 1.326l1.299 1.297H8.999l-.24.004A6.997 6.997 0 0 0 2 11.993a6.94 6.94 0 0 0 1.189 3.899a.999.999 0 0 0 1.626-1.163l-.135-.218A4.997 4.997 0 0 1 9 6.998h5.595l-1.297 1.297l-.078.087a.999.999 0 0 0 1.492 1.326l3.006-3.003l.077-.087a.999.999 0 0 0-.078-1.326zm6.075 5.771A.999.999 0 0 0 19 8.677c0 .209.064.402.172.561c.435.658.72 1.424.803 2.25a6.48 6.48 0 0 1 1.982 1.281a6.958 6.958 0 0 0-1.17-4.712zM9.415 16.99h1.605a6.599 6.599 0 0 0 .151 1.998H9.405l1.304 1.303l.077.087a1 1 0 0 1-1.397 1.41l-.095-.084L6.29 18.7l-.077-.087a1 1 0 0 1-.006-1.231l.083-.095l3.005-3.003l.088-.078c.36-.284.87-.286 1.232-.006l.095.084l.077.087a1 1 0 0 1 .006 1.231l-.083.095zM23 17.5a5.5 5.5 0 1 1-11 0a5.5 5.5 0 0 1 11 0m-4.885-3.487a.5.5 0 0 0-.562.263a4.782 4.782 0 0 1-.613.828c-.334.373-.744.739-1.164.949a.5.5 0 1 0 .448.894c.489-.244.926-.616 1.276-.977v4.53a.5.5 0 0 0 1 0v-6a.5.5 0 0 0-.385-.487"})})}function ip(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M19.207 4.293a1 1 0 1 0-1.414 1.414l.801.802c-3.809.161-6.169 2.59-8.226 4.706l-.085.088C8.057 13.593 6.147 15.5 3 15.5a1 1 0 1 0 0 2c4.05 0 6.503-2.525 8.632-4.715l.085-.088c2.124-2.184 3.96-4.02 6.857-4.185l-.781.78a1 1 0 0 0 1.414 1.415l2.5-2.5a1 1 0 0 0 0-1.414zM3 6.5c3.229 0 5.443 1.605 7.287 3.366c-.197.2-.388.397-.574.588l-.147.152c-.233.24-.459.47-.68.693C7.186 9.68 5.476 8.5 3 8.5a1 1 0 1 1 0-2m15.594 10.991c-3.01-.128-5.115-1.671-6.881-3.357c.197-.2.388-.397.574-.589l.147-.151c.233-.24.459-.47.68-.693c1.601 1.524 3.21 2.66 5.46 2.787l-.781-.78a1 1 0 0 1 1.414-1.415l2.5 2.5a1 1 0 0 1 0 1.414l-2.5 2.5a1 1 0 0 1-1.414-1.414z"})})}const lp=({file:t,playlist:n,playIndex:s,onClose:r,...a})=>e.jsx(hi,{MenuListProps:{dense:!0},anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:r,...a,children:n.map((l,o)=>e.jsxs(G,{onClick:()=>s(o),selected:l.path==t.path,children:[e.jsx(ce,{children:e.jsx(ta,{sx:{px:0,py:0,height:"20px"},file:l,variant:"small",iconProps:{fontSize:"small"}})}),e.jsx(q,{children:l.name})]},l.id))});N("div")({position:"absolute",width:"100%",height:"100%",top:0,left:0,overflow:"hidden",background:"linear-gradient(rgb(255, 38, 142) 0%, rgb(255, 105, 79) 100%)",transition:"all 500ms cubic-bezier(0.175, 0.885, 0.32, 1.275) 0s","&::before":{content:'""',width:"140%",height:"140%",position:"absolute",top:"-40%",right:"-50%",background:"radial-gradient(at center center, rgb(62, 79, 249) 0%, rgba(62, 79, 249, 0) 64%)"},"&::after":{content:'""',width:"140%",height:"140%",position:"absolute",bottom:"-50%",left:"-30%",background:"radial-gradient(at center center, rgb(247, 237, 225) 0%, rgba(247, 237, 225, 0) 70%)",transform:"rotate(30deg)"}});const cp=N("div")(({theme:t})=>({padding:16,width:343,maxWidth:"100%",margin:"auto",position:"relative",zIndex:1,backgroundColor:t.palette.mode==="dark"?"rgba(0,0,0,0.6)":"rgba(255,255,255,0.4)",backdropFilter:"blur(40px)"})),dp=N("div")({width:100,height:100,objectFit:"cover",overflow:"hidden",flexShrink:0,borderRadius:8,backgroundColor:"rgba(0,0,0,0.08)","& > img":{width:"100%"},display:"flex",alignItems:"center",justifyContent:"center"}),Bs=N(re)({fontSize:"0.75rem",opacity:.38,fontWeight:500,letterSpacing:.2}),Us=({children:t,text:n,...s})=>{const r=i.useRef(null),a=i.useRef(null),[l,o]=i.useState(!1),[c,u]=i.useState(15);return i.useEffect(()=>{const h=()=>{if(r.current&&a.current){const f=a.current.scrollWidth>r.current.clientWidth;if(o(f),f){const d=a.current.scrollWidth,p=Math.max(5,Math.min(10,d/15));u(p)}}};o(!1),setTimeout(()=>{h()},1e3)},[n]),e.jsx(M,{ref:r,sx:{overflow:"hidden",whiteSpace:"nowrap",width:"100%",position:"relative"},...s,children:l?e.jsxs(M,{sx:{display:"flex",width:"100%",animation:`marquee ${c}s linear infinite`,"@keyframes marquee":{"0%":{transform:"translateX(0%)"},"100%":{transform:"translateX(-100%)"}}},children:[e.jsx(M,{ref:a,sx:{whiteSpace:"nowrap",paddingRight:"50px"},children:t}),e.jsx(M,{sx:{whiteSpace:"nowrap",paddingRight:"50px"},children:t})]}):e.jsx(M,{ref:a,children:t})})},up=/iPad|iPhone/.test(navigator.userAgent),pp=({file:t,duration:n,current:s,onSeek:r,playing:a,togglePause:l,volume:o,setVolumeLevel:c,loopMode:u,loopProceed:h,toggleLoopMode:f,playlist:d,playIndex:p,...g})=>{var V,T;const m=X();le(m.breakpoints.down("md"));const x=L(),[j,v]=i.useState(null),[k,w]=i.useState(!1),[D,y]=i.useState(0),b=i.useRef(!1),[E,z]=i.useState(null);function K(S){const O=Math.floor(S/60),I=S-O*60;return`${O}:${I<10?`0${I}`:I}`}const U=m.palette.mode==="dark"?"#fff":"#000",A=m.palette.mode==="dark"?"rgba(255,255,255,0.4)":"rgba(0,0,0,0.4)";i.useEffect(()=>{var S;w(!1),t&&"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:((S=t.metadata)==null?void 0:S[R.music_title])??t.name})),t&&(!t.metadata||t.metadata[R.thumbDisabled]===void 0)?x(fi(ee.main,t)).then(O=>{v(O)}):v(null)},[t]),i.useEffect(()=>{b.current||y(s)},[s]);const _=S=>{b.current=!1,r(S)};return e.jsxs(Ln,{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},...g,children:[d&&t&&e.jsx(lp,{playIndex:p,anchorEl:E,open:!!E,onClose:()=>z(null),file:t,playlist:d}),e.jsxs(cp,{children:[e.jsxs(M,{sx:{display:"flex",alignItems:"center"},children:[e.jsxs(dp,{children:[!j&&e.jsx(gi,{fontSize:"large"}),j&&e.jsx("img",{src:j,onError:()=>v(null),alt:"cover"})]}),e.jsxs(M,{sx:{ml:1.5,minWidth:0,maxWidth:"210px",width:"100%"},children:[t&&t.metadata&&t.metadata[R.music_artist]&&e.jsx(re,{variant:"caption",color:"text.secondary",fontWeight:500,children:e.jsx(Xt,{element:{display:t.metadata[R.music_artist],searchValue:t.metadata[R.music_artist],searchKey:R.music_artist}})}),t&&e.jsx(Us,{text:((V=t.metadata)==null?void 0:V[R.music_title])??t.name,children:e.jsx("b",{children:(T=t.metadata)!=null&&T[R.music_title]?e.jsx(Xt,{element:{display:t.metadata[R.music_title],searchValue:t.metadata[R.music_title],searchKey:R.music_title}}):t.name})}),t&&t.metadata&&t.metadata[R.music_album]&&e.jsx(Us,{text:t.metadata[R.music_album],children:e.jsx(re,{variant:"body2",letterSpacing:-.25,children:e.jsx(Xt,{element:{display:t.metadata[R.music_album],searchValue:t.metadata[R.music_album],searchKey:R.music_album}})})})]})]}),e.jsx(jt,{"aria-label":"time-indicator",size:"small",value:D,onMouseDown:()=>b.current=!0,min:0,step:1,max:n,onChange:(S,O)=>y(O),onChangeCommitted:(S,O)=>_(O),sx:{color:m.palette.mode==="dark"?"#fff":"rgba(0,0,0,0.87)",height:4,"& .MuiSlider-thumb":{width:8,height:8,transition:"0.3s cubic-bezier(.47,1.64,.41,.8)","&::before":{boxShadow:"0 2px 12px 0 rgba(0,0,0,0.4)"},"&:hover, &.Mui-focusVisible":{boxShadow:`0px 0px 0px 8px ${m.palette.mode==="dark"?"rgb(255 255 255 / 16%)":"rgb(0 0 0 / 16%)"}`},"&.Mui-active":{width:20,height:20}},"& .MuiSlider-rail":{opacity:.28}}}),e.jsxs(M,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mt:-2},children:[e.jsx(Bs,{children:K(s)}),e.jsxs(Bs,{children:["-",K(n-s)]})]}),e.jsxs(M,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mt:-1},children:[e.jsxs(H,{"aria-label":"loop mode",onClick:f,children:[u==Le.list_repeat&&e.jsx(rp,{fontSize:"medium",htmlColor:U}),u==Le.single_repeat&&e.jsx(op,{fontSize:"medium",htmlColor:U}),u==Le.shuffle&&e.jsx(ip,{fontSize:"medium",htmlColor:U})]}),e.jsxs(M,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx(H,{"aria-label":"previous song",onClick:()=>h(!1),children:e.jsx(el,{fontSize:"large",htmlColor:U})}),e.jsx(H,{"aria-label":a?"pause":"play",onClick:l,children:a?e.jsx(nl,{sx:{fontSize:"3rem"},htmlColor:U}):e.jsx(sl,{sx:{fontSize:"3rem"},htmlColor:U})}),e.jsx(H,{"aria-label":"next song",onClick:()=>h(!0),children:e.jsx(Qi,{fontSize:"large",htmlColor:U})})]}),e.jsx(H,{"aria-label":"play list",onClick:S=>z(S.currentTarget),children:e.jsx(mi,{fontSize:"medium",htmlColor:U})})]}),!up&&e.jsxs(J,{spacing:2,direction:"row",sx:{mb:1,px:1},alignItems:"center",children:[e.jsx(al,{htmlColor:A}),e.jsx(jt,{"aria-label":"Volume",value:o,min:0,max:1,onChange:(S,O)=>c(O),onChangeCommitted:(S,O)=>$.set(ae.MusicVolume,O),step:.01,sx:{color:m.palette.mode==="dark"?"#fff":"rgba(0,0,0,0.87)","& .MuiSlider-track":{border:"none"},"& .MuiSlider-thumb":{width:24,height:24,backgroundColor:"#fff","&::before":{boxShadow:"0 4px 8px rgba(0,0,0,0.4)"},"&:hover, &.Mui-focusVisible, &.Mui-active":{boxShadow:"none"}}}}),e.jsx(rl,{htmlColor:A})]})]}),j&&e.jsx(M,{component:"img",onLoad:()=>w(!0),sx:{transition:"opacity 0.3s cubic-bezier(.47,1.64,.41,.8) 0s",opacity:k?1:0,position:"absolute",height:"100%",width:"100%",top:0,bottom:0},src:j})]})};function hp(t){return e.jsxs(B,{...t,viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M20 2.75a.75.75 0 0 0-.965-.718l-10 3a.75.75 0 0 0-.535.718v9.877a3.5 3.5 0 1 0 1.496 2.702a.756.756 0 0 0 .004-.079v-7.942l8.5-2.55v5.87a3.5 3.5 0 1 0 1.496 2.702a.764.764 0 0 0 .004-.08z"}),","]})}const Le={list_repeat:0,single_repeat:1,shuffle:2},fp=()=>{var V;const t=L(),n=C(T=>T.globalState.musicPlayer),s=i.useRef(null),r=i.useRef(null),[a,l]=i.useState(!1),[o,c]=i.useState(.2),[u,h]=i.useState(void 0);i.useState(!1);const[f,d]=i.useState(!1),[p,g]=i.useState(0),[m,x]=i.useState(0),[j,v]=i.useState(Le.list_repeat),k=i.useRef([]);i.useEffect(()=>{var T;if(n){k.current=[],l(!0),d(!0);const S=$.getWithFallback(ae.MusicVolume);c(S),w(n.startIndex,S)}return(T=s.current)==null||T.addEventListener("timeupdate",y),()=>{var S;l(!1),(S=s.current)==null||S.removeEventListener("timeupdate",y)}},[n]);const w=i.useCallback(async(T,S)=>{if(s.current&&n){s.current.pause(),h(T);try{const O=await t(Fe({uris:[pe(n.files[T])],entity:n.version}));s.current.src=O.urls[0].url,s.current.currentTime=0,s.current.play(),s.current.volume=S??o}catch(O){console.error(O)}}},[n,o]),D=i.useCallback(T=>{if(n)switch(k.current.push(u??0),j){case Le.list_repeat:w(T?((u??0)+1)%(n==null?void 0:n.files.length):((u??0)-1+(n==null?void 0:n.files.length))%(n==null?void 0:n.files.length));break;case Le.single_repeat:w(u??0);break;case Le.shuffle:if(T){const S=Math.floor(Math.random()*(n==null?void 0:n.files.length));w(S)}else k.current.pop(),w(k.current.pop()??u??0);break}},[j,w,n,u]);i.useCallback(()=>{D(!0)},[]);const y=i.useCallback(()=>{var T,S;x(Math.floor(((T=s.current)==null?void 0:T.currentTime)||0)),g(Math.floor(((S=s.current)==null?void 0:S.duration)||0))},[]),b=i.useCallback(T=>{s.current&&(s.current.currentTime=T)},[]),E=n?`[${(u??0)+1}/${n.files.length}] ${(V=n==null?void 0:n.files[u??0])==null?void 0:V.name}`:"",z=i.useCallback(()=>{d(!1)},[]),K=i.useCallback(()=>{d(!0)},[]),U=i.useCallback(()=>{s.current&&(s.current.paused?(s.current.play(),l(!0)):(s.current.pause(),l(!1)))},[]),A=i.useCallback(T=>{s.current&&(s.current.volume=T,c(T))},[]),_=i.useCallback(()=>{v(T=>(T+1)%3)},[]);return e.jsxs(e.Fragment,{children:[e.jsx("audio",{ref:s,onPause:()=>l(!1),onPlay:()=>l(!0),onEnded:()=>D(!0)}),e.jsx(Q,{title:E,enterDelay:0,children:e.jsx(H,{ref:r,onClick:K,size:"large",children:a?e.jsx(ap,{}):e.jsx(hp,{})})}),u!==void 0&&e.jsx(pp,{playIndex:w,loopProceed:D,file:n==null?void 0:n.files[u],duration:p,current:m,open:f,setVolumeLevel:A,volume:o,onSeek:b,togglePause:U,playing:a,playlist:n==null?void 0:n.files,loopMode:j,toggleLoopMode:_,anchorEl:r.current,onClose:z})]})};function gp(t){return e.jsx(B,{...t,children:e.jsx("path",{d:"M5.25 20.5h13.498a.75.75 0 0 1 .101 1.493l-.101.007H5.25a.75.75 0 0 1-.102-1.493l.102-.007h13.498H5.25zM6.293 7.29l4.998-4.997a1 1 0 0 1 1.32-.084l.093.083l5.004 4.997a1 1 0 0 1-1.32 1.498l-.094-.083L13 5.413V18a1 1 0 0 1-.884.993L12 19a1 1 0 0 1-.993-.883L10.999 18L11 5.41L7.707 8.704a1 1 0 0 1-1.32.083l-.094-.083a1 1 0 0 1-.083-1.32l.083-.095l4.998-4.996l-4.998 4.996z","fill-rule":"nonzero"})})}const mp=()=>{const t=L(),{t:n}=P(),s=C(a=>a.globalState.uploadTaskCount),r=i.useCallback(()=>{t(ln())},[t]);return s?e.jsx(M,{sx:{position:"relative"},children:e.jsx(Q,{title:n("uploader.uploadList"),enterDelay:0,children:e.jsx(H,{onClick:r,size:"large",children:e.jsx(St,{sx:{fontSize:a=>a.typography.body2.fontSize},badgeContent:s,color:"secondary",children:e.jsx(gp,{})})})})}):null},xp=()=>{const t=L(),n=X(),s=i.useContext(Ut),r=le(n.breakpoints.down("sm")),a=s==Bt.default,{t:l}=P(),o=Lt(),c=C(v=>v.globalState.drawerOpen),u=C(v=>v.globalState.mobileDrawerOpen),h=C(v=>v.globalState.drawerWidth),f=C(v=>v.globalState.musicPlayer),[d,p]=i.useState(null),g=n.palette.mode==="light"?n.palette.grey[100]:n.palette.grey[900],m=!!$.currentLoginOrNull(),x=v=>{p(v.currentTarget),t(un(!0))},j=()=>{t(un(!1))};return e.jsx(ja,{elevation:0,enableColorOnDark:!0,sx:v=>({transition:v.transitions.create(["margin","width"],{easing:v.transitions.easing.sharp,duration:v.transitions.duration.leavingScreen}),backgroundColor:g,color:v.palette.getContrastText(g),...c&&!r&&{width:`calc(100% - ${h}px)`,marginLeft:`${h}px`,transition:v.transitions.create(["margin","width"],{easing:v.transitions.easing.easeOut,duration:v.transitions.duration.enteringScreen})}}),position:"fixed",children:e.jsxs(Ca,{sx:{"&.MuiToolbar-root.MuiToolbar-gutters":{paddingLeft:c&&!r?n.spacing(0):n.spacing(r?2:3),transition:n.transitions.create("padding",{easing:n.transitions.easing.easeInOut,duration:n.transitions.duration.standard})}},children:[e.jsx(ze,{orientation:"horizontal",in:!c||r,children:e.jsx(H,{color:"inherit","aria-label":"open drawer",onClick:r?x:()=>t(ga(!0)),edge:"start",sx:{mr:r?1:2,ml:r?-1:-1.5},children:e.jsx(tl,{})})}),r&&e.jsx(e.Fragment,{children:e.jsx(Gu,{open:!!u,anchorEl:d,onClose:j})}),!r&&a&&e.jsxs(J,{direction:"row",spacing:1,sx:{height:42},children:[e.jsx(Ns,{}),e.jsx(Hs,{})]}),e.jsx(M,{sx:{flexGrow:1}}),e.jsxs(J,{direction:"row",sx:{alignItems:"center"},spacing:r?1:0,children:[!r&&e.jsx(mp,{}),f&&e.jsx(fp,{}),r?e.jsxs(e.Fragment,{children:[a&&e.jsx(Hs,{}),a&&e.jsx(Ns,{}),e.jsx(Ws,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ti,{}),m&&e.jsx(Q,{title:l("navbar.setting"),children:e.jsx(H,{size:"large",onClick:()=>o("/settings"),children:e.jsx(Dn,{})})}),e.jsx(Ws,{})]})]})]})})};var Bt=(t=>(t[t.default=0]="default",t[t.dashboard=1]="dashboard",t))(Bt||{});const Ut=i.createContext(0),bp=()=>{const t=In().pathname;return e.jsx(vp,{variant:t.startsWith("/admin")?1:0})},vp=({variant:t})=>{const n=X(),s=L(),r=le("(pointer: coarse)"),a=le(n.breakpoints.down("sm")),l=In();return i.useEffect(()=>{a&&s(un(!1))},[l]),e.jsx(Ut.Provider,{value:t??0,children:e.jsx(M,{sx:{bgcolor:o=>o.palette.mode==="light"?o.palette.grey[100]:o.palette.grey[900],display:"flex"},children:e.jsxs(yc,{backend:Rc,children:[!a&&t!=1&&!r&&e.jsx(Jd,{}),!a&&!r&&e.jsx(Qu,{}),e.jsx(xp,{}),!a&&e.jsx(Xu,{}),t!=1&&e.jsx(xi,{fmIndex:ee.main}),e.jsx(Xd,{}),e.jsx(wu,{}),t!=1&&e.jsx(bi,{}),e.jsx(Ju,{})]})})})},kp=Object.freeze(Object.defineProperty({__proto__:null,AutoNavbarFrame:bp,FileManager:vi},Symbol.toStringTag,{value:"Module"}));export{Ze as C,kp as F};
